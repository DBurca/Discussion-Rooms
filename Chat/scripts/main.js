"use strict";window.g_aIT=class{constructor(g,a){this.g_aqU=g,this.g_aIU=a,this.g_aIV=!1,this.g_aIW=()=>this.g_KM()}g_aIX(){}g_aIY(g,a,e,_){this.g_aqU.g_aIZ(this.g_aIU,g,a,e,_)}g_aI_(g,a,e,_){return this.g_aqU.g_aI$(this.g_aIU,g,a,e,_)}g_aJa(g,a,e){this.g_aqU.g_aJb()?this.g_aIY(g,a,e):this.g_aqU.g_aJc()._OnMessageFromDOM({type:"event",component:this.g_aIU,handler:g,dispatchOpts:e||null,data:a,responseId:null})}g_aJd(g,a){this.g_aqU.g_aJe(this.g_aIU,g,a)}g_aJf(g){for(const[a,e]of g)this.g_aJd(a,e)}g_aJg(){return this.g_aqU}g_aJh(){return this.g_aIU}g_adZ(){this.g_aIV||(this.g_aqU.g_aJi(this.g_aIW),this.g_aIV=!0)}g_adK(){this.g_aIV&&(this.g_aqU.g_aJj(this.g_aIW),this.g_aIV=!1)}g_KM(){}},window.g_mM=class{constructor(g,a){this.g_lv=g,this.g_mN=a,this.g_mP=-1,this.g_mQ=-Infinity,this.g_mR=()=>this.g_mS(),this.g_mT=!1,this.g_mU=!1}g_mW(g){this.g_mU=!!g}g_m_(){if(-1===this.g_mP){const g=Date.now(),a=g-this.g_mQ,e=this.g_mN;a>=e&&this.g_mU?(this.g_mQ=g,this.g_m$()):this.g_mP=self.setTimeout(this.g_mR,Math.max(e-a,4))}}g_m$(){this.g_mT=!0,this.g_lv(),this.g_mT=!1}g_lz(){this.g_mT||(this.g_na(),this.g_mQ=Date.now())}g_mS(){this.g_mP=-1,this.g_mQ=Date.now(),this.g_m$()}g_na(){-1!==this.g_mP&&(self.clearTimeout(this.g_mP),this.g_mP=-1)}g_ek(){this.g_na(),this.g_lv=null,this.g_mR=null}},"use strict",window.g_aJk=class extends g_aIT{constructor(g,a){super(g,a),this.g_aJl=new Map,this.g_aJm=!0,this.g_aJd("create",g=>this.g_aJn(g)),this.g_aJd("destroy",g=>this.g_aJo(g)),this.g_aJd("set-visible",g=>this.g_aJp(g)),this.g_aJd("update-position",g=>this.g_aJq(g)),this.g_aJd("update-state",g=>this.g_aGr(g)),this.g_aJd("focus",g=>this.g_aJr(g)),this.g_aJd("set-css-style",g=>this.g_aJs(g))}g_aJt(g){this.g_aJm=!!g}g_aJu(g,e){this.g_aJd(g,g=>{const a=g.elementId,_=this.g_aJl.get(a);return e(_,g)})}g_aJn(g){const a=g.elementId,e=this.g_aex(a,g);this.g_aJl.set(a,e),g.isVisible||(e.style.display="none"),this.g_aJm&&document.body.appendChild(e)}g_aex(){throw new Error("required override")}g_aJv(){}g_aJo(g){const a=g.elementId,e=this.g_aJl.get(a);this.g_aJv(e),this.g_aJm&&e.parentElement.removeChild(e),this.g_aJl.delete(a)}g_aJw(g,a,e){e||(e={}),e.elementId=a,this.g_aIY(g,e)}g_aJx(g,a,e){e||(e={}),e.elementId=a,this.g_aJa(g,e)}g_aJp(g){if(this.g_aJm){const a=this.g_aJl.get(g.elementId);a.style.display=g.isVisible?"":"none"}}g_aJq(g){if(this.g_aJm){const a=this.g_aJl.get(g.elementId);a.style.left=g.left+"px",a.style.top=g.top+"px",a.style.width=g.width+"px",a.style.height=g.height+"px";const e=g.fontSize;null!==e&&(a.style.fontSize=e+"em")}}g_aGr(g){const a=this.g_aJl.get(g.elementId);this.g_aJy(a,g)}g_aJy(){throw new Error("required override")}g_aJr(g){const a=this.g_aJl.get(g.elementId);g.focus?a.focus():a.blur()}g_aJs(g){const a=this.g_aJl.get(g.elementId);a.style[g.prop]=g.val}g_aJz(g){return this.g_aJl.get(g)}},"use strict";{function _(g){if(g.g_aJA){const a=document.createElement("script");a.async=!1,a.textContent=g.g_C,document.head.appendChild(a)}else return new Promise((a,e)=>{const _=document.createElement("script");_.onload=a,_.onerror=e,_.async=!1,_.src=g,document.head.appendChild(_)})}async function t(g){const a=await r(g),e=new TextDecoder("utf-8");return e.decode(a)}function r(g){return new Promise((e,_)=>{const a=new FileReader;a.onload=g=>e(g.target.result),a.onerror=g=>_(g),a.readAsArrayBuffer(g)})}function s(g){return n.has(g)}const a=/(iphone|ipod|ipad)/i.test(navigator.userAgent);let e=new Audio;const d={"audio/webm; codecs=opus":!!e.canPlayType("audio/webm; codecs=opus"),"audio/ogg; codecs=opus":!!e.canPlayType("audio/ogg; codecs=opus"),"audio/webm; codecs=vorbis":!!e.canPlayType("audio/webm; codecs=vorbis"),"audio/ogg; codecs=vorbis":!!e.canPlayType("audio/ogg; codecs=vorbis"),"audio/mp4":!!e.canPlayType("audio/mp4"),"audio/mpeg":!!e.canPlayType("audio/mpeg")};e=null;const g=[];let u=0;window.RealFile=window.File;const i=[],p=new Map,U=new Map;let l=0;const m=[];self.g_aJB=function(g){if("function"!=typeof g)throw new Error("runOnStartup called without a function");m.push(g)};const n=new Set(["cordova","playable-ad","instant-games"]);window.g_aJC=class e{constructor(g){this.g_aJD=g.g_aJE,this.g_aJF=null,this.g_aoP="",this.g_aJG=g.g_aJH,this.g_aJI={},this.g_aJJ=null,this.g_aJK=null,this.g_aJL=[],this.g_aJM=null,this.g_amQ=null,this.g_aqO=null,this.g_anx=-1,this.g_aJN=()=>this.g_aJO(),this.g_aJP=[],this.g_aoU=g.g_aJQ,s(this.g_aoU)&&this.g_aJD&&(console.warn("[C3 runtime] Worker mode is enabled and supported, but is disabled in WebViews due to crbug.com/923007. Reverting to DOM mode."),this.g_aJD=!1),this.g_aJR=!1,this.g_aJS=null,this.g_aJT=null,("html5"===this.g_aoU||"playable-ad"===this.g_aoU)&&"file"===location.protocol.substr(0,4)&&alert("Exported games won't work until you upload them. (When running on the file: protocol, browsers block many features from working for security reasons.)"),this.g_aJe("runtime","cordova-fetch-local-file",g=>this.g_aJU(g)),this.g_aJe("runtime","create-job-worker",g=>this.g_aJV(g)),"cordova"===this.g_aoU?document.addEventListener("deviceready",()=>this.g_acN(g)):this.g_acN(g)}g_ek(){this.g_arL(),this.g_aJF&&(this.g_aJF.onmessage=null,this.g_aJF=null),this.g_aJJ&&(this.g_aJJ.terminate(),this.g_aJJ=null),this.g_aJK&&(this.g_aJK.g_ek(),this.g_aJK=null),this.g_amQ&&(this.g_amQ.parentElement.removeChild(this.g_amQ),this.g_amQ=null)}g_aJW(){return this.g_amQ}g_fe(){return this.g_aoP}g_aJb(){return this.g_aJD}g_asy(){return this.g_aoU}g_arl(){return a&&"cordova"===this.g_aoU}g_asz(){return a&&s(this.g_aoU)}async g_acN(g){if("playable-ad"===this.g_aoU){this.g_aJS=self.c3_base64files,this.g_aJT={},await this.g_aJX();for(let a=0,e=g.g_aJY.length;a<e;++a){const e=g.g_aJY[a].toLowerCase();this.g_aJT.hasOwnProperty(e)?g.g_aJY[a]={g_aJA:!0,g_C:this.g_aJT[e]}:this.g_aJS.hasOwnProperty(e)&&(g.g_aJY[a]=URL.createObjectURL(this.g_aJS[e]))}}if(g.g_aJZ)this.g_aoP=g.g_aJZ;else{const g=location.origin;this.g_aoP=("null"===g?"file:///":g)+location.pathname;const a=this.g_aoP.lastIndexOf("/");-1!==a&&(this.g_aoP=this.g_aoP.substr(0,a+1))}if(g.g_aJ_)for(const[a,e]of Object.entries(g.g_aJ_))this.g_aJI[a]=URL.createObjectURL(e);const a=new MessageChannel;this.g_aJF=a.port1,this.g_aJF.onmessage=g=>this._OnMessageFromRuntime(g.data),window.c3_addPortMessageHandler&&window.c3_addPortMessageHandler(g=>this.g_aJ$(g)),this.g_aqO=new self.g_aKa(this),await this.g_aqO.g_ajY(),this.g_aKb(),"object"==typeof window.StatusBar&&window.StatusBar.hide(),"object"==typeof window.AndroidFullScreen&&window.AndroidFullScreen.immersiveMode(),await this.g_aKc(),this.g_aJD?await this.g_aKd(g,a.port2):await this.g_aKe(g,a.port2)}g_aKf(g){return this.g_aJI.hasOwnProperty(g)?this.g_aJI[g]:g.endsWith("/workermain.js")&&this.g_aJI.hasOwnProperty("workermain.js")?this.g_aJI["workermain.js"]:"playable-ad"===this.g_aoU&&this.g_aJS.hasOwnProperty(g.toLowerCase())?URL.createObjectURL(this.g_aJS[g.toLowerCase()]):g}async g_aKg(g,a,_){if(g.startsWith("blob:"))return new Worker(g,_);if(this.g_arl()){const a=await this.g_BK(this.g_aJG+g),e=new Blob([a],{type:"application/javascript"});return new Worker(URL.createObjectURL(e),_)}const t=new URL(g,a),n=location.origin!==t.origin;if(n){const g=await fetch(t);if(!g.ok)throw new Error("failed to fetch worker script");const a=await g.blob();return new Worker(URL.createObjectURL(a),_)}return new Worker(t,_)}g_aKb(){if(this.g_asz()){const g=document.documentElement.style,a=document.body.style,_=window.innerWidth<window.innerHeight,t=_?window.screen.width:window.screen.height,n=_?window.screen.height:window.screen.width;a.height=g.height=n+"px",a.width=g.width=t+"px"}}g_aKh(g){return{baseUrl:this.g_aoP,windowInnerWidth:window.innerWidth,windowInnerHeight:window.innerHeight,devicePixelRatio:window.devicePixelRatio,isFullscreen:e.g_aoa(),projectData:g.g_aKi,previewImageBlobs:window.cr_previewImageBlobs||this.g_aJS,previewProjectFileBlobs:window.cr_previewProjectFileBlobs,exportType:g.g_aJQ,isDebug:-1<self.location.search.indexOf("debug"),ife:!!self.g_aKj,jobScheduler:this.g_aqO.g_aKk(),supportedAudioFormats:d,opusWasmScriptUrl:window.cr_opusWasmScriptUrl||this.g_aJG+"opus.wasm.js",opusWasmBinaryUrl:window.cr_opusWasmBinaryUrl||this.g_aJG+"opus.wasm.wasm",isiOSCordova:this.g_arl(),isiOSWebView:this.g_asz(),isFBInstantAvailable:"undefined"!=typeof self.FBInstant}}async g_aKd(g,a){const e=this.g_aKf(g.g_aKl);this.g_aJJ=await this.g_aKg(e,this.g_aoP,{name:"Runtime"}),this.g_amQ=document.createElement("canvas"),this.g_amQ.style.display="none";const _=this.g_amQ.transferControlToOffscreen();document.body.appendChild(this.g_amQ),window.c3canvas=this.g_amQ,this.g_aJJ.postMessage(Object.assign(this.g_aKh(g),{type:"init-runtime",isInWorker:!0,messagePort:a,canvas:_,workerDependencyScripts:g.g_aKm||[],engineScripts:g.g_aJY,projectScripts:window.g_aKn,projectScriptsStatus:self.C3_ProjectScriptsStatus}),[a,_,...this.g_aqO.g_aKo()]),this.g_aJL=i.map(g=>new g(this)),this.g_aKp(),self.c3_callFunction=(g,a)=>this.g_aJM.g_Vd(g,a),"preview"===this.g_aoU&&(self.goToLastErrorScript=()=>this.g_aIZ("runtime","go-to-last-error-script"))}async g_aKe(a,g){this.g_amQ=document.createElement("canvas"),this.g_amQ.style.display="none",document.body.appendChild(this.g_amQ),window.c3canvas=this.g_amQ,this.g_aJL=i.map(g=>new g(this)),this.g_aKp();const t=a.g_aJY.map(g=>"string"==typeof g?new URL(g,this.g_aoP).toString():g);if(Array.isArray(a.g_aKm)&&t.unshift(...a.g_aKm),await Promise.all(t.map(a=>_(a))),a.g_aKq&&0<a.g_aKq.length){const g=self.C3_ProjectScriptsStatus;try{if(await Promise.all(a.g_aKq.map(a=>_(a[1]))),Object.values(g).some(g=>!g))return void self.setTimeout(()=>this.g_aKr(g),100)}catch(e){return console.error("[Preview] Error loading project scripts: ",e),void self.setTimeout(()=>this.g_aKr(g),100)}}if("preview"===this.g_aoU&&"object"!=typeof self.g_aO.g_aIS)return console.error("[C3 runtime] Failed to load JavaScript code used in events. Check all your JavaScript code has valid syntax."),void alert("Failed to load JavaScript code used in events. Check all your JavaScript code has valid syntax.");const n=Object.assign(this.g_aKh(a),{isInWorker:!1,messagePort:g,canvas:this.g_amQ,runOnStartupFunctions:m});this.g_aJK=self.C3_CreateRuntime(n),await self.C3_InitRuntime(this.g_aJK,n)}g_aKr(g){const a=Object.entries(g).filter(g=>!g[1]).map(g=>g[0]),e=`Failed to load project script '${a[0]}'. Check all your JavaScript code has valid syntax.`;console.error("[Preview] "+e),alert(e)}async g_aJV(){const g=await this.g_aqO.g_aKs();return{outputPort:g,transferables:[g]}}g_aJc(){if(this.g_aJD)throw new Error("not available in worker mode");return this.g_aJK}g_aIZ(g,a,_,t,n){this.g_aJF.postMessage({type:"event",component:g,handler:a,dispatchOpts:t||null,data:_,responseId:null},this.g_aJR?void 0:n)}g_aI$(_,a,t,n,i){const e=l++,o=new Promise((g,a)=>{U.set(e,{resolve:g,reject:a})});return this.g_aJF.postMessage({type:"event",component:_,handler:a,dispatchOpts:n||null,data:t,responseId:e},this.g_aJR?void 0:i),o}["_OnMessageFromRuntime"](g){const a=g.type;if("event"===a)this.g_aKt(g);else if("result"===a)this.g_aKu(g);else if("runtime-ready"===a)this.g_aKv();else if("alert"===a)alert(g.message);else throw new Error(`unknown message '${a}'`)}g_aKt(_){const t=_.component,n=_.handler,a=_.data,i=_.responseId,e=p.get(t);if(!e)return void console.warn(`[DOM] No event handlers for component '${t}'`);const o=e.get(n);if(!o)return void console.warn(`[DOM] No handler '${n}' for component '${t}'`);let g=null;try{g=o(a)}catch(g){return console.error(`Exception in '${t}' handler '${n}':`,g),void(null!==i&&this.g_aKw(i,!1,g.toString()))}null!==i&&(g&&g.then?g.then(g=>this.g_aKw(i,!0,g)).catch(g=>{console.error(`Rejection from '${t}' handler '${n}':`,g),this.g_aKw(i,!1,g.toString())}):this.g_aKw(i,!0,g))}g_aKw(g,a,e){let _;e&&e.transferables&&(_=e.transferables),this.g_aJF.postMessage({type:"result",responseId:g,isOk:a,result:e},_)}g_aKu(g){const a=g.responseId,_=g.isOk,t=g.result,n=U.get(a);_?n.resolve(t):n.reject(t),U.delete(a)}g_aJe(g,a,e){let _=p.get(g);if(_||(_=new Map,p.set(g,_)),_.has(a))throw new Error(`[DOM] Component '${g}' already has handler '${a}'`);_.set(a,e)}static g_aKx(g){if(i.includes(g))throw new Error("DOM handler already added");i.push(g)}g_aKp(){for(const g of this.g_aJL)if("runtime"===g.g_aJh())return void(this.g_aJM=g);throw new Error("cannot find runtime DOM handler")}g_aJ$(g){this.g_aIZ("debugger","message",g)}g_aKv(){for(const g of this.g_aJL)g.g_aIX()}static g_aoa(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement)}async g_aKy(){return await this.g_aI$("runtime","get-remote-preview-status-info")}g_aJi(g){this.g_aJP.push(g),this.g_arK()}g_aJj(g){const a=this.g_aJP.indexOf(g);if(-1===a)throw new Error("invalid callback");this.g_aJP.splice(a,1),this.g_aJP.length||this.g_arL()}g_arK(){-1===this.g_anx&&this.g_aJP.length&&(this.g_anx=requestAnimationFrame(this.g_aJN))}g_arL(){-1!==this.g_anx&&(cancelAnimationFrame(this.g_anx),this.g_anx=-1)}g_aJO(){this.g_anx=-1;for(const g of this.g_aJP)g();this.g_arK()}g_aKz(g){this.g_aJM.g_aKz(g)}g_aKA(g){this.g_aJM.g_aKA(g)}g_aKB(){this.g_aJM.g_aKB()}g_aHa(g){this.g_aJM.g_aHa(g)}g_Cf(g){return!!d[g]}async g_afT(g){const a=await this.g_aI$("runtime","opus-decode",{arrayBuffer:g},null,[g]);return new Float32Array(a)}g_fW(g){return /^(?:[a-z]+:)?\/\//.test(g)||"data:"===g.substr(0,5)||"blob:"===g.substr(0,5)}g_fX(g){return!this.g_fW(g)}async g_aJU(g){const a=g.filename;switch(g.as){case"text":return await this.g_BL(a);case"buffer":return await this.g_BK(a);default:throw new Error("unsupported type");}}g_aKC(){const g=window.cordova&&window.cordova.plugins&&window.cordova.plugins.permissions;if("object"!=typeof g)throw new Error("Permission API is not loaded");return g}g_aKD(g,a){const e=g[a];if("string"!=typeof e)throw new Error("Invalid permission name");return e}g_aKE(g){const a=this.g_aKC();return new Promise((e,_)=>a.checkPermission(this.g_aKD(a,g),g=>e(!!g.hasPermission),_))}g_aKF(g){const a=this.g_aKC();return new Promise((e,_)=>a.requestPermission(this.g_aKD(a,g),g=>e(!!g.hasPermission),_))}async g_aKG(g){if("cordova"!==this.g_asy())return!0;if(this.g_arl())return!0;for(const e of g){const g=await this.g_aKE(e);if(g)continue;const a=await this.g_aKF(e);if(!1===a)return!1}return!0}async g_aKH(...g){if(!1===(await this.g_aKG(g)))throw new Error("Permission not granted")}g_aKI(g){const e=window.cordova.file.applicationDirectory+"www/"+g.toLowerCase();return new Promise((g,a)=>{window.resolveLocalFileSystemURL(e,e=>{e.file(g,a)},a)})}async g_BL(g){const a=await this.g_aKI(g);return await t(a)}g_aKJ(){if(g.length&&!(8<=u)){u++;const e=g.shift();this.g_aKK(e.filename,e.g_aKL,e.g_aKM)}}g_BK(e){return new Promise((_,t)=>{g.push({filename:e,g_aKL:g=>{u--,this.g_aKJ(),_(g)},g_aKM:g=>{u--,this.g_aKJ(),t(g)}}),this.g_aKJ()})}async g_aKK(g,a,e){try{const _=await this.g_aKI(g),t=await r(_);a(t)}catch(g){e(g)}}async g_aJX(){const g=[];for(const[a,e]of Object.entries(this.g_aJS))g.push(this.g_aKN(a,e));await Promise.all(g)}async g_aKN(g,a){if("object"==typeof a)this.g_aJS[g]=new Blob([a.str],{type:a.type}),this.g_aJT[g]=a.str;else{let e=await this.g_aKO(a);e||(e=this.g_aKP(a)),this.g_aJS[g]=e}}async g_aKO(g){try{const a=await fetch(g);return await a.blob()}catch(g){return console.warn("Failed to fetch a data: URI. Falling back to a slower workaround. This is probably because the Content Security Policy unnecessarily blocked it. Allow data: URIs in your CSP to avoid this.",g),null}}g_aKP(g){const a=this.g_aKQ(g);return this.g_aKR(a.data,a.g_gn)}g_aKQ(_){const a=_.indexOf(",");if(0>a)throw new URIError("expected comma in data: uri");const t=_.substring(5,a),n=_.substring(a+1),o=t.split(";"),e=o[0]||"",r=o[1],g=o[2];let s;return s="base64"===r||"base64"===g?atob(n):decodeURIComponent(n),{g_gn:e,data:s}}g_aKR(_,a){let t,n,i=_.length,e=i>>2,o=new Uint8Array(i),g=new Uint32Array(o.buffer,0,e);for(t=0,n=0;t<e;++t)g[t]=_.charCodeAt(n++)|_.charCodeAt(n++)<<8|_.charCodeAt(n++)<<16|_.charCodeAt(n++)<<24;for(let g=3&i;g--;)o[n]=_.charCodeAt(n),++n;return new Blob([o],{type:a})}g_aKc(){let g=null;const e=new Promise(a=>g=a),_=new ArrayBuffer(1),t=new MessageChannel;return t.port2.onmessage=a=>{a.data&&a.data.arrayBuffer||(this.g_aJR=!0,console.warn("MessageChannel transfers determined to be broken. Disabling transferables.")),g()},t.port1.postMessage({arrayBuffer:_},[_]),e}}}{function _(g){return g.sourceCapabilities&&g.sourceCapabilities.firesTouchEvents||g.originalEvent&&g.originalEvent.sourceCapabilities&&g.originalEvent.sourceCapabilities.firesTouchEvents}function t(g){return new Promise((a,e)=>{const _=document.createElement("link");_.onload=()=>a(_),_.onerror=g=>e(g),_.rel="stylesheet",_.href=g,document.head.appendChild(_)})}function a(g){return new Promise((a,e)=>{const _=new Image;_.onload=()=>a(_),_.onerror=g=>e(g),_.src=g})}async function s(g){const e=URL.createObjectURL(g);try{return await a(e)}finally{URL.revokeObjectURL(e)}}function d(g){return new Promise((e,_)=>{let a=new FileReader;a.onload=g=>e(g.target.result),a.onerror=g=>_(g),a.readAsText(g)})}async function u(e,_,t){if(!/firefox/i.test(navigator.userAgent))return await s(e);let n=await d(e);const o=new DOMParser,g=o.parseFromString(n,"image/svg+xml"),r=g.documentElement;if(r.hasAttribute("width")&&r.hasAttribute("height")){const a=r.getAttribute("width"),g=r.getAttribute("height");if(!a.includes("%")&&!g.includes("%"))return await s(e)}r.setAttribute("width",_+"px"),r.setAttribute("height",t+"px");const i=new XMLSerializer;return n=i.serializeToString(g),e=new Blob([n],{type:"image/svg+xml"}),await s(e)}function e(g){do{if(g.parentNode&&g.hasAttribute("contenteditable"))return!0;g=g.parentNode}while(g);return!1}function g(g){const a=g.target.tagName.toLowerCase();o.has(a)&&g.preventDefault()}function U(g){(g.metaKey||g.ctrlKey)&&g.preventDefault()}function i(){try{return window.parent&&window.parent.document.hasFocus()}catch(g){return!1}}function c(){const g=document.activeElement;if(!g)return!1;const a=g.tagName.toLowerCase(),_=new Set(["email","number","password","search","tel","text","url"]);return"textarea"===a||("input"===a?_.has(g.type.toLowerCase()||"text"):e(g))}const h=new Map([["OSLeft","MetaLeft"],["OSRight","MetaRight"]]),l={dispatchRuntimeEvent:!0,dispatchUserScriptEvent:!0},m={dispatchUserScriptEvent:!0},n={dispatchRuntimeEvent:!0},o=new Set(["canvas","body","html"]);self.C3_GetSvgImageSize=async function(g){const e=await s(g);if(0<e.width&&0<e.height)return[e.width,e.height];else{e.style.position="absolute",e.style.left="0px",e.style.top="0px",e.style.visibility="hidden",document.body.appendChild(e);const g=e.getBoundingClientRect();return document.body.removeChild(e),[g.width,g.height]}},self.C3_RasterSvgImageBlob=async function(_,a,t,n,o){const e=await u(_,a,t),g=document.createElement("canvas");g.width=n,g.height=o;const r=g.getContext("2d");return r.drawImage(e,0,0,a,t),g};let p=!1;document.addEventListener("pause",()=>p=!0),document.addEventListener("resume",()=>p=!1);const f=class extends g_aIT{constructor(_){super(_,"runtime"),this.g_aKS=!0,this.g_aKT=-1,this.g_aKU="any",this.g_aKV=!1,this.g_aKW=!1,this.g_aKX=null,this.g_aKY=null,this.g_aKZ=null,_.g_aJe("canvas","update-size",g=>this.g_aK_(g)),_.g_aJe("runtime","invoke-download",g=>this.g_aK$(g)),_.g_aJe("runtime","raster-svg-image",g=>this.g_aLa(g)),_.g_aJe("runtime","get-svg-image-size",g=>this.g_aLb(g)),_.g_aJe("runtime","set-target-orientation",g=>this.g_aLc(g)),_.g_aJe("runtime","register-sw",()=>this.g_aLd()),_.g_aJe("runtime","post-to-debugger",g=>this.g_aLe(g)),_.g_aJe("runtime","go-to-script",g=>this.g_aLe(g)),_.g_aJe("runtime","before-start-ticking",()=>this.g_aLf()),_.g_aJe("runtime","debug-highlight",g=>this.g_aLg(g)),_.g_aJe("runtime","enable-device-orientation",()=>this.g_aLh()),_.g_aJe("runtime","enable-device-motion",()=>this.g_aLi()),_.g_aJe("runtime","add-stylesheet",g=>this.g_aLj(g));const t=new Set(["input","textarea","datalist"]);window.addEventListener("contextmenu",g=>{const a=g.target,_=a.tagName.toLowerCase();t.has(_)||e(a)||g.preventDefault()});const a=_.g_aJW();window.addEventListener("selectstart",g),window.addEventListener("gesturehold",g),a.addEventListener("selectstart",g),a.addEventListener("gesturehold",g),window.addEventListener("touchstart",g,{passive:!1}),"undefined"==typeof PointerEvent?a.addEventListener("touchstart",g):(window.addEventListener("pointerdown",g,{passive:!1}),a.addEventListener("pointerdown",g)),this.g_aLk=0,window.addEventListener("mousedown",g=>{1===g.button&&g.preventDefault()}),window.addEventListener("mousewheel",U,{passive:!1}),window.addEventListener("wheel",U,{passive:!1}),window.addEventListener("resize",()=>this.g_anO()),_.g_asz()&&window.addEventListener("focusout",()=>{c()||(document.scrollingElement.scrollTop=0)}),this.g_aLl=new Set,this.g_aLm=new WeakSet,this.g_aGj=!1}g_aLf(){return"cordova"===this.g_aqU.g_asy()?(document.addEventListener("pause",()=>this.g_aqQ(!0)),document.addEventListener("resume",()=>this.g_aqQ(!1))):document.addEventListener("visibilitychange",()=>this.g_aqQ(document.hidden)),{isSuspended:!!(document.hidden||p)}}g_aIX(){window.addEventListener("focus",()=>this.g_aLn("window-focus")),window.addEventListener("blur",()=>{this.g_aLn("window-blur",{parentHasFocus:i()}),this.g_aLk=0}),window.addEventListener("fullscreenchange",()=>this.g_anP()),window.addEventListener("webkitfullscreenchange",()=>this.g_anP()),window.addEventListener("mozfullscreenchange",()=>this.g_anP()),window.addEventListener("fullscreenerror",g=>this.g_anQ(g)),window.addEventListener("webkitfullscreenerror",g=>this.g_anQ(g)),window.addEventListener("mozfullscreenerror",g=>this.g_anQ(g)),window.addEventListener("keydown",g=>this.g_aLo("keydown",g)),window.addEventListener("keyup",g=>this.g_aLo("keyup",g)),window.addEventListener("dblclick",g=>this.g_aLp("dblclick",g,l)),window.addEventListener("wheel",g=>this.g_aLq("wheel",g)),"undefined"==typeof PointerEvent?(window.addEventListener("mousedown",g=>this.g_aLr("pointerdown",g)),window.addEventListener("mousemove",g=>this.g_aLr("pointermove",g)),window.addEventListener("mouseup",g=>this.g_aLr("pointerup",g)),window.addEventListener("touchstart",g=>this.g_aLs("pointerdown",g)),window.addEventListener("touchmove",g=>this.g_aLs("pointermove",g)),window.addEventListener("touchend",g=>this.g_aLs("pointerup",g)),window.addEventListener("touchcancel",g=>this.g_aLs("pointercancel",g))):(window.addEventListener("pointerdown",g=>this.g_aLt("pointerdown",g)),this.g_aqU.g_aJb()&&"undefined"!=typeof window.onpointerrawupdate?(this.g_aKY=new g_mM(()=>this.g_aLu(),5),this.g_aKY.g_mW(!0),window.addEventListener("pointerrawupdate",g=>this.g_aLv(g))):window.addEventListener("pointermove",g=>this.g_aLt("pointermove",g)),window.addEventListener("pointerup",g=>this.g_aLt("pointerup",g)),window.addEventListener("pointercancel",g=>this.g_aLt("pointercancel",g)));const g=()=>this.g_aKB();window.addEventListener("pointerup",g,!0),window.addEventListener("touchend",g,!0),window.addEventListener("click",g,!0),window.addEventListener("keydown",g,!0),window.addEventListener("gamepadconnected",g,!0)}g_aLn(g,a){this.g_aIY(g,a||null,n)}g_aLw(){return Math.max(window.innerWidth,1)}g_aLx(){return Math.max(window.innerHeight,1)}g_anO(){const g=this.g_aLw(),a=this.g_aLx();this.g_aLn("window-resize",{innerWidth:g,innerHeight:a,devicePixelRatio:window.devicePixelRatio}),this.g_aqU.g_asz()&&(-1!==this.g_aKT&&clearTimeout(this.g_aKT),this.g_aLy(g,a,0))}g_aLz(g,a,e){-1!==this.g_aKT&&clearTimeout(this.g_aKT),this.g_aKT=setTimeout(()=>this.g_aLy(g,a,e),48)}g_aLy(g,a,_){const t=this.g_aLw(),n=this.g_aLx();this.g_aKT=-1,t!=g||n!=a?this.g_aLn("window-resize",{innerWidth:t,innerHeight:n,devicePixelRatio:window.devicePixelRatio}):10>_&&this.g_aLz(t,n,_+1)}g_aLc(g){this.g_aKU=g.targetOrientation}g_aLA(){const g=this.g_aKU;if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(g).catch(g=>console.warn("[Construct 3] Failed to lock orientation: ",g));else try{let a=!1;screen.lockOrientation?a=screen.lockOrientation(g):screen.webkitLockOrientation?a=screen.webkitLockOrientation(g):screen.mozLockOrientation?a=screen.mozLockOrientation(g):screen.msLockOrientation&&(a=screen.msLockOrientation(g)),a||console.warn("[Construct 3] Failed to lock orientation")}catch(g){console.warn("[Construct 3] Failed to lock orientation: ",g)}}g_anP(){const g=g_aJC.g_aoa();g&&"any"!==this.g_aKU&&this.g_aLA(),this.g_aIY("fullscreenchange",{isFullscreen:g,innerWidth:this.g_aLw(),innerHeight:this.g_aLx()})}g_anQ(g){console.warn("[Construct 3] Fullscreen request failed: ",g),this.g_aIY("fullscreenerror",{isFullscreen:g_aJC.g_aoa(),innerWidth:this.g_aLw(),innerHeight:this.g_aLx()})}g_aqQ(g){g?this.g_aqU.g_arL():this.g_aqU.g_arK(),this.g_aIY("visibilitychange",{hidden:g})}g_aLo(e,a){"Backspace"===a.key&&g(a);const _=h.get(a.code)||a.code;this.g_aJa(e,{code:_,key:a.key,which:a.which,repeat:a.repeat,altKey:a.altKey,ctrlKey:a.ctrlKey,metaKey:a.metaKey,shiftKey:a.shiftKey,timeStamp:a.timeStamp},l)}g_aLq(g,a){this.g_aIY(g,{clientX:a.clientX,clientY:a.clientY,deltaX:a.deltaX,deltaY:a.deltaY,deltaZ:a.deltaZ,deltaMode:a.deltaMode,timeStamp:a.timeStamp},l)}g_aLp(a,g,e){_(g)||("mousedown"===a&&window!==window.top&&window.focus(),this.g_aJa(a,{button:g.button,buttons:g.buttons,clientX:g.clientX,clientY:g.clientY,timeStamp:g.timeStamp},e))}g_aLr(a,g){if(!_(g)){"pointerdown"===a&&window!==window.top&&window.focus();const e=this.g_aLk;"pointerdown"===a&&0!==e?a="pointermove":"pointerup"==a&&0!==g.buttons&&(a="pointermove"),this.g_aJa(a,{pointerId:1,pointerType:"mouse",button:g.button,buttons:g.buttons,lastButtons:e,clientX:g.clientX,clientY:g.clientY,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,timeStamp:g.timeStamp},l),this.g_aLk=g.buttons,this.g_aLp(g.type,g,m)}}g_aLt(g,a){"pointerdown"===g&&window!==window.top&&window.focus(),this.g_aKY&&"pointermove"!==g&&this.g_aKY.g_lz();let e=0;if("mouse"===a.pointerType&&(e=this.g_aLk),this.g_aJa(g,{pointerId:a.pointerId,pointerType:a.pointerType,button:a.button,buttons:a.buttons,lastButtons:e,clientX:a.clientX,clientY:a.clientY,width:a.width||0,height:a.height||0,pressure:a.pressure||0,tangentialPressure:a.tangentialPressure||0,tiltX:a.tiltX||0,tiltY:a.tiltY||0,twist:a.twist||0,timeStamp:a.timeStamp},l),"mouse"===a.pointerType){let e="mousemove";"pointerdown"===g?e="mousedown":"pointerup"==g&&(e="pointerup"),this.g_aLp(e,a,m),this.g_aLk=a.buttons}}g_aLv(g){this.g_aKZ=g,this.g_aKY.g_m_()}g_aLu(){this.g_aLt("pointermove",this.g_aKZ),this.g_aKZ=null}g_aLs(g,a){"pointerdown"===g&&window!==window.top&&window.focus();for(let e=0,_=a.changedTouches.length;e<_;++e){const _=a.changedTouches[e];this.g_aJa(g,{pointerId:_.identifier,pointerType:"touch",button:0,buttons:0,lastButtons:0,clientX:_.clientX,clientY:_.clientY,width:2*(_.radiusX||_.webkitRadiusX||0),height:2*(_.radiusY||_.webkitRadiusY||0),pressure:_.force||_.webkitForce||0,tangentialPressure:0,tiltX:0,tiltY:0,twist:_.rotationAngle||0,timeStamp:a.timeStamp},l)}}g_aLh(){this.g_aKV||(this.g_aKV=!0,window.addEventListener("deviceorientation",g=>this.g_aLB(g)))}g_aLi(){this.g_aKW||(this.g_aKW=!0,window.addEventListener("devicemotion",g=>this.g_aLC(g)))}g_aLB(g){this.g_aIY("deviceorientation",{alpha:g.alpha||0,beta:g.beta||0,gamma:g.gamma||0,timeStamp:g.timeStamp},l)}g_aLC(_){let a=null;const t=_.acceleration;t&&(a={x:t.x||0,y:t.y||0,z:t.z||0});let n=null;const i=_.accelerationIncludingGravity;i&&(n={x:i.x||0,y:i.y||0,z:i.z||0});let e=null;const o=_.rotationRate;o&&(e={alpha:o.alpha||0,beta:o.beta||0,gamma:o.gamma||0}),this.g_aIY("devicemotion",{acceleration:a,accelerationIncludingGravity:n,rotationRate:e,interval:_.interval,timeStamp:_.timeStamp},l)}g_aK_(g){const a=this.g_aJg(),e=a.g_aJW();e.style.width=g.styleWidth+"px",e.style.height=g.styleHeight+"px",e.style.marginLeft=g.marginLeft+"px",e.style.marginTop=g.marginTop+"px",a.g_aKb(),this.g_aKS&&(e.style.display="",this.g_aKS=!1)}g_aK$(g){const _=g.url,t=g.filename,n=document.createElement("a"),e=document.body;n.textContent=t,n.href=_,n.download=t,e.appendChild(n),n.click(),e.removeChild(n)}async g_aLa(_){const a=_.blob,t=_.imageWidth,n=_.imageHeight,o=_.surfaceWidth,e=_.surfaceHeight,r=_.imageBitmapOpts,g=await self.C3_RasterSvgImageBlob(a,t,n,o,e);let s;return s=r?await createImageBitmap(g,r):await createImageBitmap(g),{imageBitmap:s,transferables:[s]}}async g_aLb(g){return await self.C3_GetSvgImageSize(g.blob)}async g_aLj(g){await t(g.url)}g_aKB(){const g=[...this.g_aLl];if(this.g_aLl.clear(),!this.g_aGj)for(const e of g){const g=e.play();g&&g.catch(()=>{this.g_aLm.has(e)||this.g_aLl.add(e)})}}g_aKz(g){if("function"!=typeof g.play)throw new Error("missing play function");this.g_aLm.delete(g);let a;try{a=g.play()}catch(a){return void this.g_aLl.add(g)}a&&a.catch(()=>{this.g_aLm.has(g)||this.g_aLl.add(g)})}g_aKA(g){this.g_aLl.delete(g),this.g_aLm.add(g)}g_aHa(g){this.g_aGj=!!g}g_aLg(g){const a=g.show;if(!a)return void(this.g_aKX&&(this.g_aKX.style.display="none"));this.g_aKX||(this.g_aKX=document.createElement("div"),this.g_aKX.id="inspectOutline",document.body.appendChild(this.g_aKX));const e=this.g_aKX;e.style.display="",e.style.left=g.left-1+"px",e.style.top=g.top-1+"px",e.style.width=g.width+2+"px",e.style.height=g.height+2+"px",e.textContent=g.name}g_aLd(){window.C3_RegisterSW&&window.C3_RegisterSW()}g_aLe(g){window.c3_postToMessagePort&&(g.from="runtime",window.c3_postToMessagePort(g))}g_Vd(g,a){return this.g_aI_("js-invoke-function",{name:g,params:a})}};g_aJC.g_aKx(f)}{const g=document.currentScript.src;self.g_aKa=class{constructor(a){this.g_aLD=a,this.g_aoP=g?g.substr(0,g.lastIndexOf("/")+1):a.g_fe(),this.g_atf=Math.min(navigator.hardwareConcurrency||2,16),this.g_aLE=null,this.g_aLF=[],this.g_atd=null,this.g_aLG=null}async g_ajY(){if(this.g_aLH)throw new Error("already initialised");this.g_aLH=!0;const g=this.g_aLD.g_aKf("dispatchworker.js");this.g_aLE=await this.g_aLD.g_aKg(g,this.g_aoP,{name:"DispatchWorker"});const a=new MessageChannel;this.g_atd=a.port1,this.g_aLE.postMessage({type:"_init","in-port":a.port2},[a.port2]),this.g_aLG=await this.g_aKs()}async g_aKs(){const g=this.g_aLF.length,a=this.g_aLD.g_aKf("jobworker.js"),_=await this.g_aLD.g_aKg(a,this.g_aoP,{name:"JobWorker"+g}),t=new MessageChannel,n=new MessageChannel;return this.g_aLE.postMessage({type:"_addJobWorker",port:t.port1},[t.port1]),_.postMessage({type:"init",number:g,"dispatch-port":t.port2,"output-port":n.port2},[t.port2,n.port2]),this.g_aLF.push(_),n.port1}g_aKk(){return{inputPort:this.g_atd,outputPort:this.g_aLG,maxNumWorkers:this.g_atf}}g_aKo(){return[this.g_atd,this.g_aLG]}}}if("use strict",window.C3_IsSupported){"undefined"!=typeof OffscreenCanvas;window.c3_runtimeInterface=new g_aJC({g_aJE:!1,g_aKl:"workermain.js",g_aJY:["scripts/c3runtime.js"],g_aJH:"scripts/",g_aKm:[],g_aJQ:"html5"})}{function g(g){g.stopPropagation()}function a(g){13!==g.which&&27!==g.which&&g.stopPropagation()}const e=class extends g_aJk{constructor(g){super(g,"text-input"),this.g_aJu("scroll-to-bottom",g=>this.g_aLI(g))}g_aex(_,t){let n;const i=t.type;return"textarea"===i?(n=document.createElement("textarea"),n.style.resize="none"):(n=document.createElement("input"),n.type=i),n.style.position="absolute",n.autocomplete="off",n.addEventListener("touchstart",g),n.addEventListener("touchmove",g),n.addEventListener("touchend",g),n.addEventListener("mousedown",g),n.addEventListener("mouseup",g),n.addEventListener("keydown",a),n.addEventListener("keyup",a),n.addEventListener("click",g=>{g.stopPropagation(),this.g_aJx("click",_)}),n.addEventListener("dblclick",g=>{g.stopPropagation(),this.g_aJx("dblclick",_)}),n.addEventListener("input",()=>this.g_aJw("change",_,{text:n.value})),n.id=t.id,this.g_aJy(n,t),n}g_aJy(g,a){g.value=a.text,g.placeholder=a.placeholder,g.title=a.title,g.disabled=!a.isEnabled,g.readOnly=a.isReadOnly,g.spellcheck=a.spellCheck}g_aLI(g){g.scrollTop=g.scrollHeight}};g_aJC.g_aKx(e)}{function g(g){g.stopPropagation()}const a=class extends g_aJk{constructor(g){super(g,"button")}g_aex(a,_){const t=document.createElement("input"),n=_.isCheckbox;let e=t;if(n){t.type="checkbox";const g=document.createElement("label");g.appendChild(t),g.appendChild(document.createTextNode("")),g.style.fontFamily="sans-serif",g.style.userSelect="none",g.style.webkitUserSelect="none",g.style.display="inline-block",g.style.color="black",e=g}else t.type="button";return e.style.position="absolute",e.addEventListener("touchstart",g),e.addEventListener("touchmove",g),e.addEventListener("touchend",g),e.addEventListener("mousedown",g),e.addEventListener("mouseup",g),e.addEventListener("keydown",g),e.addEventListener("keyup",g),t.addEventListener("click",()=>this.g_aJx("click",a,{isChecked:t.checked})),t.id=_.id,this.g_aJy(e,_),e}g_aLJ(g){return"input"===g.tagName.toLowerCase()?g:g.firstChild}g_aJy(g,a){const e=this.g_aLJ(g);e.checked=a.isChecked,e.disabled=!a.isEnabled,g.title=a.title,g===e?e.value=a.text:g.lastChild.textContent=a.text}};g_aJC.g_aKx(a)}{function _(g){g.stopPropagation()}const a=class extends g_aJk{constructor(g){super(g,"list"),this.g_aJu("set-selected-index",(g,a)=>this.g_aLK(g,a.selectedIndex)),this.g_aJu("add-item",(g,a)=>this.g_aLL(g,a)),this.g_aJu("remove-item",(g,a)=>this.g_aLM(g,a)),this.g_aJu("set-item",(g,a)=>this.g_aLN(g,a)),this.g_aJu("clear",g=>this.g_aLO(g)),this.g_aJu("load-state",(g,a)=>this.g_aLP(g,a))}g_aex(t,a){const n=a.isDropdown,i=a.isMultiSelect,e=a.items,o=document.createElement("select");o.style.position="absolute",o.style.userSelect="none",o.style.webkitUserSelect="none",o.multiple=i,n||(o.size=2);for(const g of e)o.add(this.g_aLQ(g));return o.addEventListener("touchstart",_),o.addEventListener("touchmove",_),o.addEventListener("touchend",_),o.addEventListener("mousedown",_),o.addEventListener("mouseup",_),o.addEventListener("click",g=>{g.stopPropagation(),this.g_aJx("click",t,this.g_aLR(o))}),o.addEventListener("dblclick",g=>{g.stopPropagation(),this.g_aJx("dblclick",t,this.g_aLR(o))}),o.addEventListener("change",()=>this.g_aJw("change",t,this.g_aLR(o))),o.id=a.id,this.g_aJy(o,a),o}g_aLQ(g){const a=document.createElement("option");return a.text=g,a}g_aLR(g){const a=g.selectedIndex,e=[];for(let a=0,_=g.length;a<_;++a)g.options[a].selected&&e.push(a);return{selectedIndex:a,selectedIndices:e}}g_aJy(g,a){g.title=a.title,g.disabled=!a.isEnabled,g.multiple=!!a.isMultiSelect}g_aLK(g,a){g.selectedIndex=a}g_aLL(g,a){const _=a.text,t=a.index,n=this.g_aLQ(_);0>t?g.add(n):g.add(n,t)}g_aLM(g,a){g.remove(a.index)}g_aLN(g,a){g.options[a.index].text=a.text}g_aLO(g){g.innerHTML=""}g_aLP(g,a){g.innerHTML="";for(const e of a.items)g.add(this.g_aLQ(e));g.selectedIndex=a.selectedIndex;for(const e of a.selectedIndices){const a=g.options[e];a&&(a.selected=!0)}}};g_aJC.g_aKx(a)}{function _(a){return a%=d,0>a&&(a+=d),a}function t(g,e,_){return g<e?e:g>_?_:g}function n(g,e,a){return g+a*(e-g)}function o(g,e,a){return g===e?0:(a-g)/(e-g)}function r(_,a){var t=Math.cos,n=Math.sin;if(_===a)return 0;const o=n(_),e=t(_),r=n(a),g=t(a),s=o*r+e*g;return 1<=s?0:-1>=s?Math.PI:Math.acos(s)}function e(_,a){var t=Math.cos,n=Math.sin;const i=n(_),e=t(_),o=n(a),g=t(a);return 0>=e*o-i*g}function s(t,n,a){const i=r(t,n);return e(n,t)?_(t+i*a):_(t-i*a)}const g=[],d=2*Math.PI;class u{constructor(g,a,_,t,n,e){this.g_Di=g,this.g_aLS=a,this.g_aLT=_,this.g_aLU=t,this.g_aLV=n,this.g_aLW=e}g_aLX(){return{tag:this.g_aLU,interp:this.g_aLS,userData:this.g_aLV,cvt:this.g_aLW}}g_ED(){return this.g_Di}g_aBu(){return this.g_aLS}g_aLY(){return this.g_aLT}g_aLZ(){return this.g_aLU}g_aL_(){return"undefined"!=typeof this.g_aLV}g_aL$(){return this.g_aLV}g_aMa(){return this.g_aLW}g_aMb(a){switch(this.g_aLT){case 0:return a;case 1:return Math.fround(a);case 2:return 2===this.g_aLS&&(a=_(a),a/=Math.PI,a-=1,a*=32767),t(0|a,-32768,32767);case 3:return 2===this.g_aLS&&(a=_(a),a/=d,a*=255),t(0|a,0,255);default:return a;}}g_aMc(g,a,e){switch(this.g_aLT){case 0:g.setFloat64(a,e),a+=8;break;case 1:g.setFloat32(a,e),a+=4;break;case 2:g.setInt16(a,e),a+=2;break;case 3:g.setUint8(a,e),a+=1;break;default:g.setFloat32(a,e),a+=4;}return a}g_aMd(g){return 2===this.g_aLS?2===this.g_aLT?(g/=32767,g+=1,g*=Math.PI,g):3===this.g_aLT?(g/=255,g*=d,g):g:g}static g_aMe(g,a,_,t,e){return 0===g?e?_:a:1===g?n(a,_,t):2===g?s(a,_,t):e?_:a}}class i{constructor(g,a){this.timestamp=g,this.data=a}}class p{constructor(g,a,e){this.g_aMf=g,this.g_aMg=g.g_aMh(),this.g_Ro=a,this.g_aMi=e,this._data=[],this._data.length=this.g_aMf.g_aMj().length,this.g_aMk=0,this.g_aMl=0,this.g_aMm=!1,this.g_aMn=!1,this.g_aMo=[],this.g_aMp=null,this.g_aMq=null,this.g_aMr=null}g_aLX(){const g=[];for(let a=0,e=this.g_aMf.g_aMj().length;a<e;++a)g.push(this.g_aBu(this.g_aMf.g_aMs(),a));const a={id:this.g_Ro,nid:this.g_aMi,isTimedOut:this.g_aMt(),interpValues:g,latestUpdate:null},e=this.g_aMu();return e&&(a.latestUpdate={timestamp:e.timestamp,data:e.data}),a}g_LJ(){return this.g_Ro}g_aMv(){return this.g_aMi}g_aMw(a){this.g_aMn=!!a}g_aMx(){return this.g_aMn}g_aMy(){return this.g_aMm}g_aMz(_,t){const n=_.netValues,i=this.g_aMf.g_aMj(),a=i.length;this.g_aMm=!1;for(let g=0;g<a;++g){const _=i[g],a=_.g_aMb(n[g]);this._data[g]!==a&&(this._data[g]=a,this.g_aMk=t,this.g_aMf.g_aMA(t))}const e=t-this.g_aMk,o=t-this.g_aMl,g=this.g_aMf.g_aMB();this.g_aMm=!!(100>e&&0===g)||(1e3>e&&1>=g?95<=o:495<=o),this.g_aMm&&this.g_aMf.g_aMC()}g_aMD(g,a,e){const _=this.g_aMf.g_aMj();this.g_aMl=e,g.setUint16(a,this.g_aMi),a+=2;for(let t=0,n=this._data.length;t<n;++t)a=_[t].g_aMc(g,a,this._data[t]);return a}g_aME(g,a){for(let e=0,_=this.g_aMo.length;e<_;++e){const _=this.g_aMo[e];if(_.timestamp===g)return;if(_.timestamp>g)return void this.g_aMo.splice(e,0,new i(g,a))}this.g_aMo.push(new i(g,a))}g_aMt(){return 0!==this.g_aMo.length&&this.g_aMo[this.g_aMo.length-1].timestamp<this.g_aMf.g_aMs()-3e3}g_KM(){for(;2<this.g_aMo.length&&this.g_aMo[0]!==this.g_aMp&&this.g_aMo[0]!==this.g_aMq&&this.g_aMo[0]!==this.g_aMr;)this.g_aMo.shift();const g=this.g_aMf.g_aMs();if(!(this.g_aMr&&this.g_aMr.timestamp>g&&this.g_aMq&&this.g_aMq.timestamp<g)){this.g_aMr=null;for(let a=0,e=this.g_aMo.length;a<e;++a){const e=this.g_aMo[a];if(e.timestamp<=g)(!this.g_aMq||e.timestamp>this.g_aMq.timestamp)&&(this.g_aMp=this.g_aMq,this.g_aMq=e);else{this.g_aMr=e;break}}}}g_aMu(){return 0===this.g_aMo.length?null:this.g_aMo[this.g_aMo.length-1]}g_aBu(_,a,t){if(!this.g_aMr&&!this.g_aMq)return 0;if(this.g_aMr&&!this.g_aMq)return this.g_aMr.data[a];const n=this.g_aMf.g_aMj();let e,r,s,d,l;if(!this.g_aMr&&this.g_aMq){if(this.g_aMp&&!t){e=this.g_aMp.timestamp,r=this.g_aMp.data[a],s=this.g_aMq.timestamp,d=this.g_aMq.data[a];let g=_;return g>this.g_aMq.timestamp+this.g_aMf.g_aMF()&&(g=this.g_aMq.timestamp+this.g_aMf.g_aMF()),l=o(e,s,g),u.g_aMe(n[a].g_aBu(),r,d,l,!0)}return this.g_aMq.data[a]}return e=this.g_aMq.timestamp,r=this.g_aMq.data[a],s=this.g_aMr.timestamp,d=this.g_aMr.data[a],l=o(e,s,_),u.g_aMe(n[a].g_aBu(),r,d,l,!1)}}self.g_aMG=u,self.g_aMH=i,self.g_aMI=class{constructor(g,a,e,_){switch(this.g_aMg=g,this.g_aMJ=a,this.g_Dj=e,this.g_aMi=this.g_aMg.g_aMK(),this.g_aML=_,this.g_aLV={},this.g_aMM=0,this.g_aMN=250,this.g_aML){case 1:this.g_aMN=500;break;case 2:this.g_aMN=2500;}this.g_aMO=[],this.g_aMP=[],this.g_aMQ=new Map,this.g_aMR=new Set,this.g_aMS=0,this.g_aMk=0,this.g_aMl=0,this.g_aMT=0,this.g_aMU=!1,this.g_aMV=[],this.g_aMW=new Map,this.g_aMX=new Map,this.g_az_=0,this.g_aMg.g_aMY(this)}g_aMh(){return this.g_aMg}g_aMj(){return this.g_aMO}g_aMZ(){return this.g_aMJ}g_aM_(g){this.g_aMi=g}g_aMv(){return this.g_aMi}g_aMA(g){this.g_aMk=g}g_aMB(){return this.g_aML}g_aMC(){this.g_aMT++}g_aM$(){return this.g_aMT}g_aMs(){return this.g_az_}g_aNa(g){this.g_aMU=!!g}g_aNb(){return this.g_aMU}g_aMF(){return this.g_aMN}g_aNc(){return this.g_Dj}g_aNd(){return this.g_aMV}g_aNe(g,a,_,t,n){const e=new u(this.g_aMO.length,g,a,_,t,n);0===a?this.g_aMM+=8:1===a?this.g_aMM+=4:2===a?this.g_aMM+=2:3===a?this.g_aMM+=1:void 0,this.g_aMO.push(e)}g_aME(g,a,e){const _=this.g_aNf(a);_.g_aME(g,e)}g_KM(){this.g_az_=this.g_aMg.g_aNg();for(const g of this.g_aMP)g.g_KM()}g_aNh(){return this.g_aMP.length}g_aNi(g){return g=Math.floor(g),0>g||g>=this.g_aMP.length?null:this.g_aMP[g]}g_aNj(g){for(const a of this.g_aMP)if(a.g_aMv()===g)return a;return null}g_aNk(){const g=[];for(const a of this.g_aMO){const e={tag:a.g_aLZ(),precision:a.g_aLY(),interp:a.g_aBu(),clientvaluetag:a.g_aMa()};a.g_aL_()&&(e.userdata=a.g_aL$()),g.push(e)}return g}g_aNl(g){this.g_aMO.length=0,this.g_aMM=0;for(const a of g)this.g_aNe(a.interp,a.precision,a.tag,a.userdata,a.clientvaluetag)}g_aNf(g){let a=this.g_aMX.get(g);return a?a:(a=new p(this,-1,g),this.g_aMX.set(g,a),this.g_aMP.push(a),a)}g_aNm(g){let a=this.g_aMQ.get(g);return a?a:(a=new p(this,g,this.g_aNn()),this.g_aMQ.set(g,a),this.g_aMP.push(a),a)}g_aNn(){do this.g_aMS++,65535<this.g_aMS&&(this.g_aMS=0);while(this.g_aMR.has(this.g_aMS));const g=this.g_aMS;return this.g_aMR.add(g),g}g_aNo(g){const a=g.g_LJ(),e=g.g_aMv();this.g_aMg.g_aAF()&&!this.g_aMU&&this.g_aMV.push(e),this.g_aMQ.delete(a),this.g_aMX.delete(e),this.g_aMR.delete(e);const _=this.g_aMP.indexOf(g);-1<_&&this.g_aMP.splice(_,1)}g_aMz(_,a){this.g_aMT=0;for(const g of this.g_aMP)g.g_aMw(!1);for(let g=0,e=_.length;g<e;++g){const t=_[g],e=t.uid,n=this.g_aNm(e);n.g_aMw(!0),n.g_aMz(t,a)}for(const e of this.g_aMP)e.g_aMx()||g.push(e);for(const e of g)this.g_aNo(e);g.length=0}g_aMD(g,a,e){g.setUint16(a,this.g_aMi),a+=2;let _=0;this.g_aMU&&(_=1),g.setUint8(a,_),a+=1,g.setUint16(a,this.g_aMT),a+=2,g.setUint16(a,this.g_aMM),a+=2;for(const _ of this.g_aMP)_.g_aMy()&&(a=_.g_aMD(g,a,e));return a}g_aNp(g,a){if(this.g_aMQ.has(g))return void console.warn("OverrideNid passed id "+g+" which is already in use and cannot be overridden");if(this.g_aMR.has(a))return void console.warn("OverrideNid passed nid "+a+" which is already in use and cannot be overridden");const e=new p(this,g,a);return this.g_aMQ.set(g,e),this.g_aMR.add(a),this.g_aMP.push(e),this.g_aMU=!0,e}g_aNq(g){const a=this.g_aMQ.get(g);a&&this.g_aNo(a)}g_aNr(g){const a=this.g_aMX.get(g);a&&this.g_aNo(a)}g_aLX(){return{hasOverriddenNids:this.g_aNb(),netValues:this.g_aMO.map(g=>g.g_aLX()),netInstances:this.g_aMP.map(g=>g.g_aLX())}}g_aNs(){return{roId:this.g_aMJ,sid:this.g_Dj,netValues:this.g_aMO.map(g=>g.g_aLX())}}}}{function g(g){if(g)try{g.close()}catch(g){}}function _(g,e,a){return g===e?0:(a-g)/(e-g)}const t=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection||window.msRTCPeerConnection,n=[];class i{constructor(g,a,e){this.g_aMg=g,this.g_Ro=a,this.g_aMi=0,this.g_aNt=e,this.g_aNu=null,this.g_aNv=null,this.g_aNw=!1,this.g_aNx=null,this.g_aNy=!1,this.g_aNz=null,this.g_aNA=!1,this.g_aNB=!1,this.g_aNC=!1,this.g_aND=!1,this.g_aNE=!1,this.g_aNF=0,this.g_aNG=0,this.g_aNH=0,this.g_aNI=[],this.g_aNJ=0,this.g_aNK=0,this.g_aNL=[],this.g_aMp=null,this.g_aMq=null,this.g_aMr=null,this.g_aNM=0,this.g_aNN=!1,this.g_aNO=1,this.g_aNP=[],this.g_aNQ=0,this.g_aNR=0,this.g_aMg.g_aNS(this)}g_LJ(){return this.g_Ro}g_aMv(){return this.g_aMi}g_aM_(g){this.g_aMi=g}g_aNT(){return this.g_aNt}g_aAF(){return this===this.g_aMg.g_aNU()}g_aNV(){return this===this.g_aMg.g_aNW()}g_aNX(){return this.g_aNI}g_aNY(g){this.g_aNJ=g}g_aNZ(){return this.g_aNJ}g_aN_(g){this.g_aNK=g}g_aN$(){return this.g_aNK}g_aOa(){return this.g_aNQ}g_aOb(){return this.g_aNR}g_aOc(g,e){g.binaryType="arraybuffer",g.onopen=()=>{"o"===e?this.g_aNw=!0:"r"===e?this.g_aNy=!0:"u"==e&&(this.g_aNA=!0),this.g_aOd()},g.onmessage=g=>{this.g_aOe(e,g)},g.onerror=g=>{console.error("Peer '"+this.g_Ro+"' datachannel '"+e+"' error: ",g),this.g_aMg.g_aOf(this,g),this.g_aMg.g_aAF()&&!this.g_aAF()&&this.g_lL("network error")},g.onclose=()=>{this.g_lL("disconnect")}}g_aOg(){if(this.g_aNV())return;const g=this.g_aMg.g_aAF();this.g_aNw=!1,this.g_aNy=!1,this.g_aNA=!1,this.g_aNB=!1,this.g_aNC=!1,this.g_aNG=performance.now(),this.g_aNu=new t({iceServers:this.g_aMg.g_aOh()}),this.g_aNu.onicecandidate=g=>{g.candidate&&this.g_aMg.g_aOi({message:"icecandidate",toclientid:this.g_Ro,icecandidate:g.candidate})},this.g_aNu.onsignalingstatechange=()=>{this.g_aNu&&("closed"!==this.g_aNu.signalingState||this.g_lL("disconnect"))},this.g_aNu.oniceconnectionstatechange=()=>{this.g_aNu&&("failed"!==this.g_aNu.iceConnectionState&&"closed"!==this.g_aNu.iceConnectionState||this.g_lL("disconnect"))},this.g_aNu.onconnectionstatechange=()=>{if(this.g_aNu){const g=this.g_aNu.connectionState;("failed"===g||"closed"===g)&&this.g_lL("disconnect")}};const e=`c2mp_${this.g_aMg.g_aOj()}_${this.g_aMg.g_aOk()}_${this.g_aMg.g_aOl()}`;g?(this.g_aMi=this.g_aMg.g_aOm(),this.g_aNv=this.g_aNu.createDataChannel("o",{ordered:!0,protocol:e}),this.g_aOc(this.g_aNv,"o"),this.g_aNx=this.g_aNu.createDataChannel("r",{ordered:!1,protocol:e}),this.g_aOc(this.g_aNx,"r"),this.g_aNz=this.g_aNu.createDataChannel("u",{ordered:!1,g_aOn:0,protocol:e}),this.g_aOc(this.g_aNz,"u"),this.g_aNu.createOffer().then(g=>{this.g_aNu.setLocalDescription(g),this.g_aMg.g_aOi({message:"offer",toclientid:this.g_Ro,offer:g})}).catch(g=>{console.error("Host error creating offer for peer '"+this.g_Ro+"': ",g),this.g_aMg.g_aOf(this,"could not create offer for peer")})):this.g_aNu.ondatachannel=g=>{if(g.channel.protocol!==e)return console.error("Unexpected datachannel protocol '"+g.channel.protocol+"', should be '"+g_aOo+"'"),void this.g_aMg.g_aOf(this,"unexpected datachannel protocol '"+g.channel.protocol+"', should be '"+g_aOo+"'");const a=g.channel.label;"o"===a?this.g_aNv=g.channel:"r"===a?this.g_aNx=g.channel:"u"===a?this.g_aNz=g.channel:(console.error("Unknown datachannel label: "+g.channel.label),this.g_aMg.g_aOf(this,"unknown datachannel label '"+g.channel.label+"'")),this.g_aOc(g.channel,a)}}async g_aOp(g){if(this.g_aNu)try{await this.g_aNu.addIceCandidate(g)}catch(g){console.warn("[Multiplayer] Error adding ICE candidate: ",g)}}g_aOq(){return!!this.g_aNu}g_aOr(){return this.g_aNu}g_aOd(){this.g_aNB||this.g_aNy&&this.g_aNA&&this.g_aNw&&(this.g_aOs(),this.g_aNB=!0,this.g_aNC=!1)}g_aOs(){if(this.g_aNF=performance.now(),this.g_aMg.g_aAF()){this.g_aMg.g_aOt("o",JSON.stringify({c:"j",i:this.g_Ro,n:this.g_aMi,a:this.g_aNt}),this),this.g_aOu("o",JSON.stringify({c:"hi",hn:this.g_aMg.g_aNU().g_aMv(),n:this.g_aMi,d:this.g_aMg.g_aOv(),u:this.g_aMg.g_aOw(),objs:this.g_aMg.g_aOx(),cvs:this.g_aMg.g_aOy()}));for(const g of this.g_aMg.g_aOz())!g.g_aAF()&&g!==this&&g.g_aOA()&&this.g_aOu("o",JSON.stringify({c:"j",i:g.g_LJ(),n:g.g_aMv(),a:g.g_aNT()}))}else this.g_aNE=!0,this.g_aAF()&&this.g_aOB(performance.now(),!0);this.g_aMg.g_aAq(this)}g_aOC(g){this.g_aNC||!this.g_aNB||(this.g_aOD(g),this.g_aNC=!0,this.g_aNB=!1)}g_aOD(g){this.g_aMg.g_aAF()&&!this.g_aNV()&&this.g_aMg.g_aOt("o",JSON.stringify({c:"l",i:this.g_Ro,a:this.g_aNt,r:g}),this),this.g_aNV()||this.g_aMg.g_aAs(this,g)}g_aOA(){return this.g_aNB&&!this.g_aNC}g_aOu(g,a){this.g_aMg.g_aOE();let _=0;a.length?_=a.length:a.byteLength&&(_=a.byteLength),this.g_aMg.g_aOF(_);const t=this.g_aMg.g_aOG(),n=this.g_aMg.g_aOH(),e=this.g_aMg.g_aOI();if(!(0<t&&"u"===g&&Math.random()<t))if(0===n&&0===e)this.g_aOJ(g,a);else{let _=1;"u"!==g&&Math.random()<t&&(_=3),setTimeout(()=>this.g_aOJ(g,a),n*_+Math.random()*e*_)}}g_aOJ(g,a){try{"o"===g?this.g_aNw&&this.g_aNv&&this.g_aNv.send(a):"r"===g?this.g_aNy&&this.g_aNx&&this.g_aNx.send(a):"u"==g&&this.g_aNA&&this.g_aNz&&this.g_aNz.send(a)}catch(e){if(this.g_aND)return;this.g_aMg.g_aAF()?"o"===g||"r"===g?("string"==typeof a?(console.error("Error sending "+a.length+"-char string on '"+g+"' to '"+this.g_aNt+"', host kicking: ",e),console.log("String that failed to send from previous error was: "+a)):console.error("Error sending "+(a.length||a.byteLength)+"-byte binary on '"+g+"' to '"+this.g_aNt+"', host kicking: ",e),this.g_lL("network error")):(this.g_aNH++,10<=this.g_aNH&&("string"==typeof a?(console.error("Too many errors ("+this.g_aNH+") sending data on '"+g+"' to '"+this.g_aNt+"', kicking; last error was for sending "+a.length+"-char string: ",e),console.log("String that failed to send from previous error was: "+a)):console.error("Too many errors ("+this.g_aNH+") sending data on '"+g+"' to '"+this.g_aNt+"', kicking; last error was for sending "+(a.length||a.byteLength)+"-byte binary: ",e),this.g_lL("network error"))):console.error("Error sending data on '"+g+"': ",e)}}g_aOB(g,a){return this.g_aND?void 0:!a&&!this.g_aOA()&&this.g_aNu&&25e3<g-this.g_aNG?(console.warn("Timed out '"+this.g_aNt+"', could not establish connection after 25sec"),void this.g_lL("timeout")):!a&&this.g_aOA()&&2e4<g-this.g_aNF?(console.warn("Timed out '"+this.g_aNt+"', not heard from for 20sec"),void this.g_lL("timeout")):void(this.g_aNM=g,this.g_aNN=!0,this.g_aNO++,this.g_aOu("u","ping:"+this.g_aNO))}g_aOK(g){let a="pong:"+g.substr(5);this.g_aMg.g_aAF()&&(a+="/",a+=Math.round(performance.now()).toString()),this.g_aOu("u",a)}g_aOL(_){if(!this.g_aNN)return;const a=_.indexOf(":");if(-1<a){const g=parseFloat(_.substr(a+1));if(g!==this.g_aNO)return}else return void console.warn("Cannot parse off ping ID from pong");const t=performance.now();this.g_aNN=!1;const i=(t-this.g_aNM)/2;this.g_aNP.push(i),10<this.g_aNP.length&&this.g_aNP.shift(),n.push(...this.g_aNP),n.sort((g,e)=>g-e),this.g_aNR=n[n.length-1]-n[0];let e=0,o=n.length;4<=n.length&&6>=n.length?(++e,--o):6<n.length&&(e+=2,o-=2);let r=0;for(let a=e;a<o;++a)r+=n[a];if(this.g_aNQ=r/(o-e),n.length=0,!this.g_aMg.g_aAF()){const a=_.indexOf("/");if(-1<a){const g=parseFloat(_.substr(a+1));isFinite(g)?this.g_aMg.g_aOM(g,t,i,this.g_aNQ):console.warn("Invalid host time from pong response")}else console.warn("Cannot parse off host time from pong response")}}g_aOe(g,a){const _=this.g_aMg.g_aOG(),t=this.g_aMg.g_aOH(),n=this.g_aMg.g_aOI();if(!(0<_&&"u"===g&&Math.random()<_))if(0===t&&0===n)this.g_aON(g,a);else{let e=1;"u"!==g&&Math.random()<_&&(e=3),setTimeout(()=>this.g_aON(g,a),t*e+Math.random()*n*e)}}g_aON(g,e){if(this.g_aND)return;this.g_aNF=performance.now(),this.g_aMg.g_aOO();let a=0;if(e.data.length?a=e.data.length:e.data.byteLength&&(a=e.data.byteLength),this.g_aMg.g_aOP(a),"string"==typeof e.data){if(""===e.data.trim()||4>e.data.length)return;const g=e.data.substr(0,4);if("ping"===g)return void this.g_aOK(e.data);if("pong"===g)return void this.g_aOL(e.data);var _;try{_=JSON.parse(e.data)}catch(g){return this.g_aMg.g_aOf(this,g),this.g_aMg.g_aAF()?(console.error("Error parsing message as JSON for peer '"+this.g_Ro+"', host kicking: ",g),this.g_lL("data error")):console.error("Error parsing message as JSON for peer '"+this.g_Ro+"': ",g),void console.log("String that failed to parse from previous error: "+e.data)}if(!_)return;try{_.c&&"m"!==_.c?this.g_aOQ(_):this.g_aMg.g_aAr(this,_)}catch(g){this.g_aMg.g_aOf(this,g),this.g_aMg.g_aAF()?(console.error("Error handling message for peer '"+this.g_Ro+"', host kicking: ",g),this.g_lL("data error")):console.error("Error handling message for peer '"+this.g_Ro+"': ",g)}return}!this.g_aNE&&this.g_aMg.g_aAF()&&"u"===g&&(this.g_aNE=!0,this.g_aMg.g_aOR(this.g_Ro));try{this.g_aOS(e.data)}catch(g){return this.g_aMg.g_aOf(this,g),void(this.g_aMg.g_aAF()?(console.error("Error handling binary update for peer '"+this.g_Ro+"', host kicking: ",g),this.g_lL("data error")):console.error("Error handling binary update for peer '"+this.g_Ro+"': ",g))}}g_aOQ(g){let a,e;switch(g.c){case"disconnect":g.k&&this.g_aMg.g_aIY("peer-kicked"),e=!this.g_aMg.g_aAF()&&!this.g_aAF(),this.g_lL(g.r),e&&this.g_aMg.g_aBM();break;case"hi":this.g_aMg.g_aAF()||(this.g_aMg.g_aNU().g_aM_(g.hn),this.g_aMg.g_aNW().g_aM_(g.n),this.g_aMg.g_aOT(g.d),this.g_aMg.g_aOU(g.u),this.g_aMg.g_aOV(g.objs),this.g_aMg.g_aOW(g.cvs));break;case"j":this.g_aMg.g_aAF()||(a=new i(this.g_aMg,g.i,g.a),a.g_aM_(g.n),this.g_aMg.g_aAq(a));break;case"l":this.g_aMg.g_aAF()||(a=this.g_aMg.g_aOX(g.i),a&&(!a.g_aNV()&&this.g_aMg.g_aAs(a,g.r),a.g_lL(g.r)));break;default:console.error("Unknown control message from peer '"+this.g_Ro+"': "+g.c),this.g_aMg.g_aOf(this,"unknown control message '"+g.c+"'");}}g_aOS(g){this.g_aMg.g_aAF()?this.g_aOY(g):this.g_aOZ(g)}g_aOY(g){const _=new DataView(g);let t=0;const a=_.getUint32(t);if(t+=4,1664249200!==a)return void console.warn("Rejected packet with incorrect magic number (received '"+a+"', expected '"+1664249200+"'");let n=_.getFloat64(t);if(t+=8,n+=this.g_aNQ,!(3e3<=Math.abs(n-performance.now()))){_.getUint8(t),t+=1;const g=_.getUint8(t);t+=1;const i=[],o=this.g_aMg.g_aO_();for(let n=0;n<g;++n){if(n>=o.length){i.push(0);continue}const e=o[n];let a=0;switch(e.g_aLY()){case 0:a=_.getFloat64(t),t+=8;break;case 1:a=_.getFloat32(t),t+=4;break;case 2:a=e.g_aMd(_.getInt16(t)),t+=2;break;case 3:a=e.g_aMd(_.getUint8(t)),t+=1;break;default:a=_.getFloat32(t),t+=4;}i.push(a)}this.g_aO$(n,i)}}g_aO$(g,a){for(let e=0,_=this.g_aNL.length;e<_;++e){const _=this.g_aNL[e];if(_.timestamp===g)return;if(_.timestamp>g)return void this.g_aNL.splice(e,0,new g_aMH(g,a))}this.g_aNL.push(new g_aMH(g,a))}g_KM(g){if(0!==this.g_aNL.length){for(;2<this.g_aNL.length&&this.g_aNL[0]!==this.g_aMp&&this.g_aNL[0]!==this.g_aMq&&this.g_aNL[0]!==this.g_aMr;)this.g_aNL.shift();if(!(this.g_aMr&&this.g_aMr.timestamp>g&&this.g_aMq&&this.g_aMq.timestamp<g)){this.g_aMr=null;for(let a=0,e=this.g_aNL.length;a<e;++a){const e=this.g_aNL[a];if(e.timestamp<=g)(!this.g_aMq||e.timestamp>this.g_aMq.timestamp)&&(this.g_aMp=this.g_aMq,this.g_aMq=e);else{this.g_aMr=e;break}}}}}g_aOZ(g){const a=new DataView(g);let _=0;const t=a.getUint32(_);if(_+=4,1664249200!==t)return void console.warn("Rejected packet with incorrect magic number (received '"+t+"', expected '"+1664249200+"'");const n=a.getUint32(_);_+=4,0===n?this.g_aPa(a,_):1===n?this.g_aPb(a,_):console.warn("Ignoring packet with incorrect flags (received "+n+", expected 0 or 1")}g_aPa(_,a){const t=_.getFloat64(a);a+=8;const g=_.getUint16(a);a+=2;for(let n=0;n<g;++n){const n=_.getUint16(a);a+=2;const o=_.getUint8(a);a+=1;let r=null,s=0;const g=this.g_aMg.g_aPc(n);g?(r=g.g_aMj(),s=r.length,1===o&&g.g_aNa(!0)):console.warn("Don't know which object corresponds to NID "+n);const e=_.getUint16(a);a+=2;const i=_.getUint16(a);a+=2;for(let n=0;n<e;++n){const n=_.getUint16(a);if(a+=2,g){const o=[];let e=a;for(let a=0;a<s;++a){const g=r[a];let t=0;switch(g.g_aLY()){case 0:t=_.getFloat64(e),e+=8;break;case 1:t=_.getFloat32(e),e+=4;break;case 2:t=g.g_aMd(_.getInt16(e)),e+=2;break;case 3:t=g.g_aMd(_.getUint8(e)),e+=1;break;default:t=_.getFloat32(e),e+=4;}o.push(t)}g.g_aME(t,n,o)}a+=i}}}g_aPb(g,a){const _=g.getFloat64(a);a+=8;const t=g.getUint16(a);a+=2;for(let n=0;n<t;++n){const t=g.getUint16(a);a+=2;const n=this.g_aMg.g_aPc(t);n||console.warn("Don't know which object corresponds to NID "+g_aPd);const e=g.getUint16(a);a+=2;for(let t=0;t<e;++t){const e=g.getUint16(a);a+=2,n&&!n.g_aNb()&&(this.g_aMg.g_aAC(n,e,_),n.g_aNr(e))}}}g_lL(a,e){this.g_aND||(this.g_aND=!0,this.g_aOC(a),this.g_aOu("o",JSON.stringify({c:"disconnect",r:a,k:!!e})),g(this.g_aNv),g(this.g_aNx),g(this.g_aNz),g(this.g_aNu),this.g_aNv=null,this.g_aNx=null,this.g_aNz=null,this.g_aNu=null,this.g_aNw=!1,this.g_aNy=!1,this.g_aNA=!1,this.g_aMg.g_aPe(this))}g_aPf(g){return this.g_aMg.g_aPg(g)}g_aPh(g){const a=this.g_aMg.g_aPi(g);if(!a)return 0;const e=a.g_ED();if(0===this.g_aNL.length)return 0;const _=this.g_aNL[this.g_aNL.length-1].data;return 0>e||e>=_.length?0:_[e]}g_aPj(t){const n=t.g_ED();if(!this.g_aMr&&!this.g_aMq)return 0;if(this.g_aMr&&!this.g_aMq){const g=this.g_aMr.data;return 0>n||n>=g.length?0:g[n]}const o=this.g_aMg.g_aNg();let r,s,d,c,l;if(!this.g_aMr&&this.g_aMq)if(this.g_aMp){r=this.g_aMp.timestamp,s=this.g_aMp.data[n],d=this.g_aMq.timestamp,c=this.g_aMq.data[n];let g=o;return g>this.g_aMq.timestamp+250&&(g=this.g_aMq.timestamp+250),l=_(r,d,g),g_aMG.g_aMe(this.g_aMg.g_aO_()[n].g_aBu(),s,c,l,!0)}else{const g=this.g_aMq.data;return 0>n||n>=g.length?0:g[n]}return r=this.g_aMq.timestamp,s=this.g_aMq.data[n],d=this.g_aMr.timestamp,c=this.g_aMr.data[n],l=_(r,d,o),g_aMG.g_aMe(this.g_aMg.g_aO_()[n].g_aBu(),s,c,l,!1)}}self.g_aPk=i}{const _=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection||window.msRTCPeerConnection,t=window.RTCSessionDescription||window.webkitRTCSessionDescription||window.mozRTCSessionDescription||window.msRTCSessionDescription,n=window.RTCIceCandidate||window.webkitRTCIceCandidate||window.mozRTCIceCandidate||window.msRTCIceCandidate,a=window.RTCDataChannel||window.webkitRTCDataChannel||window.mozRTCDataChannel||window.msRTCDataChannel,i=[{urls:"stun:stun.l.google.com:19302"}];let e=!1;const o=[],g=class extends g_aIT{constructor(g){super(g,"multiplayer"),this.g_aPl=[],this.g_aPm=null,this.g_aPn=!1,this.g_aPo=!1,this.g_azt={g_aPp:0,version:0,name:"",operator:"",g_aPq:""},this.g_azy="",this.g_azz="",this.g_azD="",this.g_azE="",this.g_azF="",this.g_azJ=[],this.g_azK=new Map,this.g_aPr=0,this.g_aPs=new Set,this.g_aPt=null,this.g_aPu=null,this.g_aAb=80,this.g_aPv=30,this.g_aPw=30,this.g_aPx=0,this.g_aPy={g_aPz:0,g_aPA:0,g_aPB:0,g_aPC:0,g_aPD:0,g_aPE:0,g_aPF:0,g_aPG:0,g_aPH:0},this.g_aPI=new ArrayBuffer(262144),this.g_aPJ=new DataView(this.g_aPI),this.g_aPK=[],this.g_aPL=1,this.g_aPM=new Map,this.g_aPN=new Map,this.g_aPO=0,this.g_aPP=0,this.g_aPQ=0,this.g_aPR=[],this.g_aPS=0,this.g_aPT=0,this.g_aPU=this.g_aAb,this.g_aPV=this.g_aAb,this.g_aPW=[],this.g_aPX=new Map,this.g_aPY=!1,this.g_aPZ(i),setInterval(()=>this.g_aP_(),2e3),window.addEventListener("unload",()=>this.g_aP$("quit")),this.g_aJd("get-supported",()=>this.g_aQa()),this.g_aJd("add-ice-servers",g=>this.g_aPZ(g.list)),this.g_aJd("simulate-latency",g=>this.g_aQb(g.latency,g.pdv,g.loss)),this.g_aJd("set-bandwidth-profile",g=>this.g_aQc(g.updateRate,g.delay)),this.g_aJd("tick",g=>this.g_KM(g)),this.g_aJd("alert",g=>this.g_aQd(g)),this.g_aJd("signalling-connect",g=>this.g_aBG(g.url)),this.g_aJd("signalling-disconnect",()=>this.g_aBH()),this.g_aJd("signalling-login",g=>this.g_aBJ(g.alias)),this.g_aJd("signalling-join-room",g=>this.g_aQe(g.game,g.instance,g.room,g.maxClients)),this.g_aJd("signalling-auto-join-room",g=>this.g_aQf(g.game,g.instance,g.room,g.maxClients,g.lock)),this.g_aJd("signalling-leave-room",()=>this.g_aBM()),this.g_aJd("signalling-list-game-instances",g=>this.g_aBX(g.game)),this.g_aJd("signalling-list-rooms",g=>this.g_aBY(g.game,g.instance,g.which)),this.g_aJd("disconnect-room",()=>this.g_aBN(!0)),this.g_aJd("peer-send-message",g=>this.g_aQg(g)),this.g_aJd("host-broadcast",g=>this.g_aQh(g)),this.g_aJd("kick-peer",g=>this.g_aQi(g)),this.g_aJd("sync-object",g=>this.g_aQj(g)),this.g_aJd("sync-inst-var",g=>this.g_aQk(g)),this.g_aJd("associate-object",g=>this.g_aQl(g)),this.g_aJd("remove-object-id",g=>this.g_aNq(g.uid)),this.g_aJd("remove-net-insts",g=>this.g_aQm(g)),this.g_aJd("remove-object-nid",g=>this.g_aQn(g)),this.g_aJd("set-client-state",g=>this.g_aBU(g.tag,g.value)),this.g_aJd("add-client-input-value",g=>this.g_aBV(g.tag,g.precision,g.interp))}g_aQo(g){return g?"string"==typeof g?g:"string"==typeof g.message?g.message:"string"==typeof g.details?g.details:"string"==typeof g.data?g.data:"string"==typeof g.type?g.type:"unknown error":"unknown error"}g_aQp(){return this.g_aPn}g_aQq(){return this.g_aQp()&&this.g_aPo}g_aAG(){return this.g_aQq()&&this.g_azF}g_aAF(){return this.g_aAG()&&this.g_aPt&&this.g_aPu===this.g_aPt}g_aQr(){return this.g_aQq()?this.g_azy:""}g_aQs(){return this.g_aQq()?this.g_azz:""}g_aOj(){return this.g_aQq()?this.g_azD:""}g_aOk(){return this.g_aQq()?this.g_azE:""}g_aOl(){return this.g_aAG()?this.g_azF:""}g_aQt(){return this.g_aPu?this.g_aPu.g_LJ():""}g_aQu(){return this.g_aPu?this.g_aPu.g_aNT():""}g_aNU(){return this.g_aPu}g_aNW(){return this.g_aPt}g_aQb(g,a,e){var _=Math.max;this.g_aPO=_(g,0),this.g_aPP=_(a,0),this.g_aPQ=_(e,0)}g_aOG(){return this.g_aPQ}g_aOH(){return this.g_aPO}g_aOI(){return this.g_aPP}g_aQa(){return{isSupported:!!(_&&a)}}g_aBG(g){if(!(this.g_aPm||this.g_aPn)){try{this.g_aPm=new WebSocket(g,"c2multiplayer")}catch(g){return this.g_aPm=null,void this.g_aAh(g)}this.g_aPm.onopen=()=>-1===this.g_aPm.protocol.indexOf("c2multiplayer")?(this.g_aAh("server does not support 'c2multiplayer' protocol"),this.g_aPm.close(1002,"'c2multiplayer' protocol required"),this.g_aPm=null,void(this.g_aPn=!1)):void(this.g_aPn=!0),this.g_aPm.onclose=()=>{this.g_aAi(),this.g_aPn=!1,this.g_aPo=!1,this.g_aPm=null},this.g_aPm.onerror=g=>{console.error("Signalling server error: ",g),this.g_aAh(g)},this.g_aPm.onmessage=g=>{this.g_aQv(g)}}}g_aBH(){this.g_aPm&&this.g_aPn&&(this.g_aPm.close(),this.g_aPm=null,this.g_aPn=!1)}g_aQv(g){let a;try{a=JSON.parse(g.data)}catch(g){return void this.g_aAh(g)}switch(a.message){case"welcome":this.g_aQw(a);break;case"login-ok":this.g_aQx(a);break;case"join-ok":this.g_aQy(a);break;case"leave-ok":this.g_aQz(a);break;case"kicked":this.g_aQA(a);break;case"peer-joined":this.g_aQB(a);break;case"peer-quit":this.g_aQC(a);break;case"icecandidate":this.g_aQD(a);break;case"offer":this.g_aQE(a);break;case"answer":this.g_aQF(a);break;case"instance-list":this.g_aQG(a);break;case"room-list":this.g_aQH(a);break;case"error":this.g_aAh(a.details);break;default:this.g_aAh("received unknown signalling message");}}g_aQI(g){for(const a of this.g_aPl)if(a.urls===g.urls)return!0;return!1}g_aPZ(g){if(g)for(let a of g)"string"==typeof a&&(a={urls:a}),this.g_aQI(a)||(!a.hasOwnProperty("url")&&(a.url=a.urls),this.g_aPl.push(a))}g_aOh(){return this.g_aPl}g_aAh(g){this.g_aIY("signalling-error",{message:this.g_aQo(g)})}g_aAi(){this.g_aIY("signalling-close")}g_aQw(g){if(1>g.protocolrev||1<g.protocolrev)return this.g_aAh("signalling server protocol revision not supported"),void this.g_aBH();this.g_azy=g.clientid;const a=this.g_azt;a.g_aPp=g.protocolrev,a.version=g.version,a.name=g.name,a.operator=g.operator,a.g_aPq=g.motd,this.g_aPZ(g.ice_servers),this.g_aIY("signalling-welcome",{myid:this.g_azy,sigservinfo:{protocolrev:a.g_aPp,version:a.version,name:a.name,operator:a.operator,motd:a.g_aPq}})}g_aQx(g){this.g_azz=g.alias,this.g_aPo=!0,this.g_aIY("signalling-login-ok",{myalias:this.g_azz})}g_aMK(){return this.g_aPL++}g_aOm(){if(this.g_aAF()){do this.g_aPr++,65535<this.g_aPr&&(this.g_aPr=0);while(this.g_aPs.has(this.g_aPr));const g=this.g_aPr;return this.g_aPs.add(g),g}}g_aQJ(g){this.g_aAF()&&this.g_aPs.delete(g)}g_aQy(g){this.g_aP$("disconnect"),this.g_azD=g.game,this.g_azE=g.instance,this.g_azF=g.room,this.g_aPt=new g_aPk(this,this.g_azy,this.g_azz),g.host?(this.g_aPu=this.g_aPt,this.g_aPr=0,this.g_aPs.clear(),this.g_aPu.g_aM_(this.g_aOm())):(this.g_aPR.length=0,this.g_aPS=0,this.g_aPT=0,this.g_aAb=80,this.g_aPv=30,this.g_aPw=30,this.g_aPU=this.g_aAb,this.g_aPV=this.g_aAb,this.g_aPu=new g_aPk(this,g.hostid,g.hostalias),this.g_aPu.g_aOg()),this.g_aIY("signalling-join-ok",{isHost:!!g.host,hostId:this.g_aPu.g_LJ(),hostAlias:this.g_aPu.g_aNT(),game:this.g_azD,gameInstance:this.g_azE,room:this.g_azF})}g_aQz(){this.g_azF="",this.g_aIY("signalling-leave-ok")}g_aQA(){this.g_aBN(),this.g_azF="",this.g_aIY("signalling-kicked")}g_aQB(g){if(this.g_aPo&&this.g_azF&&this.g_aAF()){const a=this.g_azK.get(g.peerid);a&&a.g_lL("rejoin");const e=new g_aPk(this,g.peerid,g.peeralias);e.g_aOg()}}g_aQC(g){if(this.g_aPo&&this.g_azF&&this.g_aAF()){const a=this.g_azK.get(g.id);a&&a.g_lL(g.reason)}}g_aQD(g){if(this.g_aPo&&this.g_azF){const a=this.g_azK.get(g.from);a&&a.g_aOp(new n(g.icecandidate))}}g_aQE(g){if(!this.g_aPo||!this.g_azF||this.g_aAF()||!this.g_aPt||!this.g_aPu||!this.g_aPu.g_aOq())return;if(g.from!==this.g_aPu.g_LJ())return;const e=this.g_aPu.g_aOr();e.setRemoteDescription(new t(g.offer)).then(()=>{e.createAnswer().then(g=>{e.setLocalDescription(g),this.g_aOi({message:"answer",toclientid:this.g_aPu.g_LJ(),answer:g})}).catch(g=>{console.error("Peer error creating answer: ",g),this.g_aOf(this.g_aPt,"could not create answer to host offer")})}).catch(g=>{console.error("Peer error setting remote description: ",g),this.g_aOf(this.g_aPt,"could not set remote description")})}g_aQF(g){if(this.g_aPo&&this.g_azF&&this.g_aAF()){const a=this.g_azK.get(g.from);a&&a.g_aOr().setRemoteDescription(new t(g.answer)).catch(g=>{console.error("Host error setting remote description: ",g)})}}g_aQG(g){this.g_aIY("signalling-instance-list",{list:g.list})}g_aQH(g){this.g_aIY("signalling-room-list",{list:g.list})}g_aOi(g){this.g_aPm&&this.g_aPn&&this.g_aPm.send(JSON.stringify(g))}g_aBJ(g){this.g_aPo||this.g_aOi({message:"login",protocolrev:1,alias:g})}g_aQe(g,a,e,_){!this.g_aPo||this.g_azF||this.g_aOi({message:"join",game:g,instance:a,room:e,max_clients:_})}g_aQf(g,a,_,t,n){!this.g_aPo||this.g_azF||this.g_aOi({message:"auto-join",game:g,instance:a,room:_,max_clients:t,lock_when_full:n})}g_aBM(){this.g_aPo&&this.g_aOi({message:"leave"})}g_aOR(g){this.g_aPo&&this.g_aAF()&&this.g_aOi({message:"confirm-peer",id:g})}g_aBX(g){this.g_aPm&&this.g_aPn&&this.g_aOi({message:"list-instances",game:g})}g_aBY(g,a,e){this.g_aPm&&this.g_aPn&&this.g_aOi({message:"list-rooms",game:g,instance:a,which:e})}g_aBN(g){this.g_aPR.length=0,this.g_aPS=0,this.g_aPT=0,this.g_aP$("disconnect"),g&&this.g_aBM()}g_aNS(g){this.g_azJ.push(g),this.g_azK.set(g.g_LJ(),g),this.g_aIY("add-peer",{id:g.g_LJ(),alias:g.g_aNT()})}g_aPe(g){this.g_aIY("remove-peer",{id:g.g_LJ()}),this.g_aAF()&&this.g_aQJ(g.g_aMv());const a=this.g_azJ.indexOf(g);-1<a&&this.g_azJ.splice(a,1),this.g_azK.delete(g.g_LJ()),this.g_aPu===g&&(this.g_aPu=null,this.g_aP$("host quit")),this.g_aPt===g&&(this.g_aPt=null,this.g_azF="",this.g_aP$("disconnect"))}g_aP$(g){if(!e){for(e=!0;this.g_azJ.length;)this.g_azJ[0].g_lL(g);e=!1}}g_aOX(g){return this.g_azK.get(g)||null}g_aQK(g){const a=this.g_azK.get(g);return a?a.g_aNT():""}g_aQL(g){for(const a of this.g_azJ)if(a.g_aMv()===g)return a;return null}g_aQh(g){const a=g.fromId,_=g.tag,t=g.message,n=g.mode,e=this.g_aOX(a);this.g_aOt(n,JSON.stringify({c:"m",t:_,f:a,m:t}),e)}g_aOt(g,a,_){if(this.g_aAF()){const t=this.g_azJ.slice(0);for(const n of t)n&&n!==this.g_aPt&&n!==_&&n.g_aOu(g,a)}}g_aP_(){const g=performance.now();if(this.g_aAF()){o.push(...this.g_azJ);for(const a of o)a&&a!==this.g_aPt&&a.g_aOB(g,!1);o.length=0}else this.g_aPu&&this.g_aPu.g_aOB(g,!1)}g_aMY(g){this.g_aPK.push(g),this.g_aPN.set(g.g_aMZ(),g),this.g_aPM.set(g.g_aMv(),g)}g_aOx(){const g={};for(const[a,e]of this.g_aPM.entries())g[e.g_aNc()]={nid:a,nvs:e.g_aNk()};return g}g_aOV(g){this.g_aPM.clear();for(const a of this.g_aPK)if(g.hasOwnProperty(a.g_aNc().toString())){const e=g[a.g_aNc().toString()];a.g_aM_(e.nid),this.g_aPM.set(e.nid,a),a.g_aNl(e.nvs)}else console.warn("Could not map object SID '"+a.g_aNc()+"' - host did not send NID for it"),a.g_aM_(-1)}g_aPc(g){return this.g_aPM.get(g)||null}g_KM(g){if(!this.g_aAG())return null;const a=g.dt,_=performance.now(),t=this.g_aAF()?this.g_aPv:this.g_aPw;_-this.g_aPx>=1e3/t-5&&(this.g_aQM(_),this.g_aPx=_);const n=this.g_aPy;1e3<=_-n.g_aPz&&(n.g_aPA=n.g_aPB,n.g_aPC=n.g_aPD,n.g_aPE=n.g_aPF,n.g_aPG=n.g_aPH,n.g_aPB=0,n.g_aPD=0,n.g_aPF=0,n.g_aPH=0,n.g_aPz+=1e3,500<_-n.g_aPz&&(n.g_aPz=_),this.g_aIY("stats",{stats:{outboundPerSec:n.g_aPA,outboundBandwidthPerSec:n.g_aPC,inboundPerSec:n.g_aPE,inboundBandwidthPerSec:n.g_aPG}})),this.g_aAF()||(this.g_aPT<this.g_aPS?(this.g_aPT+=10*a,this.g_aPT>this.g_aPS&&(this.g_aPT=this.g_aPS)):this.g_aPT>this.g_aPS&&(this.g_aPT-=10*a,this.g_aPT<this.g_aPS&&(this.g_aPT=this.g_aPS)),this.g_aPV<this.g_aPU?(this.g_aPV+=30*a,this.g_aPV>this.g_aPU&&(this.g_aPV=this.g_aPU)):this.g_aPV>this.g_aPU&&(this.g_aPV-=30*a,this.g_aPV<this.g_aPU&&(this.g_aPV=this.g_aPU)));const e=this.g_aNg();for(const a of this.g_azJ)a.g_KM(e);for(const a of this.g_aPK)a.g_KM();return{simulationTime:this.g_aNg(),hostInputArrivalTime:this.g_aQN(),clientDelay:this.g_aAb,peerData:this.g_aQO(),roData:this.g_aQP(),isReadyForInput:this.g_aBD()}}g_aQO(){const g={};for(const e of this.g_azJ){const _={};for(const g of this.g_aPW)_[g.g_aLZ()]=e.g_aPj(g);g[e.g_LJ()]={nid:e.g_aMv(),latency:e.g_aOa(),pdv:e.g_aOb(),clientState:_}}return g}g_aQP(){const g={};for(const a of this.g_aPK)g[a.g_aMZ()]=a.g_aLX();return g}async g_aQM(g){this.g_aAF()?(await this.g_aQQ(g),this.g_aQR(g)):await this.g_aQS(g)}async g_aAx(){const g=await this.g_aI_("before-client-update");for(const a of g.clientStateUpdates)this.g_aBU(a.tag,a.value)}async g_aQS(_){if(this.g_aBD()&&(await this.g_aAx()),!this.g_aPt||!this.g_aPY)return;const t=this.g_aPJ;let n=0;const i=this.g_aPW,o=this.g_aPt.g_aNX(),a=_-this.g_aPt.g_aNZ(),e=_-this.g_aPt.g_aN$();let g=!1;if(g=!!(100>a)||(1e3>a?95<=e:495<=e),!!g){t.setUint32(n,1664249200),n+=4,t.setFloat64(n,_+this.g_aPT),n+=8,t.setUint8(n,0),n+=1,t.setUint8(n,i.length),n+=1;for(let e=0,a=i.length;e<a;++e){const a=i[e];let _=0;e<o.length&&(_=a.g_aMb(o[e])),n=a.g_aMc(t,n,_)}this.g_aPt.g_aN_(_),this.g_aPu.g_aOu("u",new Uint8Array(this.g_aPI,0,n))}}async g_aQQ(g){const a=this.g_aPJ;let _=0,t=0;const n=await this.g_aI_("get-object-info",{ros:this.g_aPK.map(g=>g.g_aNs())});for(const a of this.g_aPK){const e=a.g_aMZ();if(!n.hasOwnProperty(e))continue;const _=n[e];a.g_aMz(_,g),0<a.g_aM$()&&t++}if(0!=t){a.setUint32(_,1664249200),_+=4,a.setUint32(_,0),_+=4,a.setFloat64(_,g),_+=8,a.setUint16(_,t),_+=2;for(const e of this.g_aPK)0<e.g_aM$()&&(_=e.g_aMD(a,_,g));this.g_aOt("u",new Uint8Array(this.g_aPI,0,_),null)}}g_aQR(g){const e=this.g_aPJ;let _=0,a=0;for(const e of this.g_aPK)e.g_aNd().length&&a++;if(0!=a){e.setUint32(_,1664249200),_+=4,e.setUint32(_,1),_+=4,e.setFloat64(_,g),_+=8,e.setUint16(_,a),_+=2;for(const g of this.g_aPK){const t=g.g_aNd();if(t.length){e.setUint16(_,g.g_aMv()),_+=2,e.setUint16(_,t.length),_+=2;for(const g of t)e.setUint16(_,g),_+=2;t.length=0}}this.g_aOt("r",new Uint8Array(this.g_aPI,0,_),null)}}g_aOM(g,a,_,t){if(this.g_aAF())return;this.g_aPU=t+this.g_aAb;var n=g+_-a;0===this.g_aPR.length&&(this.g_aPT=n,this.g_aPV=this.g_aPU),this.g_aPR.push(n),30<this.g_aPR.length&&this.g_aPR.shift(),o.push(...this.g_aPR),o.sort((g,e)=>g-e);let i=0,r=o.length;4<=o.length&&6>=o.length?(++i,--r):6<o.length&&19>=o.length?(i+=2,r-=2):19<o.length&&(i+=5,r-=5);let s=0;for(let n=i;n<r;++n)s+=o[n];this.g_aPS=s/(r-i),o.length=0}g_aNg(){return this.g_aAF()?performance.now()-this.g_aAb:performance.now()+this.g_aPT-this.g_aPV}g_aQT(){return this.g_aAF()?performance.now():performance.now()+this.g_aPT}g_aQN(){return this.g_aAF()?performance.now():performance.now()+this.g_aPT+this.g_aPV}g_aBU(g,e){if(!this.g_aAF()&&this.g_aPt&&this.g_aPY){const _=this.g_aPX.get(g);if(_){const g=_.g_ED(),a=this.g_aPt.g_aNX();a.length<g+1&&(a.length=g+1),a[g]!==e&&(a[g]=e,this.g_aPt.g_aNY(performance.now()))}}}g_aBV(g,a,e){const _=new g_aMG(this.g_aPW.length,e,a,g,null);this.g_aPX.set(g,_),this.g_aPW.push(_)}g_aO_(){return this.g_aPW}g_aOy(){const g=[];for(const a of this.g_aPW)g.push({tag:a.g_aLZ(),precision:a.g_aLY(),interp:a.g_aBu()});return g}g_aOW(g){this.g_aPX.clear(),this.g_aPW.length=0;for(let a=0,e=g.length;a<e;++a){const e=g[a],_=new g_aMG(a,e.interp,e.precision,e.tag,null);this.g_aPX.set(_.g_aLZ(),_),this.g_aPW.push(_)}this.g_aPY=!0}g_aNq(g){for(const a of this.g_aPK)a.g_aNq(g)}g_aOz(){return this.g_azJ}g_aQU(){return this.g_aAG()?this.g_azJ.length:0}g_aQV(g){return g=Math.floor(g),!this.g_aAG()||0>g||g>=this.g_azJ.length?null:this.g_azJ[g]}g_aBD(){return!!this.g_aAG()&&(!!this.g_aAF()||0!==this.g_aPS)}g_aQc(g,a){this.g_aAG()||(this.g_aPv=g,this.g_aPw=g,this.g_aAb=a)}g_aAq(g){this.g_aIY("peer-open",{id:g.g_LJ(),alias:g.g_aNT()})}g_aQg(g){const a=g.id,_=g.tag,t=g.message,n=g.mode,e=this.g_aOX(a);e&&e.g_aOu(n,JSON.stringify({c:"m",t:_,m:t}))}g_aAs(g,a){this.g_aIY("peer-close",{id:g.g_LJ(),alias:g.g_aNT(),reason:a||"unknown"})}g_aOf(g,a){console.error(`[Multiplayer] Peer '${g.g_aNT()}' (${g.g_LJ()}) error: `,a)}g_aAr(g,a){const e=a.f||g.g_LJ();this.g_aIY("peer-message",{tag:a.t,fromId:e,fromAlias:this.g_aQK(e),content:a.m})}g_aAC(g,a,e){this.g_aIY("instance-destroyed",{roId:g.g_aMZ(),nid:a,timestamp:e})}g_aQi(g){if(this.g_aAF()){const a=g.id,e=g.reason,_=this.g_aOX(a);_&&_.g_lL(e,!0)}}g_aOE(){this.g_aPy.g_aPB++}g_aOF(g){this.g_aPy.g_aPD+=g}g_aOO(){this.g_aPy.g_aPF++}g_aOP(g){this.g_aPy.g_aPH+=g}g_aOT(g){this.g_aAb=g}g_aOv(){return this.g_aAb}g_aOU(g){this.g_aPw=g}g_aOw(){return this.g_aPw}g_aQj(g){const _=g.data,t=g.precision,n=g.bandwidth;for(const i of g.objectClasses){const g=new g_aMI(this,i.roId,i.sid,n);1===_?(g.g_aNe(1,t,"x"),g.g_aNe(1,t,"y")):2===_?g.g_aNe(2,t,"a"):3===_&&(g.g_aNe(1,t,"x"),g.g_aNe(1,t,"y"),g.g_aNe(2,t,"a"))}}g_aQd(g){alert(g.message)}g_aQk(g){const _=g.precision,t=g.interp,n=g.cvt;for(const i of g.syncData){const g=this.g_aPN.get(i.roId);g.g_aNe(t,_,"iv",i.varIndex,n)}}g_aQl(g){const a=g.roId,_=g.peerId,t=g.instUid,n=this.g_aPN.get(a),e=this.g_azK.get(_);n&&e&&(!this.g_aAF()||n.g_aNp(t,e.g_aMv()))}g_aQm(g){for(const[e,_]of Object.entries(g)){const g=this.g_aPN.get(parseInt(e,10));if(g)for(const a of _)g.g_aNr(a)}}g_aQn(g){const a=g.roId,e=g.nid,_=this.g_aPN.get(a);_&&_.g_aNr(e)}};g_aJC.g_aKx(g)}{const g=class extends g_aIT{constructor(g){super(g,"platform-info"),this.g_aJd("get-initial-state",()=>this.g_aQW()),window.addEventListener("resize",()=>this.g_aQX())}g_aQW(){return{screenWidth:screen.width,screenHeight:screen.height,windowOuterWidth:window.outerWidth,windowOuterHeight:window.outerHeight,safeAreaInset:this.g_aQY()}}g_aQY(){const g=document.body,a=g.style;a.setProperty("--temp-sai-top","env(safe-area-inset-top)"),a.setProperty("--temp-sai-right","env(safe-area-inset-right)"),a.setProperty("--temp-sai-bottom","env(safe-area-inset-bottom)"),a.setProperty("--temp-sai-left","env(safe-area-inset-left)");const e=getComputedStyle(g),_=[e.getPropertyValue("--temp-sai-top"),e.getPropertyValue("--temp-sai-right"),e.getPropertyValue("--temp-sai-bottom"),e.getPropertyValue("--temp-sai-left")].map(g=>{const a=parseInt(g,10);return isFinite(a)?a:0});return a.removeProperty("--temp-sai-top"),a.removeProperty("--temp-sai-right"),a.removeProperty("--temp-sai-bottom"),a.removeProperty("--temp-sai-left"),_}g_aQX(){this.g_aIY("window-resize",{windowOuterWidth:window.outerWidth,windowOuterHeight:window.outerHeight,safeAreaInset:this.g_aQY()})}};g_aJC.g_aKx(g)}{function g(g,e){return g.length===e.length&&(g===e||g.toLowerCase()===e.toLowerCase())}const a=class extends g_aIT{constructor(g){super(g,"audio"),this.g_aQZ=null,this.g_aQ_=null,this.g_aQ$=!1,this.g_aRa=()=>this.g_aRb(),this.g_aRc=[],this.g_aRd=[],this.g_aRe=null,this.g_aRf="",this.g_aRg=-1,this.g_aRh=new Map,this.g_aGi=1,this.g_aGj=!1,this.g_aFX=0,this.g_ajU=1,this.g_aqn=0,this.g_aF_="HRTF",this.g_aF$="inverse",this.g_aRi=600,this.g_aGe=1e4,this.g_aGf=1,this.g_aRj=!1,this.g_aRk=!1,this.g_aRl=this.g_aqU.g_Cf("audio/webm; codecs=opus"),this.g_aRm=new Map,this.g_aRn=new Set,this.g_aRo=!1,this.g_aRp="",this.g_aRq=null,self.C3Audio_OnMicrophoneStream=(g,a)=>this.g_aRr(g,a),this.g_aRs=null,self.C3Audio_GetOutputStream=()=>this.g_aRt(),self.C3Audio_DOMInterface=this,this.g_aJf([["create-audio-context",g=>this.g_aRu(g)],["play",g=>this.g_aRv(g)],["stop",g=>this.g_aRw(g)],["stop-all",()=>this.g_aRx()],["set-paused",g=>this.g_aRy(g)],["set-volume",g=>this.g_aRz(g)],["fade-volume",g=>this.g_aRA(g)],["set-master-volume",g=>this.g_aRB(g)],["set-muted",g=>this.g_aRC(g)],["set-silent",g=>this.g_aRD(g)],["set-looping",g=>this.g_aRE(g)],["set-playback-rate",g=>this.g_aRF(g)],["seek",g=>this.g_aRG(g)],["preload",g=>this.g_aRH(g)],["unload",g=>this.g_Hs(g)],["unload-all",()=>this.g_aRI()],["set-suspended",g=>this.g_aRJ(g)],["add-effect",g=>this.g_aRK(g)],["set-effect-param",g=>this.g_aRL(g)],["remove-effects",g=>this.g_aRM(g)],["tick",g=>this.g_JK(g)],["load-state",g=>this.g_aLP(g)]])}async g_aRu(g){g.isiOSCordova&&(this.g_aRj=!0),this.g_aFX=g.timeScaleMode,this.g_aF_=["equalpower","HRTF","soundfield"][g.panningModel],this.g_aF$=["linear","inverse","exponential"][g.distanceModel],this.g_aRi=g.refDistance,this.g_aGe=g.maxDistance,this.g_aGf=g.rolloffFactor;const a={latencyHint:g.latencyHint};if("undefined"!=typeof AudioContext)this.g_aQZ=new AudioContext(a);else if("undefined"!=typeof webkitAudioContext)this.g_aQZ=new webkitAudioContext(a);else throw new Error("Web Audio API not supported");this.g_aQ_=this.g_aQZ.createGain(),this.g_aQ_.connect(this.g_aQZ.destination);const e=g.listenerPos;this.g_aQZ.listener.setPosition(e[0],e[1],e[2]),this.g_aQZ.listener.setOrientation(0,0,1,0,-1,0),window.addEventListener("pointerup",this.g_aRa,!0),window.addEventListener("touchend",this.g_aRa,!0),window.addEventListener("click",this.g_aRa,!0),window.addEventListener("keydown",this.g_aRa,!0),self.C3_GetAudioContextCurrentTime=()=>this.g_aRN();try{await Promise.all(g.preloadList.map(g=>this.g_aRO(g.originalUrl,g.url,g.type,!1)))}catch(g){console.error("[Construct 3] Preloading sounds failed: ",g)}return{sampleRate:this.g_aQZ.sampleRate}}g_aRb(){if(!this.g_aQ$){const g=this.g_aQZ;"suspended"===g.state&&g.resume&&g.resume();const a=g.createBuffer(1,220,22050),e=g.createBufferSource();e.buffer=a,e.connect(g.destination),e.start(0),"running"===g.state&&(this.g_aQ$=!0,window.removeEventListener("pointerup",this.g_aRa,!0),window.removeEventListener("touchend",this.g_aRa,!0),window.removeEventListener("click",this.g_aRa,!0),window.removeEventListener("keydown",this.g_aRa,!0),this.g_aRa=null)}}g_aFS(){return this.g_aQZ}g_aRN(){return this.g_aQZ.currentTime}g_aFU(){return this.g_aQ_}g_aRP(g){const a=this.g_aRm.get(g.toLowerCase());return a?a[0].g_aRQ():this.g_aFU()}g_aRR(g,e){g=g.toLowerCase();let _=this.g_aRm.get(g);_||(_=[],this.g_aRm.set(g,_)),e.g_alA(_.length),e.g_aRS(g),_.push(e),this.g_aRT(g)}g_aRT(g){let a=this.g_aFU();const e=this.g_aRm.get(g);if(e&&e.length){a=e[0].g_aRQ();for(let g=0,a=e.length;g<a;++g){const _=e[g];g+1===a?_.g_aRU(this.g_aFU()):_.g_aRU(e[g+1].g_aRQ())}}for(const e of this.g_aRV(g))e.g_aRW(a);this.g_aRq&&this.g_aRp===g&&(this.g_aRq.disconnect(),this.g_aRq.connect(a))}g_aRX(){return this.g_aGi}g_aGL(){return this.g_aGj}g_aRY(){return this.g_aFX}g_KK(){return this.g_ajU}g_Gb(){return this.g_aqn}g_aRZ(){return this.g_aRj}g_aR_(){return this.g_aRl}g_aR$(){this.g_aRk=!0}g_aSa(){return this.g_aF_}g_aSb(){return this.g_aF$}g_aSc(){return this.g_aRi}g_aSd(){return this.g_aGe}g_aSe(){return this.g_aGf}g_aSf(g,a){return a?this.g_aqU.g_afT(g).then(g=>{const a=this.g_aQZ.createBuffer(1,g.length,48e3),e=a.getChannelData(0);return e.set(g),a}):new Promise((a,e)=>{this.g_aQZ.decodeAudioData(g,a,e)})}g_aKz(g){this.g_aqU.g_aKz(g)}g_aKA(g){this.g_aqU.g_aKA(g)}g_aSg(a){let g=0;for(let _=0,e=this.g_aRd.length;_<e;++_){const t=this.g_aRd[_];this.g_aRd[g]=t,t.g_aSh()===a?t.g_ek():++g}this.g_aRd.length=g}g_aSi(){let g=0;for(let a=0,e=this.g_aRc.length;a<e;++a){const e=this.g_aRc[a];this.g_aRc[g]=e,e.g_aSj()?e.g_ek():++g}this.g_aRc.length=g}*g_aRV(a){if(a)for(const e of this.g_aRd)g(e.g_aLZ(),a)&&(yield e);else this.g_aRe&&!this.g_aRe.g_aSk()&&(yield this.g_aRe)}async g_aRO(g,a,_,t,n){for(const e of this.g_aRc)if(e.g_aSl()===a)return await e.g_BW(),e;if(n)return null;t&&(this.g_aRj||this.g_aRk)&&this.g_aSi();const e=g_aSm.g_qS(this,g,a,_,t);return this.g_aRc.push(e),await e.g_BW(),e}async g_aSn(_,a,t,n,i){for(const g of this.g_aRd)if(g.g_aSl()===a&&(g.g_aSo()||i))return g.g_aSp(n),g;const e=await this.g_aRO(_,a,t,i),o=e.g_agg(n);return this.g_aRd.push(o),o}g_aSq(g){let a=this.g_aRh.get(g);if(!a){let e=null;const _=new Promise(g=>e=g);a={g_aSr:0,promise:_,resolve:e},this.g_aRh.set(g,a)}a.g_aSr++}g_aSs(g){const a=this.g_aRh.get(g);if(!a)throw new Error("expected pending tag");a.g_aSr--,0===a.g_aSr&&(a.resolve(),this.g_aRh.delete(g))}g_aSt(g){g||(g=this.g_aRf);const e=this.g_aRh.get(g);return e?e.promise:Promise.resolve()}g_aSu(){if(0<this.g_aRn.size)return void this.g_adZ();for(const g of this.g_aRd)if(g.g_XR())return void this.g_adZ()}g_KM(){for(const a of this.g_aRn)a.g_KM();const g=this.g_aRN();for(const a of this.g_aRd)a.g_KM(g);const a=this.g_aRd.filter(a=>a.g_XR()).map(a=>a.g_aSv());this.g_aIY("state",{tickCount:this.g_aRg,audioInstances:a,analysers:[...this.g_aRn].map(a=>a.g_aSw())}),0===a.length&&0===this.g_aRn.size&&this.g_adK()}g_aSx(g,a){this.g_aIY("trigger",{type:g,tag:a})}async g_aRv(_){const a=_.originalUrl,t=_.url,n=_.type,o=_.isMusic,e=_.tag,r=_.isLooping,g=_.vol,s=_.pos,i=_.panning;let d=_.off;if(0<d&&!_.trueClock)if(this.g_aQZ.getOutputTimestamp){const g=this.g_aQZ.getOutputTimestamp();d=d-g.performanceTime/1e3+g.contextTime}else d=d-performance.now()/1e3+this.g_aQZ.currentTime;this.g_aRf=e,this.g_aSq(e);try{this.g_aRe=await this.g_aSn(a,t,n,e,o),i?(this.g_aRe.g_aSy(!0),this.g_aRe.g_aSz(i.x,i.y,i.angle,i.innerAngle,i.outerAngle,i.outerGain),i.hasOwnProperty("uid")&&this.g_aRe.g_aSA(i.uid)):this.g_aRe.g_aSy(!1),this.g_aRe.g_MJ(r,g,s,d)}catch(g){return void console.error("[Construct 3] Audio: error starting playback: ",g)}finally{this.g_aSs(e)}this.g_adZ()}g_aRw(g){const a=g.tag;for(const e of this.g_aRV(a))e.g_JV()}g_aRx(){for(const g of this.g_aRd)g.g_JV()}g_aRy(g){const a=g.tag,e=g.paused;for(const _ of this.g_aRV(a))e?_.g_aSB():_.g_MI();this.g_aSu()}g_aRz(g){const a=g.tag,e=g.vol;for(const _ of this.g_aRV(a))_.g_aGV(e)}async g_aRA(g){const a=g.tag,_=g.vol,t=g.duration,n=g.stopOnEnd;await this.g_aSt(a);for(const e of this.g_aRV(a))e.g_aGW(_,t,n);this.g_aSu()}g_aRB(g){this.g_aGi=g.vol;for(const a of this.g_aRd)a.g_aSC()}g_aRC(g){const a=g.tag,e=g.isMuted;for(const _ of this.g_aRV(a))_.g_aGU(e)}g_aRD(g){this.g_aGj=g.isSilent,this.g_aqU.g_aHa(this.g_aGj);for(const a of this.g_aRd)a.g_aSD()}g_aRE(g){const a=g.tag,e=g.isLooping;for(const _ of this.g_aRV(a))_.g_aGT(e)}async g_aRF(g){const a=g.tag,e=g.rate;await this.g_aSt(a);for(const _ of this.g_aRV(a))_.g_LY(e)}async g_aRG(g){const a=g.tag,e=g.pos;await this.g_aSt(a);for(const _ of this.g_aRV(a))_.g_aG$(e)}async g_aRH(g){const a=g.originalUrl,_=g.url,t=g.type,n=g.isMusic;try{await this.g_aSn(a,_,t,"",n)}catch(g){console.error("[Construct 3] Audio: error preloading: ",g)}}async g_Hs(g){const a=g.url,_=g.type,t=g.isMusic,n=await this.g_aRO("",a,_,t,!0);if(n){n.g_ek();const g=this.g_aRc.indexOf(n);-1!==g&&this.g_aRc.splice(g,1)}}g_aRI(){for(const g of this.g_aRc)g.g_ek();this.g_aRc.length=0}g_aRJ(g){const a=g.isSuspended;!a&&this.g_aQZ.resume&&this.g_aQZ.resume();for(const e of this.g_aRd)e.g_arJ(a);a&&this.g_aQZ.suspend&&this.g_aQZ.suspend()}g_JK(g){if(this.g_ajU=g.timeScale,this.g_aqn=g.gameTime,this.g_aRg=g.tickCount,0!==this.g_aFX)for(const g of this.g_aRd)g.g_aSE();const a=g.listenerPos;a&&this.g_aQZ.listener.setPosition(a[0],a[1],a[2]);for(const e of g.instPans){const g=e.uid;for(const a of this.g_aRd)a.g_D$()===g&&a.g_aSF(e.x,e.y,e.angle)}}async g_aRK(g){const a=g.type,_=g.tag,t=g.params;let n;if("filter"===a)n=new g_aSG(this,...t);else if("delay"===a)n=new g_aSH(this,...t);else if("convolution"===a){let a=null;try{a=await this.g_aRO(g.bufferOriginalUrl,g.bufferUrl,g.bufferType,!1)}catch(g){return void console.log("[Construct 3] Audio: error loading convolution: ",g)}n=new g_aSI(this,a.g_aSJ(),...t),n.g_aSK(g.bufferOriginalUrl,g.bufferUrl,g.bufferType)}else if("flanger"===a)n=new g_aSL(this,...t);else if("phaser"===a)n=new g_aSM(this,...t);else if("gain"===a)n=new g_aSN(this,...t);else if("tremolo"===a)n=new g_aSO(this,...t);else if("ringmod"===a)n=new g_aSP(this,...t);else if("distortion"===a)n=new g_aSQ(this,...t);else if("compressor"===a)n=new g_aSR(this,...t);else if("analyser"===a)n=new g_aSS(this,...t);else throw new Error("invalid effect type");this.g_aRR(_,n),this.g_aST()}g_aRL(_){const a=_.tag,t=_.index,n=_.param,i=_.value,e=_.ramp,o=_.time,g=this.g_aRm.get(a);!g||0>t||t>=g.length||(g[t].g_aSU(n,i,e,o),this.g_aST())}g_aRM(g){const a=g.tag.toLowerCase(),e=this.g_aRm.get(a);if(e&&e.length){for(const g of e)g.g_ek();this.g_aRm.delete(a),this.g_aRT(a)}}g_aSV(g){this.g_aRn.add(g),this.g_aSu()}g_aSW(g){this.g_aRn.delete(g)}g_aST(){this.g_aRo||(this.g_aRo=!0,Promise.resolve().then(()=>this.g_aSX()))}g_aSX(){const g={};for(const[a,e]of this.g_aRm)g[a]=e.map(g=>g.g_aSv());this.g_aIY("fxstate",{fxstate:g}),this.g_aRo=!1}async g_aLP(g){const e=g.saveLoadMode;if(3!==e)for(const g of this.g_aRd)g.g_aSj()&&1===e||!g.g_aSj()&&2===e||g.g_JV();for(const e of this.g_aRm.values())for(const g of e)g.g_ek();this.g_aRm.clear(),this.g_ajU=g.timeScale,this.g_aqn=g.gameTime;const a=g.listenerPos;this.g_aQZ.listener.setPosition(a[0],a[1],a[2]),this.g_aGj=g.isSilent,this.g_aqU.g_aHa(this.g_aGj),this.g_aGi=g.masterVolume;const _=[];for(const a of Object.values(g.effects))_.push(Promise.all(a.map(g=>this.g_aRK(g))));await Promise.all(_),await Promise.all(g.playing.map(g=>this.g_aSY(g,e))),this.g_aSu()}async g_aSY(_,a){if(3===a)return;const t=_.bufferOriginalUrl,n=_.bufferUrl,o=_.bufferType,e=_.isMusic,r=_.tag,g=_.isLooping,s=_.volume,i=_.playbackTime;if(e&&1===a)return;if(!e&&2===a)return;let d=null;try{d=await this.g_aSn(t,n,o,r,e)}catch(g){return void console.error("[Construct 3] Audio: error loading audio state: ",g)}d.g_aSZ(_.pan),d.g_MJ(g,s,i,0),_.isPlaying||d.g_aSB(),d.g_aS_(_)}g_aRr(g,a){this.g_aRq&&this.g_aRq.disconnect(),this.g_aRp=a.toLowerCase(),this.g_aRq=this.g_aQZ.createMediaStreamSource(g),this.g_aRq.connect(this.g_aRP(this.g_aRp))}g_aRt(){return this.g_aRs||(this.g_aRs=this.g_aQZ.createMediaStreamDestination(),this.g_aQ_.connect(this.g_aRs)),this.g_aRs.stream}};g_aJC.g_aKx(a)}"use strict",self.g_aSm=class{constructor(g,a,_,t,n){this.g_aS$=g,this.g_aTa=a,this.g_Cv=_,this.g_kI=t,this.g_aTb=n,this.g_aTc="",this.g_aTd="not-loaded",this.g_CA=null}g_ek(){this.g_aTd="not-loaded",this.g_aS$=null,this.g_CA=null}static g_qS(g,a,_,t,n){const e="audio/webm; codecs=opus"===t&&!g.g_aR_();return n&&e&&g.g_aR$(),!n||g.g_aRZ()||e?new g_aTe(g,a,_,t,n,e):new g_aTf(g,a,_,t,n)}g_agg(g){return"html5"===this.g_aTc?new g_aTg(this.g_aS$,this,g):new g_aTh(this.g_aS$,this,g)}g_Hm(){}g_BW(){return this.g_CA||(this.g_CA=this.g_Hm()),this.g_CA}g_CB(){}g_aTi(){}g_aTj(){return"failed"===this.g_aTd}g_aFS(){return this.g_aS$.g_aFS()}g_aTk(){return this.g_aTc}g_aTl(){return this.g_aTa}g_aSl(){return this.g_Cv}g_aTm(){return this.g_kI}g_aSj(){return this.g_aTb}g_ahQ(){}},"use strict",self.g_aTf=class extends g_aSm{constructor(g,a,_,t,n){super(g,a,_,t,n),this.g_aTc="html5",this.g_aTn=new Audio,this.g_aTn.crossOrigin="anonymous",this.g_aTn.autoplay=!1,this.g_aTn.preload="auto",this.g_aTo=null,this.g_aTp=null,this.g_aTq=!1,this.g_aTn.addEventListener("canplaythrough",()=>this.g_aTq=!0),this.g_aTr=this.g_aFS().createGain(),this.g_aTs=null,this.g_aTn.addEventListener("canplay",()=>{this.g_aTo&&(this.g_aTd="loaded",this.g_aTo(),this.g_aTo=null,this.g_aTp=null),this.g_aTs||!this.g_aTn||(this.g_aTs=this.g_aFS().createMediaElementSource(this.g_aTn),this.g_aTs.connect(this.g_aTr))}),this.onended=null,this.g_aTn.addEventListener("ended",()=>{this.onended&&this.onended()}),this.g_aTn.addEventListener("error",g=>this.g_aTt(g))}g_ek(){this.g_aS$.g_aSg(this),this.g_aTr.disconnect(),this.g_aTr=null,this.g_aTs.disconnect(),this.g_aTs=null,this.g_aTn&&!this.g_aTn.paused&&this.g_aTn.pause(),this.onended=null,this.g_aTn=null,super.g_ek()}g_Hm(){return this.g_aTd="loading",new Promise((g,a)=>{this.g_aTo=g,this.g_aTp=a,this.g_aTn.src=this.g_Cv})}g_aTt(g){console.error(`[Construct 3] Audio '${this.g_Cv}' error: `,g),this.g_aTp&&(this.g_aTd="failed",this.g_aTp(g),this.g_aTo=null,this.g_aTp=null)}g_CB(){const g=4<=this.g_aTn.readyState;return g&&(this.g_aTq=!0),g||this.g_aTq}g_aTi(){return this.g_CB()}g_aTu(){return this.g_aTn}g_aTv(){return this.g_aTr}g_ahQ(){return this.g_aTn.duration}},"use strict",self.g_aTe=class extends g_aSm{constructor(g,a,_,t,n,e){super(g,a,_,t,n),this.g_aTc="webaudio",this.g_aTw=null,this.g_aTx=null,this.g_aTy=!!e}g_ek(){this.g_aS$.g_aSg(this),this.g_aTw=null,this.g_aTx=null,super.g_ek()}async g_aTz(){if(this.g_aTw)return this.g_aTw;const g=this.g_aS$.g_aJg();if("cordova"===g.g_asy()&&g.g_fX(this.g_Cv))this.g_aTw=await g.g_BK(this.g_Cv);else{const g=await fetch(this.g_Cv);if(!g.ok)throw new Error(`error fetching audio data: ${g.status} ${g.statusText}`);this.g_aTw=await g.arrayBuffer()}}async g_aTA(){return this.g_aTx?this.g_aTx:void(this.g_aTx=await this.g_aS$.g_aSf(this.g_aTw,this.g_aTy),this.g_aTw=null)}async g_Hm(){try{this.g_aTd="loading",await this.g_aTz(),await this.g_aTA(),this.g_aTd="loaded"}catch(g){this.g_aTd="failed",console.error(`[Construct 3] Failed to load audio '${this.g_Cv}': `,g)}}g_CB(){return!!(this.g_aTw||this.g_aTx)}g_aTi(){return!!this.g_aTx}g_aSJ(){return this.g_aTx}g_ahQ(){return this.g_aTx?this.g_aTx.duration:0}},"use strict";{function _(e){return e*g}const g=180/Math.PI;self.g_aTB=class{constructor(g,a,e){this.g_aS$=g,this.g_wy=a,this.g_aLU=e,this.g_aTC=this.g_aFS().createGain(),this.g_aTC.connect(this.g_aFU()),this.g_aTD=null,this.g_aTE=!1,this.g_UA=!0,this.g_aTF=!1,this.g_aTG=!1,this.g_$R=!1,this.g_aTH=1,this.g_aTI=!1,this.g_Lm=1;const _=this.g_aS$.g_aRY();this.g_aTJ=1===_&&!this.g_aSj()||2===_,this.g_aTK=-1,this.g_aTL=-1,this.g_aTM=!1}g_ek(){this.g_aS$=null,this.g_wy=null,this.g_aTD&&(this.g_aTD.disconnect(),this.g_aTD=null),this.g_aTC.disconnect(),this.g_aTC=null}g_aFS(){return this.g_aS$.g_aFS()}g_aFU(){return this.g_aS$.g_aRP(this.g_aLU)}g_aRX(){return this.g_aS$.g_aRX()}g_aTN(){return this.g_aTJ?this.g_aS$.g_Gb():performance.now()/1e3}g_aTl(){return this.g_wy.g_aTl()}g_aSl(){return this.g_wy.g_aSl()}g_aTm(){return this.g_wy.g_aTm()}g_aSh(){return this.g_wy}g_aSj(){return this.g_wy.g_aSj()}g_aSp(g){this.g_aLU=g}g_aLZ(){return this.g_aLU}g_aSk(){}g_aSo(){}g_L$(){return!this.g_UA&&!this.g_aTF&&!this.g_aSk()}g_XR(){return!this.g_UA&&!this.g_aSk()}g_aTO(){}g_ahQ(g){let a=this.g_wy.g_ahQ();return g&&(a/=this.g_Lm||.001),a}g_MJ(){}g_JV(){}g_aSB(){}g_aTP(){return this.g_aTF}g_MI(){}g_aGV(g){this.g_aTH=g,this.g_aTC.gain.cancelScheduledValues(0),this.g_aTL=-1,this.g_aTC.gain.value=this.g_aTQ()}g_aGW(g,_,t){if(!this.g_aTR()){g*=this.g_aRX();const a=this.g_aTC.gain;a.cancelScheduledValues(0);const n=this.g_aS$.g_aRN(),e=n+_;a.setValueAtTime(a.value,n),a.linearRampToValueAtTime(g,e),this.g_aTH=g,this.g_aTL=e,this.g_aTM=t}}g_aSC(){this.g_aGV(this.g_aTH)}g_KM(g){-1!==this.g_aTL&&g>=this.g_aTL&&(this.g_aTL=-1,this.g_aTM&&this.g_JV(),this.g_aS$.g_aSx("fade-ended",this.g_aLU))}g_aTQ(){const g=this.g_aTH*this.g_aRX();return isFinite(g)?g:0}g_aGU(g){g=!!g,this.g_aTI===g||(this.g_aTI=g,this.g_aSD())}g_aTR(){return this.g_aTI}g_aGL(){return this.g_aS$.g_aGL()}g_aSD(){}g_aGT(){}g_Zy(){return this.g_$R}g_LY(g){this.g_Lm===g||(this.g_Lm=g,this.g_aSE())}g_aSE(){}g_LZ(){return this.g_Lm}g_aG$(){}g_arJ(){}g_aSy(g){g=!!g,this.g_aTE===g||(this.g_aTE=g,this.g_aTE?(!this.g_aTD&&(this.g_aTD=this.g_aFS().createPanner(),this.g_aTD.panningModel=this.g_aS$.g_aSa(),this.g_aTD.distanceModel=this.g_aS$.g_aSb(),this.g_aTD.refDistance=this.g_aS$.g_aSc(),this.g_aTD.maxDistance=this.g_aS$.g_aSd(),this.g_aTD.rolloffFactor=this.g_aS$.g_aSe()),this.g_aTC.disconnect(),this.g_aTC.connect(this.g_aTD),this.g_aTD.connect(this.g_aFU())):(this.g_aTD.disconnect(),this.g_aTC.disconnect(),this.g_aTC.connect(this.g_aFU())))}g_aSz(a,t,n,i,e,o){this.g_aTE&&(this.g_aSF(a,t,n),this.g_aTD.coneInnerAngle=_(i),this.g_aTD.coneOuterAngle=_(e),this.g_aTD.coneOuterGain=o)}g_aSF(g,a,e){this.g_aTE&&(this.g_aTD.setPosition(g,a,0),this.g_aTD.setOrientation(Math.cos(e),Math.sin(e),0))}g_aSA(g){this.g_aTK=g}g_D$(){return this.g_aTK}g_aTS(){}g_aRW(g){const a=this.g_aTD||this.g_aTC;a.disconnect(),a.connect(g)}g_aSv(){return{tag:this.g_aLU,duration:this.g_ahQ(),volume:this.g_aTH,isPlaying:this.g_L$(),playbackTime:this.g_aTO(),playbackRate:this.g_LZ(),uid:this.g_aTK,bufferOriginalUrl:this.g_aTl(),bufferUrl:"",bufferType:this.g_aTm(),isMusic:this.g_aSj(),isLooping:this.g_Zy(),isMuted:this.g_aTR(),resumePosition:this.g_aTS(),pan:this.g_aTT()}}g_aS_(g){this.g_LY(g.playbackRate),this.g_aGU(g.isMuted)}g_aTT(){if(!this.g_aTD)return null;const g=this.g_aTD;return{pos:[g.positionX.value,g.positionY.value,g.positionZ.value],orient:[g.orientationX.value,g.orientationY.value,g.orientationZ.value],cia:g.coneInnerAngle,coa:g.coneOuterAngle,cog:g.coneOuterGain,uid:this.g_aTK}}g_aSZ(g){if(!g)return void this.g_aSy(!1);this.g_aSy(!0);const a=this.g_aTD;a.setPosition(...a.pos),a.setOrientation(...a.orient),a.coneInnerAngle=a.cia,a.coneOuterAngle=a.coa,a.coneOuterGain=a.cog,this.g_aTK=a.uid}}}"use strict",self.g_aTg=class extends g_aTB{constructor(g,a,e){super(g,a,e),this.g_wy.g_aTv().connect(this.g_aTC),this.g_wy.onended=()=>this.g_aTU()}g_ek(){this.g_JV(),this.g_wy.g_aTv().disconnect(),super.g_ek()}g_aTu(){return this.g_wy.g_aTu()}g_aTU(){this.g_UA=!0,this.g_aTK=-1,this.g_aS$.g_aSx("ended",this.g_aLU)}g_aSk(){return this.g_aTu().ended}g_aSo(){return!!this.g_UA||this.g_aSk()}g_aTO(g){let a=this.g_aTu().currentTime;return g&&(a*=this.g_Lm),this.g_$R||(a=Math.min(a,this.g_ahQ())),a}g_MJ(g,a,e){const _=this.g_aTu();if(1!==_.playbackRate&&(_.playbackRate=1),_.loop!==g&&(_.loop=g),this.g_aGV(a),_.muted&&(_.muted=!1),_.currentTime!==e)try{_.currentTime=e}catch(g){console.warn(`[Construct 3] Exception seeking audio '${this.g_wy.g_aSl()}' to position '${e}': `,g)}this.g_aS$.g_aKz(_),this.g_UA=!1,this.g_aTF=!1,this.g_$R=g,this.g_Lm=1}g_JV(){const g=this.g_aTu();g.paused||g.pause(),this.g_aS$.g_aKA(g),this.g_UA=!0,this.g_aTF=!1,this.g_aTK=-1}g_aSB(){if(!(this.g_aTF||this.g_UA||this.g_aSk())){const g=this.g_aTu();g.paused||g.pause(),this.g_aS$.g_aKA(g),this.g_aTF=!0}}g_MI(){!this.g_aTF||this.g_UA||this.g_aSk()||(this.g_aS$.g_aKz(this.g_aTu()),this.g_aTF=!1)}g_aSD(){this.g_aTu().muted=this.g_aTI||this.g_aGL()}g_aGT(g){g=!!g,this.g_$R===g||(this.g_$R=g,this.g_aTu().loop=g)}g_aSE(){let g=this.g_Lm;this.g_aTJ&&(g*=this.g_aS$.g_KK());try{this.g_aTu().playbackRate=g}catch(a){console.warn(`[Construct 3] Unable to set playback rate '${g}':`,a)}}g_aG$(g){if(!(this.g_UA||this.g_aSk()))try{this.g_aTu().currentTime=g}catch(a){console.warn(`[Construct 3] Error seeking audio to '${g}': `,a)}}g_aTS(){return this.g_aTO()}g_arJ(g){g?this.g_L$()?(this.g_aTu().pause(),this.g_aTG=!0):this.g_aTG=!1:this.g_aTG&&(this.g_aS$.g_aKz(this.g_aTu()),this.g_aTG=!1)}},"use strict",self.g_aTh=class extends g_aTB{constructor(g,a,e){super(g,a,e),this.g_aTV=null,this.g_aTW=g=>this.g_aTU(g),this.g_aTX=!0,this.g_aTY=null,this.g_aqi=0,this.g_aTZ=0,this.g_aT_=1}g_ek(){this.g_JV(),this.g_aT$(),this.g_aTW=null,super.g_ek()}g_aT$(){this.g_aTV&&this.g_aTV.disconnect(),this.g_aTV=null,this.g_aTY=null}g_aTU(g){this.g_aTF||this.g_aTG||g.target!==this.g_aTY||(this.g_aTX=!0,this.g_UA=!0,this.g_aTK=-1,this.g_aT$(),this.g_aS$.g_aSx("ended",this.g_aLU))}g_aSk(){return!(!this.g_UA&&this.g_aTV&&this.g_aTV.loop)&&!this.g_aTF&&this.g_aTX}g_aSo(){return!this.g_aTV||this.g_UA||this.g_aSk()}g_aTO(g){let a=0;return a=this.g_aTF?this.g_aTZ:this.g_aTN()-this.g_aqi,g&&(a*=this.g_Lm),this.g_$R||(a=Math.min(a,this.g_ahQ())),a}g_MJ(g,a,e,_){this.g_aT_=1,this.g_aGV(a),this.g_aT$(),this.g_aTV=this.g_aFS().createBufferSource(),this.g_aTV.buffer=this.g_wy.g_aSJ(),this.g_aTV.connect(this.g_aTC),this.g_aTY=this.g_aTV,this.g_aTV.onended=this.g_aTW,this.g_aTV.loop=g,this.g_aTV.start(_,e),this.g_aTX=!1,this.g_UA=!1,this.g_aTF=!1,this.g_$R=g,this.g_Lm=1,this.g_aqi=this.g_aTN()-e}g_JV(){this.g_aTV&&this.g_aTV.stop(0),this.g_UA=!0,this.g_aTF=!1,this.g_aTK=-1}g_aSB(){this.g_aTF||this.g_UA||this.g_aSk()||(this.g_aTZ=this.g_aTO(!0),this.g_$R&&(this.g_aTZ%=this.g_ahQ()),this.g_aTF=!0,this.g_aTV.stop(0))}g_MI(){!this.g_aTF||this.g_UA||this.g_aSk()||(this.g_aT$(),this.g_aTV=this.g_aFS().createBufferSource(),this.g_aTV.buffer=this.g_wy.g_aSJ(),this.g_aTV.connect(this.g_aTC),this.g_aTY=this.g_aTV,this.g_aTV.onended=this.g_aTW,this.g_aTV.loop=this.g_$R,this.g_aSC(),this.g_aSE(),this.g_aqi=this.g_aTN()-this.g_aTZ/(this.g_Lm||.001),this.g_aTV.start(0,this.g_aTZ),this.g_aTF=!1)}g_aTQ(){return super.g_aTQ()*this.g_aT_}g_aSD(){this.g_aT_=this.g_aTI||this.g_aGL()?0:1,this.g_aSC()}g_aGT(g){g=!!g,this.g_$R===g||(this.g_$R=g,this.g_aTV&&(this.g_aTV.loop=g))}g_aSE(){let g=this.g_Lm;this.g_aTJ&&(g*=this.g_aS$.g_KK()),this.g_aTV&&(this.g_aTV.playbackRate.value=g)}g_aG$(g){this.g_UA||this.g_aSk()||(this.g_aTF?this.g_aTZ=g:(this.g_aSB(),this.g_aTZ=g,this.g_MI()))}g_aTS(){return this.g_aTZ}g_arJ(g){g?this.g_L$()?(this.g_aTG=!0,this.g_aTZ=this.g_aTO(!0),this.g_$R&&(this.g_aTZ%=this.g_ahQ()),this.g_aTV.stop(0)):this.g_aTG=!1:this.g_aTG&&(this.g_aT$(),this.g_aTV=this.g_aFS().createBufferSource(),this.g_aTV.buffer=this.g_wy.g_aSJ(),this.g_aTV.connect(this.g_aTC),this.g_aTY=this.g_aTV,this.g_aTV.onended=this.g_aTW,this.g_aTV.loop=this.g_$R,this.g_aSC(),this.g_aSE(),this.g_aqi=this.g_aTN()-this.g_aTZ/(this.g_Lm||.001),this.g_aTV.start(0,this.g_aTZ),this.g_aTG=!1)}g_aS_(g){super.g_aS_(g),this.g_aTZ=g.resumePosition}},"use strict";{function g(g){return Math.pow(10,g/20)}function _(a){return Math.max(Math.min(g(a),1),0)}function t(g){return 20*(Math.log(g)/2.302585092994046)}function n(g){return t(Math.max(Math.min(g,1),0))}function i(g,a){return 1-Math.exp(-a*g)}class a{constructor(g){this.g_aS$=g,this.g_aQZ=g.g_aFS(),this.g_Di=-1,this.g_aLU="",this.g_kI="",this.g_aUa=null}g_ek(){this.g_aQZ=null}g_alA(g){this.g_Di=g}g_ED(){return this.g_Di}g_aRS(g){this.g_aLU=g}g_aLZ(){return this.g_aLU}g_aUb(){return this.g_aQZ.createGain()}g_aRQ(){}g_aRU(){}g_aUc(g,a,_,t){if(g.cancelScheduledValues(0),0===t)return void(g.value=a);const n=this.g_aQZ.currentTime;t+=n,0===_?g.setValueAtTime(a,t):1===_?(g.setValueAtTime(g.value,n),g.linearRampToValueAtTime(a,t)):2===_?(g.setValueAtTime(g.value,n),g.exponentialRampToValueAtTime(a,t)):void 0}g_aSv(){return{type:this.g_kI,tag:this.g_aLU,params:this.g_aUa}}}self.g_aSG=class extends a{constructor(_,a,t,n,i,e,o){super(_),this.g_kI="filter",this.g_aUa=[a,t,n,i,e,o],this.g_aUd=this.g_aUb(),this.g_aUe=this.g_aUb(),this.g_aUe.gain.value=o,this.g_aUf=this.g_aUb(),this.g_aUf.gain.value=1-o,this.g_aUg=this.g_aQZ.createBiquadFilter(),this.g_aUg.type=a,this.g_aUg.frequency.value=t,this.g_aUg.detune.value=n,this.g_aUg.Q.value=i,this.g_aUg.gain.vlaue=e,this.g_aUd.connect(this.g_aUg),this.g_aUd.connect(this.g_aUf),this.g_aUg.connect(this.g_aUe)}g_ek(){this.g_aUd.disconnect(),this.g_aUg.disconnect(),this.g_aUe.disconnect(),this.g_aUf.disconnect(),super.g_ek()}g_aRU(g){this.g_aUe.disconnect(),this.g_aUe.connect(g),this.g_aUf.disconnect(),this.g_aUf.connect(g)}g_aRQ(){return this.g_aUd}g_aSU(g,a,e,_){0===g?(a=Math.max(Math.min(a/100,1),0),this.g_aUa[5]=a,this.g_aUc(this.g_aUe.gain,a,e,_),this.g_aUc(this.g_aUf.gain,1-a,e,_)):1===g?(this.g_aUa[1]=a,this.g_aUc(this.g_aUg.frequency,a,e,_)):2===g?(this.g_aUa[2]=a,this.g_aUc(this.g_aUg.detune,a,e,_)):3===g?(this.g_aUa[3]=a,this.g_aUc(this.g_aUg.Q,a,e,_)):4===g?(this.g_aUa[4]=a,this.g_aUc(this.g_aUg.gain,a,e,_)):void 0}},self.g_aSH=class extends a{constructor(g,a,e,_){super(g),this.g_kI="delay",this.g_aUa=[a,e,_],this.g_aUd=this.g_aUb(),this.g_aUe=this.g_aUb(),this.g_aUe.gain.value=_,this.g_aUf=this.g_aUb(),this.g_aUf.gain.value=1-_,this.g_aUh=this.g_aUb(),this.g_aUi=this.g_aQZ.createDelay(a),this.g_aUi.delayTime.value=a,this.g_aUj=this.g_aUb(),this.g_aUj.gain.value=e,this.g_aUd.connect(this.g_aUh),this.g_aUd.connect(this.g_aUf),this.g_aUh.connect(this.g_aUe),this.g_aUh.connect(this.g_aUi),this.g_aUi.connect(this.g_aUj),this.g_aUj.connect(this.g_aUh)}g_ek(){this.g_aUd.disconnect(),this.g_aUe.disconnect(),this.g_aUf.disconnect(),this.g_aUh.disconnect(),this.g_aUi.disconnect(),this.g_aUj.disconnect(),super.g_ek()}g_aRU(g){this.g_aUe.disconnect(),this.g_aUe.connect(g),this.g_aUf.disconnect(),this.g_aUf.connect(g)}g_aRQ(){return this.g_aUd}g_aSU(g,a,t,n){0===g?(a=Math.max(Math.min(a/100,1),0),this.g_aUa[2]=a,this.g_aUc(this.g_aUe.gain,a,t,n),this.g_aUc(this.g_aUf.gain,1-a,t,n)):4===g?(this.g_aUa[1]=_(a),this.g_aUc(this.g_aUj.gain,_(a),t,n)):5===g?(this.g_aUa[0]=a,this.g_aUc(this.g_aUi.delayTime,a,t,n)):void 0}},self.g_aSI=class extends a{constructor(g,a,e,_){super(g),this.g_kI="convolution",this.g_aUa=[e,_],this.g_aUk="",this.g_aUl="",this.g_aUm="",this.g_aUd=this.g_aUb(),this.g_aUe=this.g_aUb(),this.g_aUe.gain.value=_,this.g_aUf=this.g_aUb(),this.g_aUf.gain.value=1-_,this.g_aUn=this.g_aQZ.createConvolver(),this.g_aUn.normalize=e,this.g_aUn.buffer=a,this.g_aUd.connect(this.g_aUn),this.g_aUd.connect(this.g_aUf),this.g_aUn.connect(this.g_aUe)}g_ek(){this.g_aUd.disconnect(),this.g_aUn.disconnect(),this.g_aUe.disconnect(),this.g_aUf.disconnect(),super.g_ek()}g_aRU(g){this.g_aUe.disconnect(),this.g_aUe.connect(g),this.g_aUf.disconnect(),this.g_aUf.connect(g)}g_aRQ(){return this.g_aUd}g_aSU(g,a,e,_){0===g?(a=Math.max(Math.min(a/100,1),0),this.g_aUa[1]=a,this.g_aUc(this.g_aUe.gain,a,e,_),this.g_aUc(this.g_aUf.gain,1-a,e,_)):void 0}g_aSK(g,a,e){this.g_aUk=g,this.g_aUl=a,this.g_aUm=e}g_aSv(){const g=super.g_aSv();return g.bufferOriginalUrl=this.g_aUk,g.bufferUrl="",g.bufferType=this.g_aUm,g}},self.g_aSL=class extends a{constructor(g,a,_,t,n,e){super(g),this.g_kI="flanger",this.g_aUa=[a,_,t,n,e],this.g_aUd=this.g_aUb(),this.g_aUf=this.g_aUb(),this.g_aUf.gain.value=1-e/2,this.g_aUe=this.g_aUb(),this.g_aUe.gain.value=e/2,this.g_aUo=this.g_aUb(),this.g_aUo.gain.value=n,this.g_aUi=this.g_aQZ.createDelay(a+_),this.g_aUi.delayTime.value=a,this.g_aUp=this.g_aQZ.createOscillator(),this.g_aUp.frequency.value=t,this.g_aUq=this.g_aUb(),this.g_aUq.gain.value=_,this.g_aUd.connect(this.g_aUi),this.g_aUd.connect(this.g_aUf),this.g_aUi.connect(this.g_aUe),this.g_aUi.connect(this.g_aUo),this.g_aUo.connect(this.g_aUi),this.g_aUp.connect(this.g_aUq),this.g_aUq.connect(this.g_aUi.delayTime),this.g_aUp.start(0)}g_ek(){this.g_aUp.stop(0),this.g_aUd.disconnect(),this.g_aUi.disconnect(),this.g_aUp.disconnect(),this.g_aUq.disconnect(),this.g_aUf.disconnect(),this.g_aUe.disconnect(),this.g_aUo.disconnect(),super.g_ek()}g_aRU(g){this.g_aUe.disconnect(),this.g_aUe.connect(g),this.g_aUf.disconnect(),this.g_aUf.connect(g)}g_aRQ(){return this.g_aUd}g_aSU(g,a,e,_){0===g?(a=Math.max(Math.min(a/100,1),0),this.g_aUa[4]=a,this.g_aUc(this.g_aUe.gain,a/2,e,_),this.g_aUc(this.g_aUf.gain,1-a/2,e,_)):6===g?(this.g_aUa[1]=a/1e3,this.g_aUc(this.g_aUq.gain,a/1e3,e,_)):7===g?(this.g_aUa[2]=a,this.g_aUc(this.g_aUp.frequency,a,e,_)):8===g?(this.g_aUa[3]=a/100,this.g_aUc(this.g_aUo.gain,a/100,e,_)):void 0}},self.g_aSM=class extends a{constructor(_,a,t,n,i,e,o){super(_),this.g_kI="phaser",this.g_aUa=[a,t,n,i,e,o],this.g_aUd=this.g_aUb(),this.g_aUf=this.g_aUb(),this.g_aUf.gain.value=1-o/2,this.g_aUe=this.g_aUb(),this.g_aUe.gain.value=o/2,this.g_aUg=this.g_aQZ.createBiquadFilter(),this.g_aUg.type="allpass",this.g_aUg.frequency.value=a,this.g_aUg.detune.value=t,this.g_aUg.Q.value=n,this.g_aUp=this.g_aQZ.createOscillator(),this.g_aUp.frequency.value=e,this.g_aUq=this.g_aUb(),this.g_aUq.gain.value=i,this.g_aUd.connect(this.g_aUg),this.g_aUd.connect(this.g_aUf),this.g_aUg.connect(this.g_aUe),this.g_aUp.connect(this.g_aUq),this.g_aUq.connect(this.g_aUg.frequency),this.g_aUp.start(0)}g_ek(){this.g_aUp.stop(0),this.g_aUd.disconnect(),this.g_aUg.disconnect(),this.g_aUp.disconnect(),this.g_aUq.disconnect(),this.g_aUf.disconnect(),this.g_aUe.disconnect(),super.g_ek()}g_aRU(g){this.g_aUe.disconnect(),this.g_aUe.connect(g),this.g_aUf.disconnect(),this.g_aUf.connect(g)}g_aRQ(){return this.g_aUd}g_aSU(g,a,e,_){0===g?(a=Math.max(Math.min(a/100,1),0),this.g_aUa[5]=a,this.g_aUc(this.g_aUe.gain,a/2,e,_),this.g_aUc(this.g_aUf.gain,1-a/2,e,_)):1===g?(this.g_aUa[0]=a,this.g_aUc(this.g_aUg.frequency,a,e,_)):2===g?(this.g_aUa[1]=a,this.g_aUc(this.g_aUg.detune,a,e,_)):3===g?(this.g_aUa[2]=a,this.g_aUc(this.g_aUg.Q,a,e,_)):6===g?(this.g_aUa[3]=a,this.g_aUc(this.g_aUq.gain,a,e,_)):7===g?(this.g_aUa[4]=a,this.g_aUc(this.g_aUp.frequency,a,e,_)):void 0}},self.g_aSN=class extends a{constructor(g,a){super(g),this.g_kI="gain",this.g_aUa=[a],this.g_aUr=this.g_aUb(),this.g_aUr.gain.value=a}g_ek(){this.g_aUr.disconnect(),super.g_ek()}g_aRU(g){this.g_aUr.disconnect(),this.g_aUr.connect(g)}g_aRQ(){return this.g_aUr}g_aSU(g,a,t,n){4===g?(this.g_aUa[0]=_(a),this.g_aUc(this.g_aUr.gain,_(a),t,n)):void 0}},self.g_aSO=class extends a{constructor(g,a,e){super(g),this.g_kI="tremolo",this.g_aUa=[a,e],this.g_aUr=this.g_aUb(),this.g_aUr.gain.value=1-e/2,this.g_aUp=this.g_aQZ.createOscillator(),this.g_aUp.frequency.value=a,this.g_aUq=this.g_aUb(),this.g_aUq.gain.value=e/2,this.g_aUp.connect(this.g_aUq),this.g_aUq.connect(this.g_aUr.gain),this.g_aUp.start(0)}g_ek(){this.g_aUp.stop(0),this.g_aUp.disconnect(),this.g_aUq.disconnect(),this.g_aUr.disconnect(),super.g_ek()}g_aRU(g){this.g_aUr.disconnect(),this.g_aUr.connect(g)}g_aRQ(){return this.g_aUr}g_aSU(g,a,e,_){0===g?(a=Math.max(Math.min(a/100,1),0),this.g_aUa[1]=a,this.g_aUc(this.g_aUr.gain.value,1-a/2,e,_),this.g_aUc(this.g_aUq.gain.value,a/2,e,_)):7===g?(this.g_aUa[0]=a,this.g_aUc(this.g_aUp.frequency,a,e,_)):void 0}},self.g_aSP=class extends a{constructor(g,a,e){super(g),this.g_kI="ringmod",this.g_aUa=[a,e],this.g_aUd=this.g_aUb(),this.g_aUe=this.g_aUb(),this.g_aUe.gain.value=e,this.g_aUf=this.g_aUb(),this.g_aUf.gain.value=1-e,this.g_aUs=this.g_aUb(),this.g_aUs.gain.value=0,this.g_aUp=this.g_aQZ.createOscillator(),this.g_aUp.frequency.value=a,this.g_aUp.connect(this.g_aUs.gain),this.g_aUp.start(0),this.g_aUd.connect(this.g_aUs),this.g_aUd.connect(this.g_aUf),this.g_aUs.connect(this.g_aUe)}g_ek(){this.g_aUp.stop(0),this.g_aUp.disconnect(),this.g_aUs.disconnect(),this.g_aUd.disconnect(),this.g_aUe.disconnect(),this.g_aUf.disconnect(),super.g_ek()}g_aRU(g){this.g_aUe.disconnect(),this.g_aUe.connect(g),this.g_aUf.disconnect(),this.g_aUf.connect(g)}g_aRQ(){return this.g_aUd}g_aSU(g,a,e,_){0===g?(a=Math.max(Math.min(a/100,1),0),this.g_aUa[1]=a,this.g_aUc(this.g_aUe.gain,a,e,_),this.g_aUc(this.g_aUf.gain,1-a,e,_)):7===g?(this.g_aUa[0]=a,this.g_aUc(this.g_aUp.frequency,a,e,_)):void 0}},self.g_aSQ=class extends a{constructor(g,a,_,t,n,e){super(g),this.g_kI="distortion",this.g_aUa=[a,_,t,n,e],this.g_aUd=this.g_aUb(),this.g_aUt=this.g_aUb(),this.g_aUu=this.g_aUb(),this.g_aUv(t,n),this.g_aUe=this.g_aUb(),this.g_aUe.gain.value=e,this.g_aUf=this.g_aUb(),this.g_aUf.gain.value=1-e,this.g_aUw=this.g_aQZ.createWaveShaper(),this.g_aUx=new Float32Array(65536),this.g_aUy(a,_),this.g_aUw.curve=this.g_aUx,this.g_aUd.connect(this.g_aUt),this.g_aUd.connect(this.g_aUf),this.g_aUt.connect(this.g_aUw),this.g_aUw.connect(this.g_aUu),this.g_aUu.connect(this.g_aUe)}g_ek(){this.g_aUd.disconnect(),this.g_aUt.disconnect(),this.g_aUw.disconnect(),this.g_aUu.disconnect(),this.g_aUe.disconnect(),this.g_aUf.disconnect(),super.g_ek()}g_aUv(g,e){.01>g&&(g=.01),this.g_aUt.gain.value=g,this.g_aUu.gain.value=Math.pow(1/g,.6)*e}g_aUy(g,a){for(let e,_=0;32768>_;++_)e=_/32768,e=this.g_aUz(e,g,a),this.g_aUx[32768+_]=e,this.g_aUx[32768-_-1]=-e}g_aUz(e,a,_){const t=1.05*_*a-a,n=0>e?-1:1,o=0>e?-e:e;let g=o<a?o:a+t*i(o-a,1/t);return g*=n,g}g_aRU(g){this.g_aUe.disconnect(),this.g_aUe.connect(g),this.g_aUf.disconnect(),this.g_aUf.connect(g)}g_aRQ(){return this.g_aUd}g_aSU(g,a,e,_){0===g?(a=Math.max(Math.min(a/100,1),0),this.g_aUa[4]=a,this.g_aUc(this.g_aUe.gain,a,e,_),this.g_aUc(this.g_aUf.gain,1-a,e,_)):void 0}},self.g_aSR=class extends a{constructor(g,a,_,t,n,e){super(g),this.g_kI="compressor",this.g_aUa=[a,_,t,n,e],this.g_aUr=this.g_aQZ.createDynamicsCompressor(),this.g_aUr.threshold.value=a,this.g_aUr.knee.value=_,this.g_aUr.ratio.value=t,this.g_aUr.attack.value=n,this.g_aUr.release.value=e}g_ek(){this.g_aUr.disconnect(),super.g_ek()}g_aRU(g){this.g_aUr.disconnect(),this.g_aUr.connect(g)}g_aRQ(){return this.g_aUr}g_aSU(){}},self.g_aSS=class extends a{constructor(g,a,e){super(g),this.g_kI="analyser",this.g_aUa=[a,e],this.g_aUr=this.g_aQZ.createAnalyser(),this.g_aUr.fftSize=a,this.g_aUr.smoothingTimeConstant=e,this.g_aUA=new Float32Array(this.g_aUr.frequencyBinCount),this.g_aUB=new Uint8Array(a),this.g_aUC=0,this.g_aUD=0,this.g_aS$.g_aSV(this)}g_ek(){this.g_aS$.g_aSW(this),this.g_aUr.disconnect(),super.g_ek()}g_KM(){this.g_aUr.getFloatFrequencyData(this.g_aUA),this.g_aUr.getByteTimeDomainData(this.g_aUB);const g=this.g_aUr.fftSize;this.g_aUC=0;let a=0;for(let e,_=0;_<g;++_)e=(this.g_aUB[_]-128)/128,0>e&&(e=-e),this.g_aUC<e&&(this.g_aUC=e),a+=e*e;this.g_aUC=n(this.g_aUC),this.g_aUD=n(Math.sqrt(a/g))}g_aRU(g){this.g_aUr.disconnect(),this.g_aUr.connect(g)}g_aRQ(){return this.g_aUr}g_aSU(){}g_aSw(){return{tag:this.g_aLZ(),index:this.g_ED(),peak:this.g_aUC,rms:this.g_aUD,binCount:this.g_aUr.frequencyBinCount,freqBins:this.g_aUA}}}}