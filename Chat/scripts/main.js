"use strict";window.g_aIV=class{constructor(g,a){this.g_aqU=g,this.g_aIW=a,this.g_aIX=!1,this.g_aIY=()=>this.g_KM()}g_aIZ(){}g_aI_(g,a,e,_){this.g_aqU.g_aI$(this.g_aIW,g,a,e,_)}g_aJa(g,a,e,_){return this.g_aqU.g_aJb(this.g_aIW,g,a,e,_)}g_aJc(g,a,e){this.g_aqU.g_aJd()?this.g_aI_(g,a,e):this.g_aqU.g_aJe()._OnMessageFromDOM({type:"event",component:this.g_aIW,handler:g,dispatchOpts:e||null,data:a,responseId:null})}g_aJf(g,a){this.g_aqU.g_aJg(this.g_aIW,g,a)}g_aJh(g){for(const[a,e]of g)this.g_aJf(a,e)}g_aJi(){return this.g_aqU}g_aJj(){return this.g_aIW}g_adZ(){this.g_aIX||(this.g_aqU.g_aJk(this.g_aIY),this.g_aIX=!0)}g_adK(){this.g_aIX&&(this.g_aqU.g_aJl(this.g_aIY),this.g_aIX=!1)}g_KM(){}},window.g_mM=class{constructor(g,a){this.g_lv=g,this.g_mN=a,this.g_mP=-1,this.g_mQ=-Infinity,this.g_mR=()=>this.g_mS(),this.g_mT=!1,this.g_mU=!1}g_mW(g){this.g_mU=!!g}g_m_(){if(-1===this.g_mP){const g=Date.now(),a=g-this.g_mQ,e=this.g_mN;a>=e&&this.g_mU?(this.g_mQ=g,this.g_m$()):this.g_mP=self.setTimeout(this.g_mR,Math.max(e-a,4))}}g_m$(){this.g_mT=!0,this.g_lv(),this.g_mT=!1}g_lz(){this.g_mT||(this.g_na(),this.g_mQ=Date.now())}g_mS(){this.g_mP=-1,this.g_mQ=Date.now(),this.g_m$()}g_na(){-1!==this.g_mP&&(self.clearTimeout(this.g_mP),this.g_mP=-1)}g_ek(){this.g_na(),this.g_lv=null,this.g_mR=null}},"use strict",window.g_aJm=class extends g_aIV{constructor(g,a){super(g,a),this.g_aJn=new Map,this.g_aJo=!0,this.g_aJf("create",g=>this.g_aJp(g)),this.g_aJf("destroy",g=>this.g_aJq(g)),this.g_aJf("set-visible",g=>this.g_aJr(g)),this.g_aJf("update-position",g=>this.g_aJs(g)),this.g_aJf("update-state",g=>this.g_aG_(g)),this.g_aJf("focus",g=>this.g_aJt(g)),this.g_aJf("set-css-style",g=>this.g_aJu(g))}g_aJv(g){this.g_aJo=!!g}g_aJw(g,e){this.g_aJf(g,g=>{const a=g.elementId,_=this.g_aJn.get(a);return e(_,g)})}g_aJp(g){const a=g.elementId,e=this.g_aex(a,g);this.g_aJn.set(a,e),g.isVisible||(e.style.display="none"),this.g_aJo&&document.body.appendChild(e)}g_aex(){throw new Error("required override")}g_aJx(){}g_aJq(g){const a=g.elementId,e=this.g_aJn.get(a);this.g_aJx(e),this.g_aJo&&e.parentElement.removeChild(e),this.g_aJn.delete(a)}g_aJy(g,a,e){e||(e={}),e.elementId=a,this.g_aI_(g,e)}g_aJz(g,a,e){e||(e={}),e.elementId=a,this.g_aJc(g,e)}g_aJr(g){if(this.g_aJo){const a=this.g_aJn.get(g.elementId);a.style.display=g.isVisible?"":"none"}}g_aJs(g){if(this.g_aJo){const a=this.g_aJn.get(g.elementId);a.style.left=g.left+"px",a.style.top=g.top+"px",a.style.width=g.width+"px",a.style.height=g.height+"px";const e=g.fontSize;null!==e&&(a.style.fontSize=e+"em")}}g_aG_(g){const a=this.g_aJn.get(g.elementId);this.g_aJA(a,g)}g_aJA(){throw new Error("required override")}g_aJt(g){const a=this.g_aJn.get(g.elementId);g.focus?a.focus():a.blur()}g_aJu(g){const a=this.g_aJn.get(g.elementId);a.style[g.prop]=g.val}g_aJB(g){return this.g_aJn.get(g)}},"use strict";{function _(g){if(g.g_aJC){const a=document.createElement("script");a.async=!1,a.textContent=g.g_C,document.head.appendChild(a)}else return new Promise((a,e)=>{const _=document.createElement("script");_.onload=a,_.onerror=e,_.async=!1,_.src=g,document.head.appendChild(_)})}async function t(g){const a=await r(g),e=new TextDecoder("utf-8");return e.decode(a)}function r(g){return new Promise((e,_)=>{const a=new FileReader;a.onload=g=>e(g.target.result),a.onerror=g=>_(g),a.readAsArrayBuffer(g)})}function s(g){return n.has(g)}const a=/(iphone|ipod|ipad)/i.test(navigator.userAgent);let e=new Audio;const d={"audio/webm; codecs=opus":!!e.canPlayType("audio/webm; codecs=opus"),"audio/ogg; codecs=opus":!!e.canPlayType("audio/ogg; codecs=opus"),"audio/webm; codecs=vorbis":!!e.canPlayType("audio/webm; codecs=vorbis"),"audio/ogg; codecs=vorbis":!!e.canPlayType("audio/ogg; codecs=vorbis"),"audio/mp4":!!e.canPlayType("audio/mp4"),"audio/mpeg":!!e.canPlayType("audio/mpeg")};e=null;const g=[];let u=0;window.RealFile=window.File;const i=[],p=new Map,h=new Map;let l=0;const m=[];self.g_aJD=function(g){if("function"!=typeof g)throw new Error("runOnStartup called without a function");m.push(g)};const n=new Set(["cordova","playable-ad","instant-games"]);window.g_aJE=class e{constructor(g){this.g_aJF=g.g_aJG,this.g_aJH=null,this.g_aoP="",this.g_aJI=g.g_aJJ,this.g_aJK={},this.g_aJL=null,this.g_aJM=null,this.g_aJN=[],this.g_aJO=null,this.g_amQ=null,this.g_aqO=null,this.g_anx=-1,this.g_aJP=()=>this.g_aJQ(),this.g_aJR=[],this.g_aoU=g.g_aJS,s(this.g_aoU)&&this.g_aJF&&(console.warn("[C3 runtime] Worker mode is enabled and supported, but is disabled in WebViews due to crbug.com/923007. Reverting to DOM mode."),this.g_aJF=!1),this.g_aJT=!1,this.g_aJU=null,this.g_aJV=null,("html5"===this.g_aoU||"playable-ad"===this.g_aoU)&&"file"===location.protocol.substr(0,4)&&alert("Exported games won't work until you upload them. (When running on the file: protocol, browsers block many features from working for security reasons.)"),this.g_aJg("runtime","cordova-fetch-local-file",g=>this.g_aJW(g)),this.g_aJg("runtime","create-job-worker",g=>this.g_aJX(g)),"cordova"===this.g_aoU?document.addEventListener("deviceready",()=>this.g_acN(g)):this.g_acN(g)}g_ek(){this.g_arL(),this.g_aJH&&(this.g_aJH.onmessage=null,this.g_aJH=null),this.g_aJL&&(this.g_aJL.terminate(),this.g_aJL=null),this.g_aJM&&(this.g_aJM.g_ek(),this.g_aJM=null),this.g_amQ&&(this.g_amQ.parentElement.removeChild(this.g_amQ),this.g_amQ=null)}g_aJY(){return this.g_amQ}g_fe(){return this.g_aoP}g_aJd(){return this.g_aJF}g_asy(){return this.g_aoU}g_arl(){return a&&"cordova"===this.g_aoU}g_asz(){return a&&s(this.g_aoU)}async g_acN(g){if("playable-ad"===this.g_aoU){this.g_aJU=self.c3_base64files,this.g_aJV={},await this.g_aJZ();for(let a=0,e=g.g_aJ_.length;a<e;++a){const e=g.g_aJ_[a].toLowerCase();this.g_aJV.hasOwnProperty(e)?g.g_aJ_[a]={g_aJC:!0,g_C:this.g_aJV[e]}:this.g_aJU.hasOwnProperty(e)&&(g.g_aJ_[a]=URL.createObjectURL(this.g_aJU[e]))}}if(g.g_aJ$)this.g_aoP=g.g_aJ$;else{const g=location.origin;this.g_aoP=("null"===g?"file:///":g)+location.pathname;const a=this.g_aoP.lastIndexOf("/");-1!==a&&(this.g_aoP=this.g_aoP.substr(0,a+1))}if(g.g_aKa)for(const[a,e]of Object.entries(g.g_aKa))this.g_aJK[a]=URL.createObjectURL(e);const a=new MessageChannel;this.g_aJH=a.port1,this.g_aJH.onmessage=g=>this._OnMessageFromRuntime(g.data),window.c3_addPortMessageHandler&&window.c3_addPortMessageHandler(g=>this.g_aKb(g)),this.g_aqO=new self.g_aKc(this),await this.g_aqO.g_ajY(),this.g_aKd(),"object"==typeof window.StatusBar&&window.StatusBar.hide(),"object"==typeof window.AndroidFullScreen&&window.AndroidFullScreen.immersiveMode(),await this.g_aKe(),this.g_aJF?await this.g_aKf(g,a.port2):await this.g_aKg(g,a.port2)}g_aKh(g){return this.g_aJK.hasOwnProperty(g)?this.g_aJK[g]:g.endsWith("/workermain.js")&&this.g_aJK.hasOwnProperty("workermain.js")?this.g_aJK["workermain.js"]:"playable-ad"===this.g_aoU&&this.g_aJU.hasOwnProperty(g.toLowerCase())?URL.createObjectURL(this.g_aJU[g.toLowerCase()]):g}async g_aKi(g,a,_){if(g.startsWith("blob:"))return new Worker(g,_);if(this.g_arl()){const a=await this.g_BK(this.g_aJI+g),e=new Blob([a],{type:"application/javascript"});return new Worker(URL.createObjectURL(e),_)}const t=new URL(g,a),n=location.origin!==t.origin;if(n){const g=await fetch(t);if(!g.ok)throw new Error("failed to fetch worker script");const a=await g.blob();return new Worker(URL.createObjectURL(a),_)}return new Worker(t,_)}g_aKd(){if(this.g_asz()){const g=document.documentElement.style,a=document.body.style,_=window.innerWidth<window.innerHeight,t=_?window.screen.width:window.screen.height,n=_?window.screen.height:window.screen.width;a.height=g.height=n+"px",a.width=g.width=t+"px"}}g_aKj(g){return{baseUrl:this.g_aoP,windowInnerWidth:window.innerWidth,windowInnerHeight:window.innerHeight,devicePixelRatio:window.devicePixelRatio,isFullscreen:e.g_aoa(),projectData:g.g_aKk,previewImageBlobs:window.cr_previewImageBlobs||this.g_aJU,previewProjectFileBlobs:window.cr_previewProjectFileBlobs,exportType:g.g_aJS,isDebug:-1<self.location.search.indexOf("debug"),ife:!!self.g_aKl,jobScheduler:this.g_aqO.g_aKm(),supportedAudioFormats:d,opusWasmScriptUrl:window.cr_opusWasmScriptUrl||this.g_aJI+"opus.wasm.js",opusWasmBinaryUrl:window.cr_opusWasmBinaryUrl||this.g_aJI+"opus.wasm.wasm",isiOSCordova:this.g_arl(),isiOSWebView:this.g_asz(),isFBInstantAvailable:"undefined"!=typeof self.FBInstant}}async g_aKf(g,a){const e=this.g_aKh(g.g_aKn);this.g_aJL=await this.g_aKi(e,this.g_aoP,{name:"Runtime"}),this.g_amQ=document.createElement("canvas"),this.g_amQ.style.display="none";const _=this.g_amQ.transferControlToOffscreen();document.body.appendChild(this.g_amQ),window.c3canvas=this.g_amQ,this.g_aJL.postMessage(Object.assign(this.g_aKj(g),{type:"init-runtime",isInWorker:!0,messagePort:a,canvas:_,workerDependencyScripts:g.g_aKo||[],engineScripts:g.g_aJ_,projectScripts:window.g_aKp,projectScriptsStatus:self.C3_ProjectScriptsStatus}),[a,_,...this.g_aqO.g_aKq()]),this.g_aJN=i.map(g=>new g(this)),this.g_aKr(),self.c3_callFunction=(g,a)=>this.g_aJO.g_Vd(g,a),"preview"===this.g_aoU&&(self.goToLastErrorScript=()=>this.g_aI$("runtime","go-to-last-error-script"))}async g_aKg(a,g){this.g_amQ=document.createElement("canvas"),this.g_amQ.style.display="none",document.body.appendChild(this.g_amQ),window.c3canvas=this.g_amQ,this.g_aJN=i.map(g=>new g(this)),this.g_aKr();const t=a.g_aJ_.map(g=>"string"==typeof g?new URL(g,this.g_aoP).toString():g);if(Array.isArray(a.g_aKo)&&t.unshift(...a.g_aKo),await Promise.all(t.map(a=>_(a))),a.g_aKs&&0<a.g_aKs.length){const g=self.C3_ProjectScriptsStatus;try{if(await Promise.all(a.g_aKs.map(a=>_(a[1]))),Object.values(g).some(g=>!g))return void self.setTimeout(()=>this.g_aKt(g),100)}catch(e){return console.error("[Preview] Error loading project scripts: ",e),void self.setTimeout(()=>this.g_aKt(g),100)}}if("preview"===this.g_aoU&&"object"!=typeof self.g_aO.g_aIU)return console.error("[C3 runtime] Failed to load JavaScript code used in events. Check all your JavaScript code has valid syntax."),void alert("Failed to load JavaScript code used in events. Check all your JavaScript code has valid syntax.");const n=Object.assign(this.g_aKj(a),{isInWorker:!1,messagePort:g,canvas:this.g_amQ,runOnStartupFunctions:m});this.g_aJM=self.C3_CreateRuntime(n),await self.C3_InitRuntime(this.g_aJM,n)}g_aKt(g){const a=Object.entries(g).filter(g=>!g[1]).map(g=>g[0]),e=`Failed to load project script '${a[0]}'. Check all your JavaScript code has valid syntax.`;console.error("[Preview] "+e),alert(e)}async g_aJX(){const g=await this.g_aqO.g_aKu();return{outputPort:g,transferables:[g]}}g_aJe(){if(this.g_aJF)throw new Error("not available in worker mode");return this.g_aJM}g_aI$(g,a,_,t,n){this.g_aJH.postMessage({type:"event",component:g,handler:a,dispatchOpts:t||null,data:_,responseId:null},this.g_aJT?void 0:n)}g_aJb(_,a,t,n,i){const e=l++,o=new Promise((g,a)=>{h.set(e,{resolve:g,reject:a})});return this.g_aJH.postMessage({type:"event",component:_,handler:a,dispatchOpts:n||null,data:t,responseId:e},this.g_aJT?void 0:i),o}["_OnMessageFromRuntime"](g){const a=g.type;if("event"===a)this.g_aKv(g);else if("result"===a)this.g_aKw(g);else if("runtime-ready"===a)this.g_aKx();else if("alert"===a)alert(g.message);else throw new Error(`unknown message '${a}'`)}g_aKv(_){const t=_.component,n=_.handler,a=_.data,i=_.responseId,e=p.get(t);if(!e)return void console.warn(`[DOM] No event handlers for component '${t}'`);const o=e.get(n);if(!o)return void console.warn(`[DOM] No handler '${n}' for component '${t}'`);let g=null;try{g=o(a)}catch(g){return console.error(`Exception in '${t}' handler '${n}':`,g),void(null!==i&&this.g_aKy(i,!1,g.toString()))}null!==i&&(g&&g.then?g.then(g=>this.g_aKy(i,!0,g)).catch(g=>{console.error(`Rejection from '${t}' handler '${n}':`,g),this.g_aKy(i,!1,g.toString())}):this.g_aKy(i,!0,g))}g_aKy(g,a,e){let _;e&&e.transferables&&(_=e.transferables),this.g_aJH.postMessage({type:"result",responseId:g,isOk:a,result:e},_)}g_aKw(g){const a=g.responseId,_=g.isOk,t=g.result,n=h.get(a);_?n.resolve(t):n.reject(t),h.delete(a)}g_aJg(g,a,e){let _=p.get(g);if(_||(_=new Map,p.set(g,_)),_.has(a))throw new Error(`[DOM] Component '${g}' already has handler '${a}'`);_.set(a,e)}static g_aKz(g){if(i.includes(g))throw new Error("DOM handler already added");i.push(g)}g_aKr(){for(const g of this.g_aJN)if("runtime"===g.g_aJj())return void(this.g_aJO=g);throw new Error("cannot find runtime DOM handler")}g_aKb(g){this.g_aI$("debugger","message",g)}g_aKx(){for(const g of this.g_aJN)g.g_aIZ()}static g_aoa(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement)}async g_aKA(){return await this.g_aJb("runtime","get-remote-preview-status-info")}g_aJk(g){this.g_aJR.push(g),this.g_arK()}g_aJl(g){const a=this.g_aJR.indexOf(g);if(-1===a)throw new Error("invalid callback");this.g_aJR.splice(a,1),this.g_aJR.length||this.g_arL()}g_arK(){-1===this.g_anx&&this.g_aJR.length&&(this.g_anx=requestAnimationFrame(this.g_aJP))}g_arL(){-1!==this.g_anx&&(cancelAnimationFrame(this.g_anx),this.g_anx=-1)}g_aJQ(){this.g_anx=-1;for(const g of this.g_aJR)g();this.g_arK()}g_aKB(g){this.g_aJO.g_aKB(g)}g_aKC(g){this.g_aJO.g_aKC(g)}g_aKD(){this.g_aJO.g_aKD()}g_aHJ(g){this.g_aJO.g_aHJ(g)}g_Cf(g){return!!d[g]}async g_afT(g){const a=await this.g_aJb("runtime","opus-decode",{arrayBuffer:g},null,[g]);return new Float32Array(a)}g_fW(g){return /^(?:[a-z]+:)?\/\//.test(g)||"data:"===g.substr(0,5)||"blob:"===g.substr(0,5)}g_fX(g){return!this.g_fW(g)}async g_aJW(g){const a=g.filename;switch(g.as){case"text":return await this.g_BL(a);case"buffer":return await this.g_BK(a);default:throw new Error("unsupported type");}}g_aKE(){const g=window.cordova&&window.cordova.plugins&&window.cordova.plugins.permissions;if("object"!=typeof g)throw new Error("Permission API is not loaded");return g}g_aKF(g,a){const e=g[a];if("string"!=typeof e)throw new Error("Invalid permission name");return e}g_aKG(g){const a=this.g_aKE();return new Promise((e,_)=>a.checkPermission(this.g_aKF(a,g),g=>e(!!g.hasPermission),_))}g_aKH(g){const a=this.g_aKE();return new Promise((e,_)=>a.requestPermission(this.g_aKF(a,g),g=>e(!!g.hasPermission),_))}async g_aKI(g){if("cordova"!==this.g_asy())return!0;if(this.g_arl())return!0;for(const e of g){const g=await this.g_aKG(e);if(g)continue;const a=await this.g_aKH(e);if(!1===a)return!1}return!0}async g_aKJ(...g){if(!1===(await this.g_aKI(g)))throw new Error("Permission not granted")}g_aKK(g){const e=window.cordova.file.applicationDirectory+"www/"+g.toLowerCase();return new Promise((g,a)=>{window.resolveLocalFileSystemURL(e,e=>{e.file(g,a)},a)})}async g_BL(g){const a=await this.g_aKK(g);return await t(a)}g_aKL(){if(g.length&&!(8<=u)){u++;const e=g.shift();this.g_aKM(e.filename,e.g_aKN,e.g_aKO)}}g_BK(e){return new Promise((_,t)=>{g.push({filename:e,g_aKN:g=>{u--,this.g_aKL(),_(g)},g_aKO:g=>{u--,this.g_aKL(),t(g)}}),this.g_aKL()})}async g_aKM(g,a,e){try{const _=await this.g_aKK(g),t=await r(_);a(t)}catch(g){e(g)}}async g_aJZ(){const g=[];for(const[a,e]of Object.entries(this.g_aJU))g.push(this.g_aKP(a,e));await Promise.all(g)}async g_aKP(g,a){if("object"==typeof a)this.g_aJU[g]=new Blob([a.str],{type:a.type}),this.g_aJV[g]=a.str;else{let e=await this.g_aKQ(a);e||(e=this.g_aKR(a)),this.g_aJU[g]=e}}async g_aKQ(g){try{const a=await fetch(g);return await a.blob()}catch(g){return console.warn("Failed to fetch a data: URI. Falling back to a slower workaround. This is probably because the Content Security Policy unnecessarily blocked it. Allow data: URIs in your CSP to avoid this.",g),null}}g_aKR(g){const a=this.g_aKS(g);return this.g_aKT(a.data,a.g_gn)}g_aKS(_){const a=_.indexOf(",");if(0>a)throw new URIError("expected comma in data: uri");const t=_.substring(5,a),n=_.substring(a+1),o=t.split(";"),e=o[0]||"",r=o[1],g=o[2];let s;return s="base64"===r||"base64"===g?atob(n):decodeURIComponent(n),{g_gn:e,data:s}}g_aKT(_,a){let t,n,i=_.length,e=i>>2,o=new Uint8Array(i),g=new Uint32Array(o.buffer,0,e);for(t=0,n=0;t<e;++t)g[t]=_.charCodeAt(n++)|_.charCodeAt(n++)<<8|_.charCodeAt(n++)<<16|_.charCodeAt(n++)<<24;for(let g=3&i;g--;)o[n]=_.charCodeAt(n),++n;return new Blob([o],{type:a})}g_aKe(){let g=null;const e=new Promise(a=>g=a),_=new ArrayBuffer(1),t=new MessageChannel;return t.port2.onmessage=a=>{a.data&&a.data.arrayBuffer||(this.g_aJT=!0,console.warn("MessageChannel transfers determined to be broken. Disabling transferables.")),g()},t.port1.postMessage({arrayBuffer:_},[_]),e}}}{function _(g){return g.sourceCapabilities&&g.sourceCapabilities.firesTouchEvents||g.originalEvent&&g.originalEvent.sourceCapabilities&&g.originalEvent.sourceCapabilities.firesTouchEvents}function t(g){return new Promise((a,e)=>{const _=document.createElement("link");_.onload=()=>a(_),_.onerror=g=>e(g),_.rel="stylesheet",_.href=g,document.head.appendChild(_)})}function a(g){return new Promise((a,e)=>{const _=new Image;_.onload=()=>a(_),_.onerror=g=>e(g),_.src=g})}async function s(g){const e=URL.createObjectURL(g);try{return await a(e)}finally{URL.revokeObjectURL(e)}}function d(g){return new Promise((e,_)=>{let a=new FileReader;a.onload=g=>e(g.target.result),a.onerror=g=>_(g),a.readAsText(g)})}async function u(e,_,t){if(!/firefox/i.test(navigator.userAgent))return await s(e);let n=await d(e);const o=new DOMParser,g=o.parseFromString(n,"image/svg+xml"),r=g.documentElement;if(r.hasAttribute("width")&&r.hasAttribute("height")){const a=r.getAttribute("width"),g=r.getAttribute("height");if(!a.includes("%")&&!g.includes("%"))return await s(e)}r.setAttribute("width",_+"px"),r.setAttribute("height",t+"px");const i=new XMLSerializer;return n=i.serializeToString(g),e=new Blob([n],{type:"image/svg+xml"}),await s(e)}function e(g){do{if(g.parentNode&&g.hasAttribute("contenteditable"))return!0;g=g.parentNode}while(g);return!1}function g(g){const a=g.target.tagName.toLowerCase();o.has(a)&&g.preventDefault()}function h(g){(g.metaKey||g.ctrlKey)&&g.preventDefault()}function i(){try{return window.parent&&window.parent.document.hasFocus()}catch(g){return!1}}function c(){const g=document.activeElement;if(!g)return!1;const a=g.tagName.toLowerCase(),_=new Set(["email","number","password","search","tel","text","url"]);return"textarea"===a||("input"===a?_.has(g.type.toLowerCase()||"text"):e(g))}const U=new Map([["OSLeft","MetaLeft"],["OSRight","MetaRight"]]),l={dispatchRuntimeEvent:!0,dispatchUserScriptEvent:!0},m={dispatchUserScriptEvent:!0},n={dispatchRuntimeEvent:!0},o=new Set(["canvas","body","html"]);self.C3_GetSvgImageSize=async function(g){const e=await s(g);if(0<e.width&&0<e.height)return[e.width,e.height];else{e.style.position="absolute",e.style.left="0px",e.style.top="0px",e.style.visibility="hidden",document.body.appendChild(e);const g=e.getBoundingClientRect();return document.body.removeChild(e),[g.width,g.height]}},self.C3_RasterSvgImageBlob=async function(_,a,t,n,o){const e=await u(_,a,t),g=document.createElement("canvas");g.width=n,g.height=o;const r=g.getContext("2d");return r.drawImage(e,0,0,a,t),g};let p=!1;document.addEventListener("pause",()=>p=!0),document.addEventListener("resume",()=>p=!1);const f=class extends g_aIV{constructor(_){super(_,"runtime"),this.g_aKU=!0,this.g_aKV=-1,this.g_aKW="any",this.g_aKX=!1,this.g_aKY=!1,this.g_aKZ=null,this.g_aK_=null,this.g_aK$=null,_.g_aJg("canvas","update-size",g=>this.g_aLa(g)),_.g_aJg("runtime","invoke-download",g=>this.g_aLb(g)),_.g_aJg("runtime","raster-svg-image",g=>this.g_aLc(g)),_.g_aJg("runtime","get-svg-image-size",g=>this.g_aLd(g)),_.g_aJg("runtime","set-target-orientation",g=>this.g_aLe(g)),_.g_aJg("runtime","register-sw",()=>this.g_aLf()),_.g_aJg("runtime","post-to-debugger",g=>this.g_aLg(g)),_.g_aJg("runtime","go-to-script",g=>this.g_aLg(g)),_.g_aJg("runtime","before-start-ticking",()=>this.g_aLh()),_.g_aJg("runtime","debug-highlight",g=>this.g_aLi(g)),_.g_aJg("runtime","enable-device-orientation",()=>this.g_aLj()),_.g_aJg("runtime","enable-device-motion",()=>this.g_aLk()),_.g_aJg("runtime","add-stylesheet",g=>this.g_aLl(g));const t=new Set(["input","textarea","datalist"]);window.addEventListener("contextmenu",g=>{const a=g.target,_=a.tagName.toLowerCase();t.has(_)||e(a)||g.preventDefault()});const a=_.g_aJY();window.addEventListener("selectstart",g),window.addEventListener("gesturehold",g),a.addEventListener("selectstart",g),a.addEventListener("gesturehold",g),window.addEventListener("touchstart",g,{passive:!1}),"undefined"==typeof PointerEvent?a.addEventListener("touchstart",g):(window.addEventListener("pointerdown",g,{passive:!1}),a.addEventListener("pointerdown",g)),this.g_aLm=0,window.addEventListener("mousedown",g=>{1===g.button&&g.preventDefault()}),window.addEventListener("mousewheel",h,{passive:!1}),window.addEventListener("wheel",h,{passive:!1}),window.addEventListener("resize",()=>this.g_anO()),_.g_asz()&&window.addEventListener("focusout",()=>{c()||(document.scrollingElement.scrollTop=0)}),this.g_aLn=new Set,this.g_aLo=new WeakSet,this.g_aGS=!1}g_aLh(){return"cordova"===this.g_aqU.g_asy()?(document.addEventListener("pause",()=>this.g_aqQ(!0)),document.addEventListener("resume",()=>this.g_aqQ(!1))):document.addEventListener("visibilitychange",()=>this.g_aqQ(document.hidden)),{isSuspended:!!(document.hidden||p)}}g_aIZ(){window.addEventListener("focus",()=>this.g_aLp("window-focus")),window.addEventListener("blur",()=>{this.g_aLp("window-blur",{parentHasFocus:i()}),this.g_aLm=0}),window.addEventListener("fullscreenchange",()=>this.g_anP()),window.addEventListener("webkitfullscreenchange",()=>this.g_anP()),window.addEventListener("mozfullscreenchange",()=>this.g_anP()),window.addEventListener("fullscreenerror",g=>this.g_anQ(g)),window.addEventListener("webkitfullscreenerror",g=>this.g_anQ(g)),window.addEventListener("mozfullscreenerror",g=>this.g_anQ(g)),window.addEventListener("keydown",g=>this.g_aLq("keydown",g)),window.addEventListener("keyup",g=>this.g_aLq("keyup",g)),window.addEventListener("dblclick",g=>this.g_aLr("dblclick",g,l)),window.addEventListener("wheel",g=>this.g_aLs("wheel",g)),"undefined"==typeof PointerEvent?(window.addEventListener("mousedown",g=>this.g_aLt("pointerdown",g)),window.addEventListener("mousemove",g=>this.g_aLt("pointermove",g)),window.addEventListener("mouseup",g=>this.g_aLt("pointerup",g)),window.addEventListener("touchstart",g=>this.g_aLu("pointerdown",g)),window.addEventListener("touchmove",g=>this.g_aLu("pointermove",g)),window.addEventListener("touchend",g=>this.g_aLu("pointerup",g)),window.addEventListener("touchcancel",g=>this.g_aLu("pointercancel",g))):(window.addEventListener("pointerdown",g=>this.g_aLv("pointerdown",g)),this.g_aqU.g_aJd()&&"undefined"!=typeof window.onpointerrawupdate?(this.g_aK_=new g_mM(()=>this.g_aLw(),5),this.g_aK_.g_mW(!0),window.addEventListener("pointerrawupdate",g=>this.g_aLx(g))):window.addEventListener("pointermove",g=>this.g_aLv("pointermove",g)),window.addEventListener("pointerup",g=>this.g_aLv("pointerup",g)),window.addEventListener("pointercancel",g=>this.g_aLv("pointercancel",g)));const g=()=>this.g_aKD();window.addEventListener("pointerup",g,!0),window.addEventListener("touchend",g,!0),window.addEventListener("click",g,!0),window.addEventListener("keydown",g,!0),window.addEventListener("gamepadconnected",g,!0)}g_aLp(g,a){this.g_aI_(g,a||null,n)}g_aLy(){return Math.max(window.innerWidth,1)}g_aLz(){return Math.max(window.innerHeight,1)}g_anO(){const g=this.g_aLy(),a=this.g_aLz();this.g_aLp("window-resize",{innerWidth:g,innerHeight:a,devicePixelRatio:window.devicePixelRatio}),this.g_aqU.g_asz()&&(-1!==this.g_aKV&&clearTimeout(this.g_aKV),this.g_aLA(g,a,0))}g_aLB(g,a,e){-1!==this.g_aKV&&clearTimeout(this.g_aKV),this.g_aKV=setTimeout(()=>this.g_aLA(g,a,e),48)}g_aLA(g,a,_){const t=this.g_aLy(),n=this.g_aLz();this.g_aKV=-1,t!=g||n!=a?this.g_aLp("window-resize",{innerWidth:t,innerHeight:n,devicePixelRatio:window.devicePixelRatio}):10>_&&this.g_aLB(t,n,_+1)}g_aLe(g){this.g_aKW=g.targetOrientation}g_aLC(){const g=this.g_aKW;if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(g).catch(g=>console.warn("[Construct 3] Failed to lock orientation: ",g));else try{let a=!1;screen.lockOrientation?a=screen.lockOrientation(g):screen.webkitLockOrientation?a=screen.webkitLockOrientation(g):screen.mozLockOrientation?a=screen.mozLockOrientation(g):screen.msLockOrientation&&(a=screen.msLockOrientation(g)),a||console.warn("[Construct 3] Failed to lock orientation")}catch(g){console.warn("[Construct 3] Failed to lock orientation: ",g)}}g_anP(){const g=g_aJE.g_aoa();g&&"any"!==this.g_aKW&&this.g_aLC(),this.g_aI_("fullscreenchange",{isFullscreen:g,innerWidth:this.g_aLy(),innerHeight:this.g_aLz()})}g_anQ(g){console.warn("[Construct 3] Fullscreen request failed: ",g),this.g_aI_("fullscreenerror",{isFullscreen:g_aJE.g_aoa(),innerWidth:this.g_aLy(),innerHeight:this.g_aLz()})}g_aqQ(g){g?this.g_aqU.g_arL():this.g_aqU.g_arK(),this.g_aI_("visibilitychange",{hidden:g})}g_aLq(e,a){"Backspace"===a.key&&g(a);const _=U.get(a.code)||a.code;this.g_aJc(e,{code:_,key:a.key,which:a.which,repeat:a.repeat,altKey:a.altKey,ctrlKey:a.ctrlKey,metaKey:a.metaKey,shiftKey:a.shiftKey,timeStamp:a.timeStamp},l)}g_aLs(g,a){this.g_aI_(g,{clientX:a.clientX,clientY:a.clientY,deltaX:a.deltaX,deltaY:a.deltaY,deltaZ:a.deltaZ,deltaMode:a.deltaMode,timeStamp:a.timeStamp},l)}g_aLr(a,g,e){_(g)||("mousedown"===a&&window!==window.top&&window.focus(),this.g_aJc(a,{button:g.button,buttons:g.buttons,clientX:g.clientX,clientY:g.clientY,timeStamp:g.timeStamp},e))}g_aLt(a,g){if(!_(g)){"pointerdown"===a&&window!==window.top&&window.focus();const e=this.g_aLm;"pointerdown"===a&&0!==e?a="pointermove":"pointerup"==a&&0!==g.buttons&&(a="pointermove"),this.g_aJc(a,{pointerId:1,pointerType:"mouse",button:g.button,buttons:g.buttons,lastButtons:e,clientX:g.clientX,clientY:g.clientY,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,timeStamp:g.timeStamp},l),this.g_aLm=g.buttons,this.g_aLr(g.type,g,m)}}g_aLv(g,a){"pointerdown"===g&&window!==window.top&&window.focus(),this.g_aK_&&"pointermove"!==g&&this.g_aK_.g_lz();let e=0;if("mouse"===a.pointerType&&(e=this.g_aLm),this.g_aJc(g,{pointerId:a.pointerId,pointerType:a.pointerType,button:a.button,buttons:a.buttons,lastButtons:e,clientX:a.clientX,clientY:a.clientY,width:a.width||0,height:a.height||0,pressure:a.pressure||0,tangentialPressure:a.tangentialPressure||0,tiltX:a.tiltX||0,tiltY:a.tiltY||0,twist:a.twist||0,timeStamp:a.timeStamp},l),"mouse"===a.pointerType){let e="mousemove";"pointerdown"===g?e="mousedown":"pointerup"==g&&(e="pointerup"),this.g_aLr(e,a,m),this.g_aLm=a.buttons}}g_aLx(g){this.g_aK$=g,this.g_aK_.g_m_()}g_aLw(){this.g_aLv("pointermove",this.g_aK$),this.g_aK$=null}g_aLu(g,a){"pointerdown"===g&&window!==window.top&&window.focus();for(let e=0,_=a.changedTouches.length;e<_;++e){const _=a.changedTouches[e];this.g_aJc(g,{pointerId:_.identifier,pointerType:"touch",button:0,buttons:0,lastButtons:0,clientX:_.clientX,clientY:_.clientY,width:2*(_.radiusX||_.webkitRadiusX||0),height:2*(_.radiusY||_.webkitRadiusY||0),pressure:_.force||_.webkitForce||0,tangentialPressure:0,tiltX:0,tiltY:0,twist:_.rotationAngle||0,timeStamp:a.timeStamp},l)}}g_aLj(){this.g_aKX||(this.g_aKX=!0,window.addEventListener("deviceorientation",g=>this.g_aLD(g)))}g_aLk(){this.g_aKY||(this.g_aKY=!0,window.addEventListener("devicemotion",g=>this.g_aLE(g)))}g_aLD(g){this.g_aI_("deviceorientation",{alpha:g.alpha||0,beta:g.beta||0,gamma:g.gamma||0,timeStamp:g.timeStamp},l)}g_aLE(_){let a=null;const t=_.acceleration;t&&(a={x:t.x||0,y:t.y||0,z:t.z||0});let n=null;const i=_.accelerationIncludingGravity;i&&(n={x:i.x||0,y:i.y||0,z:i.z||0});let e=null;const o=_.rotationRate;o&&(e={alpha:o.alpha||0,beta:o.beta||0,gamma:o.gamma||0}),this.g_aI_("devicemotion",{acceleration:a,accelerationIncludingGravity:n,rotationRate:e,interval:_.interval,timeStamp:_.timeStamp},l)}g_aLa(g){const a=this.g_aJi(),e=a.g_aJY();e.style.width=g.styleWidth+"px",e.style.height=g.styleHeight+"px",e.style.marginLeft=g.marginLeft+"px",e.style.marginTop=g.marginTop+"px",a.g_aKd(),this.g_aKU&&(e.style.display="",this.g_aKU=!1)}g_aLb(g){const _=g.url,t=g.filename,n=document.createElement("a"),e=document.body;n.textContent=t,n.href=_,n.download=t,e.appendChild(n),n.click(),e.removeChild(n)}async g_aLc(_){const a=_.blob,t=_.imageWidth,n=_.imageHeight,o=_.surfaceWidth,e=_.surfaceHeight,r=_.imageBitmapOpts,g=await self.C3_RasterSvgImageBlob(a,t,n,o,e);let s;return s=r?await createImageBitmap(g,r):await createImageBitmap(g),{imageBitmap:s,transferables:[s]}}async g_aLd(g){return await self.C3_GetSvgImageSize(g.blob)}async g_aLl(g){await t(g.url)}g_aKD(){const g=[...this.g_aLn];if(this.g_aLn.clear(),!this.g_aGS)for(const e of g){const g=e.play();g&&g.catch(()=>{this.g_aLo.has(e)||this.g_aLn.add(e)})}}g_aKB(g){if("function"!=typeof g.play)throw new Error("missing play function");this.g_aLo.delete(g);let a;try{a=g.play()}catch(a){return void this.g_aLn.add(g)}a&&a.catch(()=>{this.g_aLo.has(g)||this.g_aLn.add(g)})}g_aKC(g){this.g_aLn.delete(g),this.g_aLo.add(g)}g_aHJ(g){this.g_aGS=!!g}g_aLi(g){const a=g.show;if(!a)return void(this.g_aKZ&&(this.g_aKZ.style.display="none"));this.g_aKZ||(this.g_aKZ=document.createElement("div"),this.g_aKZ.id="inspectOutline",document.body.appendChild(this.g_aKZ));const e=this.g_aKZ;e.style.display="",e.style.left=g.left-1+"px",e.style.top=g.top-1+"px",e.style.width=g.width+2+"px",e.style.height=g.height+2+"px",e.textContent=g.name}g_aLf(){window.C3_RegisterSW&&window.C3_RegisterSW()}g_aLg(g){window.c3_postToMessagePort&&(g.from="runtime",window.c3_postToMessagePort(g))}g_Vd(g,a){return this.g_aJa("js-invoke-function",{name:g,params:a})}};g_aJE.g_aKz(f)}{const g=document.currentScript.src;self.g_aKc=class{constructor(a){this.g_aLF=a,this.g_aoP=g?g.substr(0,g.lastIndexOf("/")+1):a.g_fe(),this.g_atf=Math.min(navigator.hardwareConcurrency||2,16),this.g_aLG=null,this.g_aLH=[],this.g_atd=null,this.g_aLI=null}async g_ajY(){if(this.g_aLJ)throw new Error("already initialised");this.g_aLJ=!0;const g=this.g_aLF.g_aKh("dispatchworker.js");this.g_aLG=await this.g_aLF.g_aKi(g,this.g_aoP,{name:"DispatchWorker"});const a=new MessageChannel;this.g_atd=a.port1,this.g_aLG.postMessage({type:"_init","in-port":a.port2},[a.port2]),this.g_aLI=await this.g_aKu()}async g_aKu(){const g=this.g_aLH.length,a=this.g_aLF.g_aKh("jobworker.js"),_=await this.g_aLF.g_aKi(a,this.g_aoP,{name:"JobWorker"+g}),t=new MessageChannel,n=new MessageChannel;return this.g_aLG.postMessage({type:"_addJobWorker",port:t.port1},[t.port1]),_.postMessage({type:"init",number:g,"dispatch-port":t.port2,"output-port":n.port2},[t.port2,n.port2]),this.g_aLH.push(_),n.port1}g_aKm(){return{inputPort:this.g_atd,outputPort:this.g_aLI,maxNumWorkers:this.g_atf}}g_aKq(){return[this.g_atd,this.g_aLI]}}}if("use strict",window.C3_IsSupported){"undefined"!=typeof OffscreenCanvas;window.c3_runtimeInterface=new g_aJE({g_aJG:!1,g_aKn:"workermain.js",g_aJ_:["scripts/c3runtime.js"],g_aJJ:"scripts/",g_aKo:[],g_aJS:"html5"})}{function g(g){g.stopPropagation()}function a(g){13!==g.which&&27!==g.which&&g.stopPropagation()}const e=class extends g_aJm{constructor(g){super(g,"text-input"),this.g_aJw("scroll-to-bottom",g=>this.g_aLK(g))}g_aex(_,t){let n;const i=t.type;return"textarea"===i?(n=document.createElement("textarea"),n.style.resize="none"):(n=document.createElement("input"),n.type=i),n.style.position="absolute",n.autocomplete="off",n.addEventListener("touchstart",g),n.addEventListener("touchmove",g),n.addEventListener("touchend",g),n.addEventListener("mousedown",g),n.addEventListener("mouseup",g),n.addEventListener("keydown",a),n.addEventListener("keyup",a),n.addEventListener("click",g=>{g.stopPropagation(),this.g_aJz("click",_)}),n.addEventListener("dblclick",g=>{g.stopPropagation(),this.g_aJz("dblclick",_)}),n.addEventListener("input",()=>this.g_aJy("change",_,{text:n.value})),n.id=t.id,this.g_aJA(n,t),n}g_aJA(g,a){g.value=a.text,g.placeholder=a.placeholder,g.title=a.title,g.disabled=!a.isEnabled,g.readOnly=a.isReadOnly,g.spellcheck=a.spellCheck}g_aLK(g){g.scrollTop=g.scrollHeight}};g_aJE.g_aKz(e)}{function g(g){g.stopPropagation()}const a=class extends g_aJm{constructor(g){super(g,"button")}g_aex(a,_){const t=document.createElement("input"),n=_.isCheckbox;let e=t;if(n){t.type="checkbox";const g=document.createElement("label");g.appendChild(t),g.appendChild(document.createTextNode("")),g.style.fontFamily="sans-serif",g.style.userSelect="none",g.style.webkitUserSelect="none",g.style.display="inline-block",g.style.color="black",e=g}else t.type="button";return e.style.position="absolute",e.addEventListener("touchstart",g),e.addEventListener("touchmove",g),e.addEventListener("touchend",g),e.addEventListener("mousedown",g),e.addEventListener("mouseup",g),e.addEventListener("keydown",g),e.addEventListener("keyup",g),t.addEventListener("click",()=>this.g_aJz("click",a,{isChecked:t.checked})),t.id=_.id,this.g_aJA(e,_),e}g_aLL(g){return"input"===g.tagName.toLowerCase()?g:g.firstChild}g_aJA(g,a){const e=this.g_aLL(g);e.checked=a.isChecked,e.disabled=!a.isEnabled,g.title=a.title,g===e?e.value=a.text:g.lastChild.textContent=a.text}};g_aJE.g_aKz(a)}{function _(g){g.stopPropagation()}const a=class extends g_aJm{constructor(g){super(g,"list"),this.g_aJw("set-selected-index",(g,a)=>this.g_aLM(g,a.selectedIndex)),this.g_aJw("add-item",(g,a)=>this.g_aLN(g,a)),this.g_aJw("remove-item",(g,a)=>this.g_aLO(g,a)),this.g_aJw("set-item",(g,a)=>this.g_aLP(g,a)),this.g_aJw("clear",g=>this.g_aLQ(g)),this.g_aJw("load-state",(g,a)=>this.g_aLR(g,a))}g_aex(t,a){const n=a.isDropdown,i=a.isMultiSelect,e=a.items,o=document.createElement("select");o.style.position="absolute",o.style.userSelect="none",o.style.webkitUserSelect="none",o.multiple=i,n||(o.size=2);for(const g of e)o.add(this.g_aLS(g));return o.addEventListener("touchstart",_),o.addEventListener("touchmove",_),o.addEventListener("touchend",_),o.addEventListener("mousedown",_),o.addEventListener("mouseup",_),o.addEventListener("click",g=>{g.stopPropagation(),this.g_aJz("click",t,this.g_aLT(o))}),o.addEventListener("dblclick",g=>{g.stopPropagation(),this.g_aJz("dblclick",t,this.g_aLT(o))}),o.addEventListener("change",()=>this.g_aJy("change",t,this.g_aLT(o))),o.id=a.id,this.g_aJA(o,a),o}g_aLS(g){const a=document.createElement("option");return a.text=g,a}g_aLT(g){const a=g.selectedIndex,e=[];for(let a=0,_=g.length;a<_;++a)g.options[a].selected&&e.push(a);return{selectedIndex:a,selectedIndices:e}}g_aJA(g,a){g.title=a.title,g.disabled=!a.isEnabled,g.multiple=!!a.isMultiSelect}g_aLM(g,a){g.selectedIndex=a}g_aLN(g,a){const _=a.text,t=a.index,n=this.g_aLS(_);0>t?g.add(n):g.add(n,t)}g_aLO(g,a){g.remove(a.index)}g_aLP(g,a){g.options[a.index].text=a.text}g_aLQ(g){g.innerHTML=""}g_aLR(g,a){g.innerHTML="";for(const e of a.items)g.add(this.g_aLS(e));g.selectedIndex=a.selectedIndex;for(const e of a.selectedIndices){const a=g.options[e];a&&(a.selected=!0)}}};g_aJE.g_aKz(a)}{function _(a){return a%=d,0>a&&(a+=d),a}function t(g,e,_){return g<e?e:g>_?_:g}function n(g,e,a){return g+a*(e-g)}function o(g,e,a){return g===e?0:(a-g)/(e-g)}function r(_,a){var t=Math.cos,n=Math.sin;if(_===a)return 0;const o=n(_),e=t(_),r=n(a),g=t(a),s=o*r+e*g;return 1<=s?0:-1>=s?Math.PI:Math.acos(s)}function e(_,a){var t=Math.cos,n=Math.sin;const i=n(_),e=t(_),o=n(a),g=t(a);return 0>=e*o-i*g}function s(t,n,a){const i=r(t,n);return e(n,t)?_(t+i*a):_(t-i*a)}const g=[],d=2*Math.PI;class u{constructor(g,a,_,t,n,e){this.g_Di=g,this.g_aLU=a,this.g_aLV=_,this.g_aLW=t,this.g_aLX=n,this.g_aLY=e}g_aLZ(){return{tag:this.g_aLW,interp:this.g_aLU,userData:this.g_aLX,cvt:this.g_aLY}}g_ED(){return this.g_Di}g_aBu(){return this.g_aLU}g_aL_(){return this.g_aLV}g_aL$(){return this.g_aLW}g_aMa(){return"undefined"!=typeof this.g_aLX}g_aMb(){return this.g_aLX}g_aMc(){return this.g_aLY}g_aMd(a){switch(this.g_aLV){case 0:return a;case 1:return Math.fround(a);case 2:return 2===this.g_aLU&&(a=_(a),a/=Math.PI,a-=1,a*=32767),t(0|a,-32768,32767);case 3:return 2===this.g_aLU&&(a=_(a),a/=d,a*=255),t(0|a,0,255);default:return a;}}g_aMe(g,a,e){switch(this.g_aLV){case 0:g.setFloat64(a,e),a+=8;break;case 1:g.setFloat32(a,e),a+=4;break;case 2:g.setInt16(a,e),a+=2;break;case 3:g.setUint8(a,e),a+=1;break;default:g.setFloat32(a,e),a+=4;}return a}g_aMf(g){return 2===this.g_aLU?2===this.g_aLV?(g/=32767,g+=1,g*=Math.PI,g):3===this.g_aLV?(g/=255,g*=d,g):g:g}static g_aMg(g,a,_,t,e){return 0===g?e?_:a:1===g?n(a,_,t):2===g?s(a,_,t):e?_:a}}class i{constructor(g,a){this.timestamp=g,this.data=a}}class p{constructor(g,a,e){this.g_aMh=g,this.g_aMi=g.g_aMj(),this.g_Ro=a,this.g_aMk=e,this._data=[],this._data.length=this.g_aMh.g_aMl().length,this.g_aMm=0,this.g_aMn=0,this.g_aMo=!1,this.g_aMp=!1,this.g_aMq=[],this.g_aMr=null,this.g_aMs=null,this.g_aMt=null}g_aLZ(){const g=[];for(let a=0,e=this.g_aMh.g_aMl().length;a<e;++a)g.push(this.g_aBu(this.g_aMh.g_aMu(),a));const a={id:this.g_Ro,nid:this.g_aMk,isTimedOut:this.g_aMv(),interpValues:g,latestUpdate:null},e=this.g_aMw();return e&&(a.latestUpdate={timestamp:e.timestamp,data:e.data}),a}g_LJ(){return this.g_Ro}g_aMx(){return this.g_aMk}g_aMy(a){this.g_aMp=!!a}g_aMz(){return this.g_aMp}g_aMA(){return this.g_aMo}g_aMB(_,t){const n=_.netValues,i=this.g_aMh.g_aMl(),a=i.length;this.g_aMo=!1;for(let g=0;g<a;++g){const _=i[g],a=_.g_aMd(n[g]);this._data[g]!==a&&(this._data[g]=a,this.g_aMm=t,this.g_aMh.g_aMC(t))}const e=t-this.g_aMm,o=t-this.g_aMn,g=this.g_aMh.g_aMD();this.g_aMo=!!(100>e&&0===g)||(1e3>e&&1>=g?95<=o:495<=o),this.g_aMo&&this.g_aMh.g_aME()}g_aMF(g,a,e){const _=this.g_aMh.g_aMl();this.g_aMn=e,g.setUint16(a,this.g_aMk),a+=2;for(let t=0,n=this._data.length;t<n;++t)a=_[t].g_aMe(g,a,this._data[t]);return a}g_aMG(g,a){for(let e=0,_=this.g_aMq.length;e<_;++e){const _=this.g_aMq[e];if(_.timestamp===g)return;if(_.timestamp>g)return void this.g_aMq.splice(e,0,new i(g,a))}this.g_aMq.push(new i(g,a))}g_aMv(){return 0!==this.g_aMq.length&&this.g_aMq[this.g_aMq.length-1].timestamp<this.g_aMh.g_aMu()-3e3}g_KM(){for(;2<this.g_aMq.length&&this.g_aMq[0]!==this.g_aMr&&this.g_aMq[0]!==this.g_aMs&&this.g_aMq[0]!==this.g_aMt;)this.g_aMq.shift();const g=this.g_aMh.g_aMu();if(!(this.g_aMt&&this.g_aMt.timestamp>g&&this.g_aMs&&this.g_aMs.timestamp<g)){this.g_aMt=null;for(let a=0,e=this.g_aMq.length;a<e;++a){const e=this.g_aMq[a];if(e.timestamp<=g)(!this.g_aMs||e.timestamp>this.g_aMs.timestamp)&&(this.g_aMr=this.g_aMs,this.g_aMs=e);else{this.g_aMt=e;break}}}}g_aMw(){return 0===this.g_aMq.length?null:this.g_aMq[this.g_aMq.length-1]}g_aBu(_,a,t){if(!this.g_aMt&&!this.g_aMs)return 0;if(this.g_aMt&&!this.g_aMs)return this.g_aMt.data[a];const n=this.g_aMh.g_aMl();let e,r,s,d,l;if(!this.g_aMt&&this.g_aMs){if(this.g_aMr&&!t){e=this.g_aMr.timestamp,r=this.g_aMr.data[a],s=this.g_aMs.timestamp,d=this.g_aMs.data[a];let g=_;return g>this.g_aMs.timestamp+this.g_aMh.g_aMH()&&(g=this.g_aMs.timestamp+this.g_aMh.g_aMH()),l=o(e,s,g),u.g_aMg(n[a].g_aBu(),r,d,l,!0)}return this.g_aMs.data[a]}return e=this.g_aMs.timestamp,r=this.g_aMs.data[a],s=this.g_aMt.timestamp,d=this.g_aMt.data[a],l=o(e,s,_),u.g_aMg(n[a].g_aBu(),r,d,l,!1)}}self.g_aMI=u,self.g_aMJ=i,self.g_aMK=class{constructor(g,a,e,_){switch(this.g_aMi=g,this.g_aML=a,this.g_Dj=e,this.g_aMk=this.g_aMi.g_aMM(),this.g_aMN=_,this.g_aLX={},this.g_aMO=0,this.g_aMP=250,this.g_aMN){case 1:this.g_aMP=500;break;case 2:this.g_aMP=2500;}this.g_aMQ=[],this.g_aMR=[],this.g_aMS=new Map,this.g_aMT=new Set,this.g_aMU=0,this.g_aMm=0,this.g_aMn=0,this.g_aMV=0,this.g_aMW=!1,this.g_aMX=[],this.g_aMY=new Map,this.g_aMZ=new Map,this.g_az_=0,this.g_aMi.g_aM_(this)}g_aMj(){return this.g_aMi}g_aMl(){return this.g_aMQ}g_aM$(){return this.g_aML}g_aNa(g){this.g_aMk=g}g_aMx(){return this.g_aMk}g_aMC(g){this.g_aMm=g}g_aMD(){return this.g_aMN}g_aME(){this.g_aMV++}g_aNb(){return this.g_aMV}g_aMu(){return this.g_az_}g_aNc(g){this.g_aMW=!!g}g_aNd(){return this.g_aMW}g_aMH(){return this.g_aMP}g_aNe(){return this.g_Dj}g_aNf(){return this.g_aMX}g_aNg(g,a,_,t,n){const e=new u(this.g_aMQ.length,g,a,_,t,n);0===a?this.g_aMO+=8:1===a?this.g_aMO+=4:2===a?this.g_aMO+=2:3===a?this.g_aMO+=1:void 0,this.g_aMQ.push(e)}g_aMG(g,a,e){const _=this.g_aNh(a);_.g_aMG(g,e)}g_KM(){this.g_az_=this.g_aMi.g_aNi();for(const g of this.g_aMR)g.g_KM()}g_aNj(){return this.g_aMR.length}g_aNk(g){return g=Math.floor(g),0>g||g>=this.g_aMR.length?null:this.g_aMR[g]}g_aNl(g){for(const a of this.g_aMR)if(a.g_aMx()===g)return a;return null}g_aNm(){const g=[];for(const a of this.g_aMQ){const e={tag:a.g_aL$(),precision:a.g_aL_(),interp:a.g_aBu(),clientvaluetag:a.g_aMc()};a.g_aMa()&&(e.userdata=a.g_aMb()),g.push(e)}return g}g_aNn(g){this.g_aMQ.length=0,this.g_aMO=0;for(const a of g)this.g_aNg(a.interp,a.precision,a.tag,a.userdata,a.clientvaluetag)}g_aNh(g){let a=this.g_aMZ.get(g);return a?a:(a=new p(this,-1,g),this.g_aMZ.set(g,a),this.g_aMR.push(a),a)}g_aNo(g){let a=this.g_aMS.get(g);return a?a:(a=new p(this,g,this.g_aNp()),this.g_aMS.set(g,a),this.g_aMR.push(a),a)}g_aNp(){do this.g_aMU++,65535<this.g_aMU&&(this.g_aMU=0);while(this.g_aMT.has(this.g_aMU));const g=this.g_aMU;return this.g_aMT.add(g),g}g_aNq(g){const a=g.g_LJ(),e=g.g_aMx();this.g_aMi.g_aAF()&&!this.g_aMW&&this.g_aMX.push(e),this.g_aMS.delete(a),this.g_aMZ.delete(e),this.g_aMT.delete(e);const _=this.g_aMR.indexOf(g);-1<_&&this.g_aMR.splice(_,1)}g_aMB(_,a){this.g_aMV=0;for(const g of this.g_aMR)g.g_aMy(!1);for(let g=0,e=_.length;g<e;++g){const t=_[g],e=t.uid,n=this.g_aNo(e);n.g_aMy(!0),n.g_aMB(t,a)}for(const e of this.g_aMR)e.g_aMz()||g.push(e);for(const e of g)this.g_aNq(e);g.length=0}g_aMF(g,a,e){g.setUint16(a,this.g_aMk),a+=2;let _=0;this.g_aMW&&(_=1),g.setUint8(a,_),a+=1,g.setUint16(a,this.g_aMV),a+=2,g.setUint16(a,this.g_aMO),a+=2;for(const _ of this.g_aMR)_.g_aMA()&&(a=_.g_aMF(g,a,e));return a}g_aNr(g,a){if(this.g_aMS.has(g))return void console.warn("OverrideNid passed id "+g+" which is already in use and cannot be overridden");if(this.g_aMT.has(a))return void console.warn("OverrideNid passed nid "+a+" which is already in use and cannot be overridden");const e=new p(this,g,a);return this.g_aMS.set(g,e),this.g_aMT.add(a),this.g_aMR.push(e),this.g_aMW=!0,e}g_aNs(g){const a=this.g_aMS.get(g);a&&this.g_aNq(a)}g_aNt(g){const a=this.g_aMZ.get(g);a&&this.g_aNq(a)}g_aLZ(){return{hasOverriddenNids:this.g_aNd(),netValues:this.g_aMQ.map(g=>g.g_aLZ()),netInstances:this.g_aMR.map(g=>g.g_aLZ())}}g_aNu(){return{roId:this.g_aML,sid:this.g_Dj,netValues:this.g_aMQ.map(g=>g.g_aLZ())}}}}{function g(g){if(g)try{g.close()}catch(g){}}function _(g,e,a){return g===e?0:(a-g)/(e-g)}const t=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection||window.msRTCPeerConnection,n=[];class i{constructor(g,a,e){this.g_aMi=g,this.g_Ro=a,this.g_aMk=0,this.g_aNv=e,this.g_aNw=null,this.g_aNx=null,this.g_aNy=!1,this.g_aNz=null,this.g_aNA=!1,this.g_aNB=null,this.g_aNC=!1,this.g_aND=!1,this.g_aNE=!1,this.g_aNF=!1,this.g_aNG=!1,this.g_aNH=0,this.g_aNI=0,this.g_aNJ=0,this.g_aNK=[],this.g_aNL=0,this.g_aNM=0,this.g_aNN=[],this.g_aMr=null,this.g_aMs=null,this.g_aMt=null,this.g_aNO=0,this.g_aNP=!1,this.g_aNQ=1,this.g_aNR=[],this.g_aNS=0,this.g_aNT=0,this.g_aMi.g_aNU(this)}g_LJ(){return this.g_Ro}g_aMx(){return this.g_aMk}g_aNa(g){this.g_aMk=g}g_aNV(){return this.g_aNv}g_aAF(){return this===this.g_aMi.g_aNW()}g_aNX(){return this===this.g_aMi.g_aNY()}g_aNZ(){return this.g_aNK}g_aN_(g){this.g_aNL=g}g_aN$(){return this.g_aNL}g_aOa(g){this.g_aNM=g}g_aOb(){return this.g_aNM}g_aOc(){return this.g_aNS}g_aOd(){return this.g_aNT}g_aOe(g,e){g.binaryType="arraybuffer",g.onopen=()=>{"o"===e?this.g_aNy=!0:"r"===e?this.g_aNA=!0:"u"==e&&(this.g_aNC=!0),this.g_aOf()},g.onmessage=g=>{this.g_aOg(e,g)},g.onerror=g=>{console.error("Peer '"+this.g_Ro+"' datachannel '"+e+"' error: ",g),this.g_aMi.g_aOh(this,g),this.g_aMi.g_aAF()&&!this.g_aAF()&&this.g_lL("network error")},g.onclose=()=>{this.g_lL("disconnect")}}g_aOi(){if(this.g_aNX())return;const g=this.g_aMi.g_aAF();this.g_aNy=!1,this.g_aNA=!1,this.g_aNC=!1,this.g_aND=!1,this.g_aNE=!1,this.g_aNI=performance.now(),this.g_aNw=new t({iceServers:this.g_aMi.g_aOj()}),this.g_aNw.onicecandidate=g=>{g.candidate&&this.g_aMi.g_aOk({message:"icecandidate",toclientid:this.g_Ro,icecandidate:g.candidate})},this.g_aNw.onsignalingstatechange=()=>{this.g_aNw&&("closed"!==this.g_aNw.signalingState||this.g_lL("disconnect"))},this.g_aNw.oniceconnectionstatechange=()=>{this.g_aNw&&("failed"!==this.g_aNw.iceConnectionState&&"closed"!==this.g_aNw.iceConnectionState||this.g_lL("disconnect"))},this.g_aNw.onconnectionstatechange=()=>{if(this.g_aNw){const g=this.g_aNw.connectionState;("failed"===g||"closed"===g)&&this.g_lL("disconnect")}};const e=`c2mp_${this.g_aMi.g_aOl()}_${this.g_aMi.g_aOm()}_${this.g_aMi.g_aOn()}`;g?(this.g_aMk=this.g_aMi.g_aOo(),this.g_aNx=this.g_aNw.createDataChannel("o",{ordered:!0,protocol:e}),this.g_aOe(this.g_aNx,"o"),this.g_aNz=this.g_aNw.createDataChannel("r",{ordered:!1,protocol:e}),this.g_aOe(this.g_aNz,"r"),this.g_aNB=this.g_aNw.createDataChannel("u",{ordered:!1,g_aOp:0,protocol:e}),this.g_aOe(this.g_aNB,"u"),this.g_aNw.createOffer().then(g=>{this.g_aNw.setLocalDescription(g),this.g_aMi.g_aOk({message:"offer",toclientid:this.g_Ro,offer:g})}).catch(g=>{console.error("Host error creating offer for peer '"+this.g_Ro+"': ",g),this.g_aMi.g_aOh(this,"could not create offer for peer")})):this.g_aNw.ondatachannel=g=>{if(g.channel.protocol!==e)return console.error("Unexpected datachannel protocol '"+g.channel.protocol+"', should be '"+g_aOq+"'"),void this.g_aMi.g_aOh(this,"unexpected datachannel protocol '"+g.channel.protocol+"', should be '"+g_aOq+"'");const a=g.channel.label;"o"===a?this.g_aNx=g.channel:"r"===a?this.g_aNz=g.channel:"u"===a?this.g_aNB=g.channel:(console.error("Unknown datachannel label: "+g.channel.label),this.g_aMi.g_aOh(this,"unknown datachannel label '"+g.channel.label+"'")),this.g_aOe(g.channel,a)}}async g_aOr(g){if(this.g_aNw)try{await this.g_aNw.addIceCandidate(g)}catch(g){console.warn("[Multiplayer] Error adding ICE candidate: ",g)}}g_aOs(){return!!this.g_aNw}g_aOt(){return this.g_aNw}g_aOf(){this.g_aND||this.g_aNA&&this.g_aNC&&this.g_aNy&&(this.g_aOu(),this.g_aND=!0,this.g_aNE=!1)}g_aOu(){if(this.g_aNH=performance.now(),this.g_aMi.g_aAF()){this.g_aMi.g_aOv("o",JSON.stringify({c:"j",i:this.g_Ro,n:this.g_aMk,a:this.g_aNv}),this),this.g_aOw("o",JSON.stringify({c:"hi",hn:this.g_aMi.g_aNW().g_aMx(),n:this.g_aMk,d:this.g_aMi.g_aOx(),u:this.g_aMi.g_aOy(),objs:this.g_aMi.g_aOz(),cvs:this.g_aMi.g_aOA()}));for(const g of this.g_aMi.g_aOB())!g.g_aAF()&&g!==this&&g.g_aOC()&&this.g_aOw("o",JSON.stringify({c:"j",i:g.g_LJ(),n:g.g_aMx(),a:g.g_aNV()}))}else this.g_aNG=!0,this.g_aAF()&&this.g_aOD(performance.now(),!0);this.g_aMi.g_aAq(this)}g_aOE(g){this.g_aNE||!this.g_aND||(this.g_aOF(g),this.g_aNE=!0,this.g_aND=!1)}g_aOF(g){this.g_aMi.g_aAF()&&!this.g_aNX()&&this.g_aMi.g_aOv("o",JSON.stringify({c:"l",i:this.g_Ro,a:this.g_aNv,r:g}),this),this.g_aNX()||this.g_aMi.g_aAs(this,g)}g_aOC(){return this.g_aND&&!this.g_aNE}g_aOw(g,a){this.g_aMi.g_aOG();let _=0;a.length?_=a.length:a.byteLength&&(_=a.byteLength),this.g_aMi.g_aOH(_);const t=this.g_aMi.g_aOI(),n=this.g_aMi.g_aOJ(),e=this.g_aMi.g_aOK();if(!(0<t&&"u"===g&&Math.random()<t))if(0===n&&0===e)this.g_aOL(g,a);else{let _=1;"u"!==g&&Math.random()<t&&(_=3),setTimeout(()=>this.g_aOL(g,a),n*_+Math.random()*e*_)}}g_aOL(g,a){try{"o"===g?this.g_aNy&&this.g_aNx&&this.g_aNx.send(a):"r"===g?this.g_aNA&&this.g_aNz&&this.g_aNz.send(a):"u"==g&&this.g_aNC&&this.g_aNB&&this.g_aNB.send(a)}catch(e){if(this.g_aNF)return;this.g_aMi.g_aAF()?"o"===g||"r"===g?("string"==typeof a?(console.error("Error sending "+a.length+"-char string on '"+g+"' to '"+this.g_aNv+"', host kicking: ",e),console.log("String that failed to send from previous error was: "+a)):console.error("Error sending "+(a.length||a.byteLength)+"-byte binary on '"+g+"' to '"+this.g_aNv+"', host kicking: ",e),this.g_lL("network error")):(this.g_aNJ++,10<=this.g_aNJ&&("string"==typeof a?(console.error("Too many errors ("+this.g_aNJ+") sending data on '"+g+"' to '"+this.g_aNv+"', kicking; last error was for sending "+a.length+"-char string: ",e),console.log("String that failed to send from previous error was: "+a)):console.error("Too many errors ("+this.g_aNJ+") sending data on '"+g+"' to '"+this.g_aNv+"', kicking; last error was for sending "+(a.length||a.byteLength)+"-byte binary: ",e),this.g_lL("network error"))):console.error("Error sending data on '"+g+"': ",e)}}g_aOD(g,a){return this.g_aNF?void 0:!a&&!this.g_aOC()&&this.g_aNw&&25e3<g-this.g_aNI?(console.warn("Timed out '"+this.g_aNv+"', could not establish connection after 25sec"),void this.g_lL("timeout")):!a&&this.g_aOC()&&2e4<g-this.g_aNH?(console.warn("Timed out '"+this.g_aNv+"', not heard from for 20sec"),void this.g_lL("timeout")):void(this.g_aNO=g,this.g_aNP=!0,this.g_aNQ++,this.g_aOw("u","ping:"+this.g_aNQ))}g_aOM(g){let a="pong:"+g.substr(5);this.g_aMi.g_aAF()&&(a+="/",a+=Math.round(performance.now()).toString()),this.g_aOw("u",a)}g_aON(_){if(!this.g_aNP)return;const a=_.indexOf(":");if(-1<a){const g=parseFloat(_.substr(a+1));if(g!==this.g_aNQ)return}else return void console.warn("Cannot parse off ping ID from pong");const t=performance.now();this.g_aNP=!1;const i=(t-this.g_aNO)/2;this.g_aNR.push(i),10<this.g_aNR.length&&this.g_aNR.shift(),n.push(...this.g_aNR),n.sort((g,e)=>g-e),this.g_aNT=n[n.length-1]-n[0];let e=0,o=n.length;4<=n.length&&6>=n.length?(++e,--o):6<n.length&&(e+=2,o-=2);let r=0;for(let a=e;a<o;++a)r+=n[a];if(this.g_aNS=r/(o-e),n.length=0,!this.g_aMi.g_aAF()){const a=_.indexOf("/");if(-1<a){const g=parseFloat(_.substr(a+1));isFinite(g)?this.g_aMi.g_aOO(g,t,i,this.g_aNS):console.warn("Invalid host time from pong response")}else console.warn("Cannot parse off host time from pong response")}}g_aOg(g,a){const _=this.g_aMi.g_aOI(),t=this.g_aMi.g_aOJ(),n=this.g_aMi.g_aOK();if(!(0<_&&"u"===g&&Math.random()<_))if(0===t&&0===n)this.g_aOP(g,a);else{let e=1;"u"!==g&&Math.random()<_&&(e=3),setTimeout(()=>this.g_aOP(g,a),t*e+Math.random()*n*e)}}g_aOP(g,e){if(this.g_aNF)return;this.g_aNH=performance.now(),this.g_aMi.g_aOQ();let a=0;if(e.data.length?a=e.data.length:e.data.byteLength&&(a=e.data.byteLength),this.g_aMi.g_aOR(a),"string"==typeof e.data){if(""===e.data.trim()||4>e.data.length)return;const g=e.data.substr(0,4);if("ping"===g)return void this.g_aOM(e.data);if("pong"===g)return void this.g_aON(e.data);var _;try{_=JSON.parse(e.data)}catch(g){return this.g_aMi.g_aOh(this,g),this.g_aMi.g_aAF()?(console.error("Error parsing message as JSON for peer '"+this.g_Ro+"', host kicking: ",g),this.g_lL("data error")):console.error("Error parsing message as JSON for peer '"+this.g_Ro+"': ",g),void console.log("String that failed to parse from previous error: "+e.data)}if(!_)return;try{_.c&&"m"!==_.c?this.g_aOS(_):this.g_aMi.g_aAr(this,_)}catch(g){this.g_aMi.g_aOh(this,g),this.g_aMi.g_aAF()?(console.error("Error handling message for peer '"+this.g_Ro+"', host kicking: ",g),this.g_lL("data error")):console.error("Error handling message for peer '"+this.g_Ro+"': ",g)}return}!this.g_aNG&&this.g_aMi.g_aAF()&&"u"===g&&(this.g_aNG=!0,this.g_aMi.g_aOT(this.g_Ro));try{this.g_aOU(e.data)}catch(g){return this.g_aMi.g_aOh(this,g),void(this.g_aMi.g_aAF()?(console.error("Error handling binary update for peer '"+this.g_Ro+"', host kicking: ",g),this.g_lL("data error")):console.error("Error handling binary update for peer '"+this.g_Ro+"': ",g))}}g_aOS(g){let a,e;switch(g.c){case"disconnect":g.k&&this.g_aMi.g_aI_("peer-kicked"),e=!this.g_aMi.g_aAF()&&!this.g_aAF(),this.g_lL(g.r),e&&this.g_aMi.g_aBM();break;case"hi":this.g_aMi.g_aAF()||(this.g_aMi.g_aNW().g_aNa(g.hn),this.g_aMi.g_aNY().g_aNa(g.n),this.g_aMi.g_aOV(g.d),this.g_aMi.g_aOW(g.u),this.g_aMi.g_aOX(g.objs),this.g_aMi.g_aOY(g.cvs));break;case"j":this.g_aMi.g_aAF()||(a=new i(this.g_aMi,g.i,g.a),a.g_aNa(g.n),this.g_aMi.g_aAq(a));break;case"l":this.g_aMi.g_aAF()||(a=this.g_aMi.g_aOZ(g.i),a&&(!a.g_aNX()&&this.g_aMi.g_aAs(a,g.r),a.g_lL(g.r)));break;default:console.error("Unknown control message from peer '"+this.g_Ro+"': "+g.c),this.g_aMi.g_aOh(this,"unknown control message '"+g.c+"'");}}g_aOU(g){this.g_aMi.g_aAF()?this.g_aO_(g):this.g_aO$(g)}g_aO_(g){const _=new DataView(g);let t=0;const a=_.getUint32(t);if(t+=4,1664249200!==a)return void console.warn("Rejected packet with incorrect magic number (received '"+a+"', expected '"+1664249200+"'");let n=_.getFloat64(t);if(t+=8,n+=this.g_aNS,!(3e3<=Math.abs(n-performance.now()))){_.getUint8(t),t+=1;const g=_.getUint8(t);t+=1;const i=[],o=this.g_aMi.g_aPa();for(let n=0;n<g;++n){if(n>=o.length){i.push(0);continue}const e=o[n];let a=0;switch(e.g_aL_()){case 0:a=_.getFloat64(t),t+=8;break;case 1:a=_.getFloat32(t),t+=4;break;case 2:a=e.g_aMf(_.getInt16(t)),t+=2;break;case 3:a=e.g_aMf(_.getUint8(t)),t+=1;break;default:a=_.getFloat32(t),t+=4;}i.push(a)}this.g_aPb(n,i)}}g_aPb(g,a){for(let e=0,_=this.g_aNN.length;e<_;++e){const _=this.g_aNN[e];if(_.timestamp===g)return;if(_.timestamp>g)return void this.g_aNN.splice(e,0,new g_aMJ(g,a))}this.g_aNN.push(new g_aMJ(g,a))}g_KM(g){if(0!==this.g_aNN.length){for(;2<this.g_aNN.length&&this.g_aNN[0]!==this.g_aMr&&this.g_aNN[0]!==this.g_aMs&&this.g_aNN[0]!==this.g_aMt;)this.g_aNN.shift();if(!(this.g_aMt&&this.g_aMt.timestamp>g&&this.g_aMs&&this.g_aMs.timestamp<g)){this.g_aMt=null;for(let a=0,e=this.g_aNN.length;a<e;++a){const e=this.g_aNN[a];if(e.timestamp<=g)(!this.g_aMs||e.timestamp>this.g_aMs.timestamp)&&(this.g_aMr=this.g_aMs,this.g_aMs=e);else{this.g_aMt=e;break}}}}}g_aO$(g){const a=new DataView(g);let _=0;const t=a.getUint32(_);if(_+=4,1664249200!==t)return void console.warn("Rejected packet with incorrect magic number (received '"+t+"', expected '"+1664249200+"'");const n=a.getUint32(_);_+=4,0===n?this.g_aPc(a,_):1===n?this.g_aPd(a,_):console.warn("Ignoring packet with incorrect flags (received "+n+", expected 0 or 1")}g_aPc(_,a){const t=_.getFloat64(a);a+=8;const g=_.getUint16(a);a+=2;for(let n=0;n<g;++n){const n=_.getUint16(a);a+=2;const o=_.getUint8(a);a+=1;let r=null,s=0;const g=this.g_aMi.g_aPe(n);g?(r=g.g_aMl(),s=r.length,1===o&&g.g_aNc(!0)):console.warn("Don't know which object corresponds to NID "+n);const e=_.getUint16(a);a+=2;const i=_.getUint16(a);a+=2;for(let n=0;n<e;++n){const n=_.getUint16(a);if(a+=2,g){const o=[];let e=a;for(let a=0;a<s;++a){const g=r[a];let t=0;switch(g.g_aL_()){case 0:t=_.getFloat64(e),e+=8;break;case 1:t=_.getFloat32(e),e+=4;break;case 2:t=g.g_aMf(_.getInt16(e)),e+=2;break;case 3:t=g.g_aMf(_.getUint8(e)),e+=1;break;default:t=_.getFloat32(e),e+=4;}o.push(t)}g.g_aMG(t,n,o)}a+=i}}}g_aPd(g,a){const _=g.getFloat64(a);a+=8;const t=g.getUint16(a);a+=2;for(let n=0;n<t;++n){const t=g.getUint16(a);a+=2;const n=this.g_aMi.g_aPe(t);n||console.warn("Don't know which object corresponds to NID "+g_aPf);const e=g.getUint16(a);a+=2;for(let t=0;t<e;++t){const e=g.getUint16(a);a+=2,n&&!n.g_aNd()&&(this.g_aMi.g_aAC(n,e,_),n.g_aNt(e))}}}g_lL(a,e){this.g_aNF||(this.g_aNF=!0,this.g_aOE(a),this.g_aOw("o",JSON.stringify({c:"disconnect",r:a,k:!!e})),g(this.g_aNx),g(this.g_aNz),g(this.g_aNB),g(this.g_aNw),this.g_aNx=null,this.g_aNz=null,this.g_aNB=null,this.g_aNw=null,this.g_aNy=!1,this.g_aNA=!1,this.g_aNC=!1,this.g_aMi.g_aPg(this))}g_aPh(g){return this.g_aMi.g_aPi(g)}g_aPj(g){const a=this.g_aMi.g_aPk(g);if(!a)return 0;const e=a.g_ED();if(0===this.g_aNN.length)return 0;const _=this.g_aNN[this.g_aNN.length-1].data;return 0>e||e>=_.length?0:_[e]}g_aPl(t){const n=t.g_ED();if(!this.g_aMt&&!this.g_aMs)return 0;if(this.g_aMt&&!this.g_aMs){const g=this.g_aMt.data;return 0>n||n>=g.length?0:g[n]}const o=this.g_aMi.g_aNi();let r,s,d,c,l;if(!this.g_aMt&&this.g_aMs)if(this.g_aMr){r=this.g_aMr.timestamp,s=this.g_aMr.data[n],d=this.g_aMs.timestamp,c=this.g_aMs.data[n];let g=o;return g>this.g_aMs.timestamp+250&&(g=this.g_aMs.timestamp+250),l=_(r,d,g),g_aMI.g_aMg(this.g_aMi.g_aPa()[n].g_aBu(),s,c,l,!0)}else{const g=this.g_aMs.data;return 0>n||n>=g.length?0:g[n]}return r=this.g_aMs.timestamp,s=this.g_aMs.data[n],d=this.g_aMt.timestamp,c=this.g_aMt.data[n],l=_(r,d,o),g_aMI.g_aMg(this.g_aMi.g_aPa()[n].g_aBu(),s,c,l,!1)}}self.g_aPm=i}{const _=window.RTCPeerConnection||window.webkitRTCPeerConnection||window.mozRTCPeerConnection||window.msRTCPeerConnection,t=window.RTCSessionDescription||window.webkitRTCSessionDescription||window.mozRTCSessionDescription||window.msRTCSessionDescription,n=window.RTCIceCandidate||window.webkitRTCIceCandidate||window.mozRTCIceCandidate||window.msRTCIceCandidate,a=window.RTCDataChannel||window.webkitRTCDataChannel||window.mozRTCDataChannel||window.msRTCDataChannel,i=[{urls:"stun:stun.l.google.com:19302"}];let e=!1;const o=[],g=class extends g_aIV{constructor(g){super(g,"multiplayer"),this.g_aPn=[],this.g_aPo=null,this.g_aPp=!1,this.g_aPq=!1,this.g_azt={g_aPr:0,version:0,name:"",operator:"",g_aPs:""},this.g_azy="",this.g_azz="",this.g_azD="",this.g_azE="",this.g_azF="",this.g_azJ=[],this.g_azK=new Map,this.g_aPt=0,this.g_aPu=new Set,this.g_aPv=null,this.g_aPw=null,this.g_aAb=80,this.g_aPx=30,this.g_aPy=30,this.g_aPz=0,this.g_aPA={g_aPB:0,g_aPC:0,g_aPD:0,g_aPE:0,g_aPF:0,g_aPG:0,g_aPH:0,g_aPI:0,g_aPJ:0},this.g_aPK=new ArrayBuffer(262144),this.g_aPL=new DataView(this.g_aPK),this.g_aPM=[],this.g_aPN=1,this.g_aPO=new Map,this.g_aPP=new Map,this.g_aPQ=0,this.g_aPR=0,this.g_aPS=0,this.g_aPT=[],this.g_aPU=0,this.g_aPV=0,this.g_aPW=this.g_aAb,this.g_aPX=this.g_aAb,this.g_aPY=[],this.g_aPZ=new Map,this.g_aP_=!1,this.g_aP$(i),setInterval(()=>this.g_aQa(),2e3),window.addEventListener("unload",()=>this.g_aQb("quit")),this.g_aJf("get-supported",()=>this.g_aQc()),this.g_aJf("add-ice-servers",g=>this.g_aP$(g.list)),this.g_aJf("simulate-latency",g=>this.g_aQd(g.latency,g.pdv,g.loss)),this.g_aJf("set-bandwidth-profile",g=>this.g_aQe(g.updateRate,g.delay)),this.g_aJf("tick",g=>this.g_KM(g)),this.g_aJf("alert",g=>this.g_aQf(g)),this.g_aJf("signalling-connect",g=>this.g_aBG(g.url)),this.g_aJf("signalling-disconnect",()=>this.g_aBH()),this.g_aJf("signalling-login",g=>this.g_aBJ(g.alias)),this.g_aJf("signalling-join-room",g=>this.g_aQg(g.game,g.instance,g.room,g.maxClients)),this.g_aJf("signalling-auto-join-room",g=>this.g_aQh(g.game,g.instance,g.room,g.maxClients,g.lock)),this.g_aJf("signalling-leave-room",()=>this.g_aBM()),this.g_aJf("signalling-list-game-instances",g=>this.g_aBX(g.game)),this.g_aJf("signalling-list-rooms",g=>this.g_aBY(g.game,g.instance,g.which)),this.g_aJf("disconnect-room",()=>this.g_aBN(!0)),this.g_aJf("peer-send-message",g=>this.g_aQi(g)),this.g_aJf("host-broadcast",g=>this.g_aQj(g)),this.g_aJf("kick-peer",g=>this.g_aQk(g)),this.g_aJf("sync-object",g=>this.g_aQl(g)),this.g_aJf("sync-inst-var",g=>this.g_aQm(g)),this.g_aJf("associate-object",g=>this.g_aQn(g)),this.g_aJf("remove-object-id",g=>this.g_aNs(g.uid)),this.g_aJf("remove-net-insts",g=>this.g_aQo(g)),this.g_aJf("remove-object-nid",g=>this.g_aQp(g)),this.g_aJf("set-client-state",g=>this.g_aBU(g.tag,g.value)),this.g_aJf("add-client-input-value",g=>this.g_aBV(g.tag,g.precision,g.interp))}g_aQq(g){return g?"string"==typeof g?g:"string"==typeof g.message?g.message:"string"==typeof g.details?g.details:"string"==typeof g.data?g.data:"string"==typeof g.type?g.type:"unknown error":"unknown error"}g_aQr(){return this.g_aPp}g_aQs(){return this.g_aQr()&&this.g_aPq}g_aAG(){return this.g_aQs()&&this.g_azF}g_aAF(){return this.g_aAG()&&this.g_aPv&&this.g_aPw===this.g_aPv}g_aQt(){return this.g_aQs()?this.g_azy:""}g_aQu(){return this.g_aQs()?this.g_azz:""}g_aOl(){return this.g_aQs()?this.g_azD:""}g_aOm(){return this.g_aQs()?this.g_azE:""}g_aOn(){return this.g_aAG()?this.g_azF:""}g_aQv(){return this.g_aPw?this.g_aPw.g_LJ():""}g_aQw(){return this.g_aPw?this.g_aPw.g_aNV():""}g_aNW(){return this.g_aPw}g_aNY(){return this.g_aPv}g_aQd(g,a,e){var _=Math.max;this.g_aPQ=_(g,0),this.g_aPR=_(a,0),this.g_aPS=_(e,0)}g_aOI(){return this.g_aPS}g_aOJ(){return this.g_aPQ}g_aOK(){return this.g_aPR}g_aQc(){return{isSupported:!!(_&&a)}}g_aBG(g){if(!(this.g_aPo||this.g_aPp)){try{this.g_aPo=new WebSocket(g,"c2multiplayer")}catch(g){return this.g_aPo=null,void this.g_aAh(g)}this.g_aPo.onopen=()=>-1===this.g_aPo.protocol.indexOf("c2multiplayer")?(this.g_aAh("server does not support 'c2multiplayer' protocol"),this.g_aPo.close(1002,"'c2multiplayer' protocol required"),this.g_aPo=null,void(this.g_aPp=!1)):void(this.g_aPp=!0),this.g_aPo.onclose=()=>{this.g_aAi(),this.g_aPp=!1,this.g_aPq=!1,this.g_aPo=null},this.g_aPo.onerror=g=>{console.error("Signalling server error: ",g),this.g_aAh(g)},this.g_aPo.onmessage=g=>{this.g_aQx(g)}}}g_aBH(){this.g_aPo&&this.g_aPp&&(this.g_aPo.close(),this.g_aPo=null,this.g_aPp=!1)}g_aQx(g){let a;try{a=JSON.parse(g.data)}catch(g){return void this.g_aAh(g)}switch(a.message){case"welcome":this.g_aQy(a);break;case"login-ok":this.g_aQz(a);break;case"join-ok":this.g_aQA(a);break;case"leave-ok":this.g_aQB(a);break;case"kicked":this.g_aQC(a);break;case"peer-joined":this.g_aQD(a);break;case"peer-quit":this.g_aQE(a);break;case"icecandidate":this.g_aQF(a);break;case"offer":this.g_aQG(a);break;case"answer":this.g_aQH(a);break;case"instance-list":this.g_aQI(a);break;case"room-list":this.g_aQJ(a);break;case"error":this.g_aAh(a.details);break;default:this.g_aAh("received unknown signalling message");}}g_aQK(g){for(const a of this.g_aPn)if(a.urls===g.urls)return!0;return!1}g_aP$(g){if(g)for(let a of g)"string"==typeof a&&(a={urls:a}),this.g_aQK(a)||(!a.hasOwnProperty("url")&&(a.url=a.urls),this.g_aPn.push(a))}g_aOj(){return this.g_aPn}g_aAh(g){this.g_aI_("signalling-error",{message:this.g_aQq(g)})}g_aAi(){this.g_aI_("signalling-close")}g_aQy(g){if(1>g.protocolrev||1<g.protocolrev)return this.g_aAh("signalling server protocol revision not supported"),void this.g_aBH();this.g_azy=g.clientid;const a=this.g_azt;a.g_aPr=g.protocolrev,a.version=g.version,a.name=g.name,a.operator=g.operator,a.g_aPs=g.motd,this.g_aP$(g.ice_servers),this.g_aI_("signalling-welcome",{myid:this.g_azy,sigservinfo:{protocolrev:a.g_aPr,version:a.version,name:a.name,operator:a.operator,motd:a.g_aPs}})}g_aQz(g){this.g_azz=g.alias,this.g_aPq=!0,this.g_aI_("signalling-login-ok",{myalias:this.g_azz})}g_aMM(){return this.g_aPN++}g_aOo(){if(this.g_aAF()){do this.g_aPt++,65535<this.g_aPt&&(this.g_aPt=0);while(this.g_aPu.has(this.g_aPt));const g=this.g_aPt;return this.g_aPu.add(g),g}}g_aQL(g){this.g_aAF()&&this.g_aPu.delete(g)}g_aQA(g){this.g_aQb("disconnect"),this.g_azD=g.game,this.g_azE=g.instance,this.g_azF=g.room,this.g_aPv=new g_aPm(this,this.g_azy,this.g_azz),g.host?(this.g_aPw=this.g_aPv,this.g_aPt=0,this.g_aPu.clear(),this.g_aPw.g_aNa(this.g_aOo())):(this.g_aPT.length=0,this.g_aPU=0,this.g_aPV=0,this.g_aAb=80,this.g_aPx=30,this.g_aPy=30,this.g_aPW=this.g_aAb,this.g_aPX=this.g_aAb,this.g_aPw=new g_aPm(this,g.hostid,g.hostalias),this.g_aPw.g_aOi()),this.g_aI_("signalling-join-ok",{isHost:!!g.host,hostId:this.g_aPw.g_LJ(),hostAlias:this.g_aPw.g_aNV(),game:this.g_azD,gameInstance:this.g_azE,room:this.g_azF})}g_aQB(){this.g_azF="",this.g_aI_("signalling-leave-ok")}g_aQC(){this.g_aBN(),this.g_azF="",this.g_aI_("signalling-kicked")}g_aQD(g){if(this.g_aPq&&this.g_azF&&this.g_aAF()){const a=this.g_azK.get(g.peerid);a&&a.g_lL("rejoin");const e=new g_aPm(this,g.peerid,g.peeralias);e.g_aOi()}}g_aQE(g){if(this.g_aPq&&this.g_azF&&this.g_aAF()){const a=this.g_azK.get(g.id);a&&a.g_lL(g.reason)}}g_aQF(g){if(this.g_aPq&&this.g_azF){const a=this.g_azK.get(g.from);a&&a.g_aOr(new n(g.icecandidate))}}g_aQG(g){if(!this.g_aPq||!this.g_azF||this.g_aAF()||!this.g_aPv||!this.g_aPw||!this.g_aPw.g_aOs())return;if(g.from!==this.g_aPw.g_LJ())return;const e=this.g_aPw.g_aOt();e.setRemoteDescription(new t(g.offer)).then(()=>{e.createAnswer().then(g=>{e.setLocalDescription(g),this.g_aOk({message:"answer",toclientid:this.g_aPw.g_LJ(),answer:g})}).catch(g=>{console.error("Peer error creating answer: ",g),this.g_aOh(this.g_aPv,"could not create answer to host offer")})}).catch(g=>{console.error("Peer error setting remote description: ",g),this.g_aOh(this.g_aPv,"could not set remote description")})}g_aQH(g){if(this.g_aPq&&this.g_azF&&this.g_aAF()){const a=this.g_azK.get(g.from);a&&a.g_aOt().setRemoteDescription(new t(g.answer)).catch(g=>{console.error("Host error setting remote description: ",g)})}}g_aQI(g){this.g_aI_("signalling-instance-list",{list:g.list})}g_aQJ(g){this.g_aI_("signalling-room-list",{list:g.list})}g_aOk(g){this.g_aPo&&this.g_aPp&&this.g_aPo.send(JSON.stringify(g))}g_aBJ(g){this.g_aPq||this.g_aOk({message:"login",protocolrev:1,alias:g})}g_aQg(g,a,e,_){!this.g_aPq||this.g_azF||this.g_aOk({message:"join",game:g,instance:a,room:e,max_clients:_})}g_aQh(g,a,_,t,n){!this.g_aPq||this.g_azF||this.g_aOk({message:"auto-join",game:g,instance:a,room:_,max_clients:t,lock_when_full:n})}g_aBM(){this.g_aPq&&this.g_aOk({message:"leave"})}g_aOT(g){this.g_aPq&&this.g_aAF()&&this.g_aOk({message:"confirm-peer",id:g})}g_aBX(g){this.g_aPo&&this.g_aPp&&this.g_aOk({message:"list-instances",game:g})}g_aBY(g,a,e){this.g_aPo&&this.g_aPp&&this.g_aOk({message:"list-rooms",game:g,instance:a,which:e})}g_aBN(g){this.g_aPT.length=0,this.g_aPU=0,this.g_aPV=0,this.g_aQb("disconnect"),g&&this.g_aBM()}g_aNU(g){this.g_azJ.push(g),this.g_azK.set(g.g_LJ(),g),this.g_aI_("add-peer",{id:g.g_LJ(),alias:g.g_aNV()})}g_aPg(g){this.g_aI_("remove-peer",{id:g.g_LJ()}),this.g_aAF()&&this.g_aQL(g.g_aMx());const a=this.g_azJ.indexOf(g);-1<a&&this.g_azJ.splice(a,1),this.g_azK.delete(g.g_LJ()),this.g_aPw===g&&(this.g_aPw=null,this.g_aQb("host quit")),this.g_aPv===g&&(this.g_aPv=null,this.g_azF="",this.g_aQb("disconnect"))}g_aQb(g){if(!e){for(e=!0;this.g_azJ.length;)this.g_azJ[0].g_lL(g);e=!1}}g_aOZ(g){return this.g_azK.get(g)||null}g_aQM(g){const a=this.g_azK.get(g);return a?a.g_aNV():""}g_aQN(g){for(const a of this.g_azJ)if(a.g_aMx()===g)return a;return null}g_aQj(g){const a=g.fromId,_=g.tag,t=g.message,n=g.mode,e=this.g_aOZ(a);this.g_aOv(n,JSON.stringify({c:"m",t:_,f:a,m:t}),e)}g_aOv(g,a,_){if(this.g_aAF()){const t=this.g_azJ.slice(0);for(const n of t)n&&n!==this.g_aPv&&n!==_&&n.g_aOw(g,a)}}g_aQa(){const g=performance.now();if(this.g_aAF()){o.push(...this.g_azJ);for(const a of o)a&&a!==this.g_aPv&&a.g_aOD(g,!1);o.length=0}else this.g_aPw&&this.g_aPw.g_aOD(g,!1)}g_aM_(g){this.g_aPM.push(g),this.g_aPP.set(g.g_aM$(),g),this.g_aPO.set(g.g_aMx(),g)}g_aOz(){const g={};for(const[a,e]of this.g_aPO.entries())g[e.g_aNe()]={nid:a,nvs:e.g_aNm()};return g}g_aOX(g){this.g_aPO.clear();for(const a of this.g_aPM)if(g.hasOwnProperty(a.g_aNe().toString())){const e=g[a.g_aNe().toString()];a.g_aNa(e.nid),this.g_aPO.set(e.nid,a),a.g_aNn(e.nvs)}else console.warn("Could not map object SID '"+a.g_aNe()+"' - host did not send NID for it"),a.g_aNa(-1)}g_aPe(g){return this.g_aPO.get(g)||null}g_KM(g){if(!this.g_aAG())return null;const a=g.dt,_=performance.now(),t=this.g_aAF()?this.g_aPx:this.g_aPy;_-this.g_aPz>=1e3/t-5&&(this.g_aQO(_),this.g_aPz=_);const n=this.g_aPA;1e3<=_-n.g_aPB&&(n.g_aPC=n.g_aPD,n.g_aPE=n.g_aPF,n.g_aPG=n.g_aPH,n.g_aPI=n.g_aPJ,n.g_aPD=0,n.g_aPF=0,n.g_aPH=0,n.g_aPJ=0,n.g_aPB+=1e3,500<_-n.g_aPB&&(n.g_aPB=_),this.g_aI_("stats",{stats:{outboundPerSec:n.g_aPC,outboundBandwidthPerSec:n.g_aPE,inboundPerSec:n.g_aPG,inboundBandwidthPerSec:n.g_aPI}})),this.g_aAF()||(this.g_aPV<this.g_aPU?(this.g_aPV+=10*a,this.g_aPV>this.g_aPU&&(this.g_aPV=this.g_aPU)):this.g_aPV>this.g_aPU&&(this.g_aPV-=10*a,this.g_aPV<this.g_aPU&&(this.g_aPV=this.g_aPU)),this.g_aPX<this.g_aPW?(this.g_aPX+=30*a,this.g_aPX>this.g_aPW&&(this.g_aPX=this.g_aPW)):this.g_aPX>this.g_aPW&&(this.g_aPX-=30*a,this.g_aPX<this.g_aPW&&(this.g_aPX=this.g_aPW)));const e=this.g_aNi();for(const a of this.g_azJ)a.g_KM(e);for(const a of this.g_aPM)a.g_KM();return{simulationTime:this.g_aNi(),hostInputArrivalTime:this.g_aQP(),clientDelay:this.g_aAb,peerData:this.g_aQQ(),roData:this.g_aQR(),isReadyForInput:this.g_aBD()}}g_aQQ(){const g={};for(const e of this.g_azJ){const _={};for(const g of this.g_aPY)_[g.g_aL$()]=e.g_aPl(g);g[e.g_LJ()]={nid:e.g_aMx(),latency:e.g_aOc(),pdv:e.g_aOd(),clientState:_}}return g}g_aQR(){const g={};for(const a of this.g_aPM)g[a.g_aM$()]=a.g_aLZ();return g}async g_aQO(g){this.g_aAF()?(await this.g_aQS(g),this.g_aQT(g)):await this.g_aQU(g)}async g_aAx(){const g=await this.g_aJa("before-client-update");for(const a of g.clientStateUpdates)this.g_aBU(a.tag,a.value)}async g_aQU(_){if(this.g_aBD()&&(await this.g_aAx()),!this.g_aPv||!this.g_aP_)return;const t=this.g_aPL;let n=0;const i=this.g_aPY,o=this.g_aPv.g_aNZ(),a=_-this.g_aPv.g_aN$(),e=_-this.g_aPv.g_aOb();let g=!1;if(g=!!(100>a)||(1e3>a?95<=e:495<=e),!!g){t.setUint32(n,1664249200),n+=4,t.setFloat64(n,_+this.g_aPV),n+=8,t.setUint8(n,0),n+=1,t.setUint8(n,i.length),n+=1;for(let e=0,a=i.length;e<a;++e){const a=i[e];let _=0;e<o.length&&(_=a.g_aMd(o[e])),n=a.g_aMe(t,n,_)}this.g_aPv.g_aOa(_),this.g_aPw.g_aOw("u",new Uint8Array(this.g_aPK,0,n))}}async g_aQS(g){const a=this.g_aPL;let _=0,t=0;const n=await this.g_aJa("get-object-info",{ros:this.g_aPM.map(g=>g.g_aNu())});for(const a of this.g_aPM){const e=a.g_aM$();if(!n.hasOwnProperty(e))continue;const _=n[e];a.g_aMB(_,g),0<a.g_aNb()&&t++}if(0!=t){a.setUint32(_,1664249200),_+=4,a.setUint32(_,0),_+=4,a.setFloat64(_,g),_+=8,a.setUint16(_,t),_+=2;for(const e of this.g_aPM)0<e.g_aNb()&&(_=e.g_aMF(a,_,g));this.g_aOv("u",new Uint8Array(this.g_aPK,0,_),null)}}g_aQT(g){const e=this.g_aPL;let _=0,a=0;for(const e of this.g_aPM)e.g_aNf().length&&a++;if(0!=a){e.setUint32(_,1664249200),_+=4,e.setUint32(_,1),_+=4,e.setFloat64(_,g),_+=8,e.setUint16(_,a),_+=2;for(const g of this.g_aPM){const t=g.g_aNf();if(t.length){e.setUint16(_,g.g_aMx()),_+=2,e.setUint16(_,t.length),_+=2;for(const g of t)e.setUint16(_,g),_+=2;t.length=0}}this.g_aOv("r",new Uint8Array(this.g_aPK,0,_),null)}}g_aOO(g,a,_,t){if(this.g_aAF())return;this.g_aPW=t+this.g_aAb;var n=g+_-a;0===this.g_aPT.length&&(this.g_aPV=n,this.g_aPX=this.g_aPW),this.g_aPT.push(n),30<this.g_aPT.length&&this.g_aPT.shift(),o.push(...this.g_aPT),o.sort((g,e)=>g-e);let i=0,r=o.length;4<=o.length&&6>=o.length?(++i,--r):6<o.length&&19>=o.length?(i+=2,r-=2):19<o.length&&(i+=5,r-=5);let s=0;for(let n=i;n<r;++n)s+=o[n];this.g_aPU=s/(r-i),o.length=0}g_aNi(){return this.g_aAF()?performance.now()-this.g_aAb:performance.now()+this.g_aPV-this.g_aPX}g_aQV(){return this.g_aAF()?performance.now():performance.now()+this.g_aPV}g_aQP(){return this.g_aAF()?performance.now():performance.now()+this.g_aPV+this.g_aPX}g_aBU(g,e){if(!this.g_aAF()&&this.g_aPv&&this.g_aP_){const _=this.g_aPZ.get(g);if(_){const g=_.g_ED(),a=this.g_aPv.g_aNZ();a.length<g+1&&(a.length=g+1),a[g]!==e&&(a[g]=e,this.g_aPv.g_aN_(performance.now()))}}}g_aBV(g,a,e){const _=new g_aMI(this.g_aPY.length,e,a,g,null);this.g_aPZ.set(g,_),this.g_aPY.push(_)}g_aPa(){return this.g_aPY}g_aOA(){const g=[];for(const a of this.g_aPY)g.push({tag:a.g_aL$(),precision:a.g_aL_(),interp:a.g_aBu()});return g}g_aOY(g){this.g_aPZ.clear(),this.g_aPY.length=0;for(let a=0,e=g.length;a<e;++a){const e=g[a],_=new g_aMI(a,e.interp,e.precision,e.tag,null);this.g_aPZ.set(_.g_aL$(),_),this.g_aPY.push(_)}this.g_aP_=!0}g_aNs(g){for(const a of this.g_aPM)a.g_aNs(g)}g_aOB(){return this.g_azJ}g_aQW(){return this.g_aAG()?this.g_azJ.length:0}g_aQX(g){return g=Math.floor(g),!this.g_aAG()||0>g||g>=this.g_azJ.length?null:this.g_azJ[g]}g_aBD(){return!!this.g_aAG()&&(!!this.g_aAF()||0!==this.g_aPU)}g_aQe(g,a){this.g_aAG()||(this.g_aPx=g,this.g_aPy=g,this.g_aAb=a)}g_aAq(g){this.g_aI_("peer-open",{id:g.g_LJ(),alias:g.g_aNV()})}g_aQi(g){const a=g.id,_=g.tag,t=g.message,n=g.mode,e=this.g_aOZ(a);e&&e.g_aOw(n,JSON.stringify({c:"m",t:_,m:t}))}g_aAs(g,a){this.g_aI_("peer-close",{id:g.g_LJ(),alias:g.g_aNV(),reason:a||"unknown"})}g_aOh(g,a){console.error(`[Multiplayer] Peer '${g.g_aNV()}' (${g.g_LJ()}) error: `,a)}g_aAr(g,a){const e=a.f||g.g_LJ();this.g_aI_("peer-message",{tag:a.t,fromId:e,fromAlias:this.g_aQM(e),content:a.m})}g_aAC(g,a,e){this.g_aI_("instance-destroyed",{roId:g.g_aM$(),nid:a,timestamp:e})}g_aQk(g){if(this.g_aAF()){const a=g.id,e=g.reason,_=this.g_aOZ(a);_&&_.g_lL(e,!0)}}g_aOG(){this.g_aPA.g_aPD++}g_aOH(g){this.g_aPA.g_aPF+=g}g_aOQ(){this.g_aPA.g_aPH++}g_aOR(g){this.g_aPA.g_aPJ+=g}g_aOV(g){this.g_aAb=g}g_aOx(){return this.g_aAb}g_aOW(g){this.g_aPy=g}g_aOy(){return this.g_aPy}g_aQl(g){const _=g.data,t=g.precision,n=g.bandwidth;for(const i of g.objectClasses){const g=new g_aMK(this,i.roId,i.sid,n);1===_?(g.g_aNg(1,t,"x"),g.g_aNg(1,t,"y")):2===_?g.g_aNg(2,t,"a"):3===_&&(g.g_aNg(1,t,"x"),g.g_aNg(1,t,"y"),g.g_aNg(2,t,"a"))}}g_aQf(g){alert(g.message)}g_aQm(g){const _=g.precision,t=g.interp,n=g.cvt;for(const i of g.syncData){const g=this.g_aPP.get(i.roId);g.g_aNg(t,_,"iv",i.varIndex,n)}}g_aQn(g){const a=g.roId,_=g.peerId,t=g.instUid,n=this.g_aPP.get(a),e=this.g_azK.get(_);n&&e&&(!this.g_aAF()||n.g_aNr(t,e.g_aMx()))}g_aQo(g){for(const[e,_]of Object.entries(g)){const g=this.g_aPP.get(parseInt(e,10));if(g)for(const a of _)g.g_aNt(a)}}g_aQp(g){const a=g.roId,e=g.nid,_=this.g_aPP.get(a);_&&_.g_aNt(e)}};g_aJE.g_aKz(g)}{const g=class extends g_aIV{constructor(g){super(g,"platform-info"),this.g_aJf("get-initial-state",()=>this.g_aQY()),window.addEventListener("resize",()=>this.g_aQZ())}g_aQY(){return{screenWidth:screen.width,screenHeight:screen.height,windowOuterWidth:window.outerWidth,windowOuterHeight:window.outerHeight,safeAreaInset:this.g_aQ_()}}g_aQ_(){const g=document.body,a=g.style;a.setProperty("--temp-sai-top","env(safe-area-inset-top)"),a.setProperty("--temp-sai-right","env(safe-area-inset-right)"),a.setProperty("--temp-sai-bottom","env(safe-area-inset-bottom)"),a.setProperty("--temp-sai-left","env(safe-area-inset-left)");const e=getComputedStyle(g),_=[e.getPropertyValue("--temp-sai-top"),e.getPropertyValue("--temp-sai-right"),e.getPropertyValue("--temp-sai-bottom"),e.getPropertyValue("--temp-sai-left")].map(g=>{const a=parseInt(g,10);return isFinite(a)?a:0});return a.removeProperty("--temp-sai-top"),a.removeProperty("--temp-sai-right"),a.removeProperty("--temp-sai-bottom"),a.removeProperty("--temp-sai-left"),_}g_aQZ(){this.g_aI_("window-resize",{windowOuterWidth:window.outerWidth,windowOuterHeight:window.outerHeight,safeAreaInset:this.g_aQ_()})}};g_aJE.g_aKz(g)}{function g(g,e){return g.length===e.length&&(g===e||g.toLowerCase()===e.toLowerCase())}const a=class extends g_aIV{constructor(g){super(g,"audio"),this.g_aQ$=null,this.g_aRa=null,this.g_aRb=!1,this.g_aRc=()=>this.g_aRd(),this.g_aRe=[],this.g_aRf=[],this.g_aRg=null,this.g_aRh="",this.g_aRi=-1,this.g_aRj=new Map,this.g_aGR=1,this.g_aGS=!1,this.g_aGE=0,this.g_ajU=1,this.g_aqn=0,this.g_aGH="HRTF",this.g_aGI="inverse",this.g_aRk=600,this.g_aGN=1e4,this.g_aGO=1,this.g_aRl=!1,this.g_aRm=!1,this.g_aRn=this.g_aqU.g_Cf("audio/webm; codecs=opus"),this.g_aRo=new Map,this.g_aRp=new Set,this.g_aRq=!1,this.g_aRr="",this.g_aRs=null,self.C3Audio_OnMicrophoneStream=(g,a)=>this.g_aRt(g,a),this.g_aRu=null,self.C3Audio_GetOutputStream=()=>this.g_aRv(),self.C3Audio_DOMInterface=this,this.g_aJh([["create-audio-context",g=>this.g_aRw(g)],["play",g=>this.g_aRx(g)],["stop",g=>this.g_aRy(g)],["stop-all",()=>this.g_aRz()],["set-paused",g=>this.g_aRA(g)],["set-volume",g=>this.g_aRB(g)],["fade-volume",g=>this.g_aRC(g)],["set-master-volume",g=>this.g_aRD(g)],["set-muted",g=>this.g_aRE(g)],["set-silent",g=>this.g_aRF(g)],["set-looping",g=>this.g_aRG(g)],["set-playback-rate",g=>this.g_aRH(g)],["seek",g=>this.g_aRI(g)],["preload",g=>this.g_aRJ(g)],["unload",g=>this.g_Hs(g)],["unload-all",()=>this.g_aRK()],["set-suspended",g=>this.g_aRL(g)],["add-effect",g=>this.g_aRM(g)],["set-effect-param",g=>this.g_aRN(g)],["remove-effects",g=>this.g_aRO(g)],["tick",g=>this.g_JK(g)],["load-state",g=>this.g_aLR(g)]])}async g_aRw(g){g.isiOSCordova&&(this.g_aRl=!0),this.g_aGE=g.timeScaleMode,this.g_aGH=["equalpower","HRTF","soundfield"][g.panningModel],this.g_aGI=["linear","inverse","exponential"][g.distanceModel],this.g_aRk=g.refDistance,this.g_aGN=g.maxDistance,this.g_aGO=g.rolloffFactor;const a={latencyHint:g.latencyHint};if("undefined"!=typeof AudioContext)this.g_aQ$=new AudioContext(a);else if("undefined"!=typeof webkitAudioContext)this.g_aQ$=new webkitAudioContext(a);else throw new Error("Web Audio API not supported");this.g_aRa=this.g_aQ$.createGain(),this.g_aRa.connect(this.g_aQ$.destination);const e=g.listenerPos;this.g_aQ$.listener.setPosition(e[0],e[1],e[2]),this.g_aQ$.listener.setOrientation(0,0,1,0,-1,0),window.addEventListener("pointerup",this.g_aRc,!0),window.addEventListener("touchend",this.g_aRc,!0),window.addEventListener("click",this.g_aRc,!0),window.addEventListener("keydown",this.g_aRc,!0),self.C3_GetAudioContextCurrentTime=()=>this.g_aRP();try{await Promise.all(g.preloadList.map(g=>this.g_aRQ(g.originalUrl,g.url,g.type,!1)))}catch(g){console.error("[Construct 3] Preloading sounds failed: ",g)}return{sampleRate:this.g_aQ$.sampleRate}}g_aRd(){if(!this.g_aRb){const g=this.g_aQ$;"suspended"===g.state&&g.resume&&g.resume();const a=g.createBuffer(1,220,22050),e=g.createBufferSource();e.buffer=a,e.connect(g.destination),e.start(0),"running"===g.state&&(this.g_aRb=!0,window.removeEventListener("pointerup",this.g_aRc,!0),window.removeEventListener("touchend",this.g_aRc,!0),window.removeEventListener("click",this.g_aRc,!0),window.removeEventListener("keydown",this.g_aRc,!0),this.g_aRc=null)}}g_aGz(){return this.g_aQ$}g_aRP(){return this.g_aQ$.currentTime}g_aGB(){return this.g_aRa}g_aRR(g){const a=this.g_aRo.get(g.toLowerCase());return a?a[0].g_aRS():this.g_aGB()}g_aRT(g,e){g=g.toLowerCase();let _=this.g_aRo.get(g);_||(_=[],this.g_aRo.set(g,_)),e.g_alA(_.length),e.g_aRU(g),_.push(e),this.g_aRV(g)}g_aRV(g){let a=this.g_aGB();const e=this.g_aRo.get(g);if(e&&e.length){a=e[0].g_aRS();for(let g=0,a=e.length;g<a;++g){const _=e[g];g+1===a?_.g_aRW(this.g_aGB()):_.g_aRW(e[g+1].g_aRS())}}for(const e of this.g_aRX(g))e.g_aRY(a);this.g_aRs&&this.g_aRr===g&&(this.g_aRs.disconnect(),this.g_aRs.connect(a))}g_aRZ(){return this.g_aGR}g_aHs(){return this.g_aGS}g_aR_(){return this.g_aGE}g_KK(){return this.g_ajU}g_Gb(){return this.g_aqn}g_aR$(){return this.g_aRl}g_aSa(){return this.g_aRn}g_aSb(){this.g_aRm=!0}g_aSc(){return this.g_aGH}g_aSd(){return this.g_aGI}g_aSe(){return this.g_aRk}g_aSf(){return this.g_aGN}g_aSg(){return this.g_aGO}g_aSh(g,a){return a?this.g_aqU.g_afT(g).then(g=>{const a=this.g_aQ$.createBuffer(1,g.length,48e3),e=a.getChannelData(0);return e.set(g),a}):new Promise((a,e)=>{this.g_aQ$.decodeAudioData(g,a,e)})}g_aKB(g){this.g_aqU.g_aKB(g)}g_aKC(g){this.g_aqU.g_aKC(g)}g_aSi(a){let g=0;for(let _=0,e=this.g_aRf.length;_<e;++_){const t=this.g_aRf[_];this.g_aRf[g]=t,t.g_aSj()===a?t.g_ek():++g}this.g_aRf.length=g}g_aSk(){let g=0;for(let a=0,e=this.g_aRe.length;a<e;++a){const e=this.g_aRe[a];this.g_aRe[g]=e,e.g_aSl()?e.g_ek():++g}this.g_aRe.length=g}*g_aRX(a){if(a)for(const e of this.g_aRf)g(e.g_aL$(),a)&&(yield e);else this.g_aRg&&!this.g_aRg.g_aSm()&&(yield this.g_aRg)}async g_aRQ(g,a,_,t,n){for(const e of this.g_aRe)if(e.g_aSn()===a)return await e.g_BW(),e;if(n)return null;t&&(this.g_aRl||this.g_aRm)&&this.g_aSk();const e=g_aSo.g_qS(this,g,a,_,t);return this.g_aRe.push(e),await e.g_BW(),e}async g_aSp(_,a,t,n,i){for(const g of this.g_aRf)if(g.g_aSn()===a&&(g.g_aSq()||i))return g.g_aSr(n),g;const e=await this.g_aRQ(_,a,t,i),o=e.g_agg(n);return this.g_aRf.push(o),o}g_aSs(g){let a=this.g_aRj.get(g);if(!a){let e=null;const _=new Promise(g=>e=g);a={g_aSt:0,promise:_,resolve:e},this.g_aRj.set(g,a)}a.g_aSt++}g_aSu(g){const a=this.g_aRj.get(g);if(!a)throw new Error("expected pending tag");a.g_aSt--,0===a.g_aSt&&(a.resolve(),this.g_aRj.delete(g))}g_aSv(g){g||(g=this.g_aRh);const e=this.g_aRj.get(g);return e?e.promise:Promise.resolve()}g_aSw(){if(0<this.g_aRp.size)return void this.g_adZ();for(const g of this.g_aRf)if(g.g_XR())return void this.g_adZ()}g_KM(){for(const a of this.g_aRp)a.g_KM();const g=this.g_aRP();for(const a of this.g_aRf)a.g_KM(g);const a=this.g_aRf.filter(a=>a.g_XR()).map(a=>a.g_aSx());this.g_aI_("state",{tickCount:this.g_aRi,audioInstances:a,analysers:[...this.g_aRp].map(a=>a.g_aSy())}),0===a.length&&0===this.g_aRp.size&&this.g_adK()}g_aSz(g,a){this.g_aI_("trigger",{type:g,tag:a})}async g_aRx(_){const a=_.originalUrl,t=_.url,n=_.type,o=_.isMusic,e=_.tag,r=_.isLooping,g=_.vol,s=_.pos,i=_.panning;let d=_.off;if(0<d&&!_.trueClock)if(this.g_aQ$.getOutputTimestamp){const g=this.g_aQ$.getOutputTimestamp();d=d-g.performanceTime/1e3+g.contextTime}else d=d-performance.now()/1e3+this.g_aQ$.currentTime;this.g_aRh=e,this.g_aSs(e);try{this.g_aRg=await this.g_aSp(a,t,n,e,o),i?(this.g_aRg.g_aSA(!0),this.g_aRg.g_aSB(i.x,i.y,i.angle,i.innerAngle,i.outerAngle,i.outerGain),i.hasOwnProperty("uid")&&this.g_aRg.g_aSC(i.uid)):this.g_aRg.g_aSA(!1),this.g_aRg.g_MJ(r,g,s,d)}catch(g){return void console.error("[Construct 3] Audio: error starting playback: ",g)}finally{this.g_aSu(e)}this.g_adZ()}g_aRy(g){const a=g.tag;for(const e of this.g_aRX(a))e.g_JV()}g_aRz(){for(const g of this.g_aRf)g.g_JV()}g_aRA(g){const a=g.tag,e=g.paused;for(const _ of this.g_aRX(a))e?_.g_aSD():_.g_MI();this.g_aSw()}g_aRB(g){const a=g.tag,e=g.vol;for(const _ of this.g_aRX(a))_.g_aHC(e)}async g_aRC(g){const a=g.tag,_=g.vol,t=g.duration,n=g.stopOnEnd;await this.g_aSv(a);for(const e of this.g_aRX(a))e.g_aHD(_,t,n);this.g_aSw()}g_aRD(g){this.g_aGR=g.vol;for(const a of this.g_aRf)a.g_aSE()}g_aRE(g){const a=g.tag,e=g.isMuted;for(const _ of this.g_aRX(a))_.g_aHB(e)}g_aRF(g){this.g_aGS=g.isSilent,this.g_aqU.g_aHJ(this.g_aGS);for(const a of this.g_aRf)a.g_aSF()}g_aRG(g){const a=g.tag,e=g.isLooping;for(const _ of this.g_aRX(a))_.g_aHA(e)}async g_aRH(g){const a=g.tag,e=g.rate;await this.g_aSv(a);for(const _ of this.g_aRX(a))_.g_LY(e)}async g_aRI(g){const a=g.tag,e=g.pos;await this.g_aSv(a);for(const _ of this.g_aRX(a))_.g_aHI(e)}async g_aRJ(g){const a=g.originalUrl,_=g.url,t=g.type,n=g.isMusic;try{await this.g_aSp(a,_,t,"",n)}catch(g){console.error("[Construct 3] Audio: error preloading: ",g)}}async g_Hs(g){const a=g.url,_=g.type,t=g.isMusic,n=await this.g_aRQ("",a,_,t,!0);if(n){n.g_ek();const g=this.g_aRe.indexOf(n);-1!==g&&this.g_aRe.splice(g,1)}}g_aRK(){for(const g of this.g_aRe)g.g_ek();this.g_aRe.length=0}g_aRL(g){const a=g.isSuspended;!a&&this.g_aQ$.resume&&this.g_aQ$.resume();for(const e of this.g_aRf)e.g_arJ(a);a&&this.g_aQ$.suspend&&this.g_aQ$.suspend()}g_JK(g){if(this.g_ajU=g.timeScale,this.g_aqn=g.gameTime,this.g_aRi=g.tickCount,0!==this.g_aGE)for(const g of this.g_aRf)g.g_aSG();const a=g.listenerPos;a&&this.g_aQ$.listener.setPosition(a[0],a[1],a[2]);for(const e of g.instPans){const g=e.uid;for(const a of this.g_aRf)a.g_D$()===g&&a.g_aSH(e.x,e.y,e.angle)}}async g_aRM(g){const a=g.type,_=g.tag,t=g.params;let n;if("filter"===a)n=new g_aSI(this,...t);else if("delay"===a)n=new g_aSJ(this,...t);else if("convolution"===a){let a=null;try{a=await this.g_aRQ(g.bufferOriginalUrl,g.bufferUrl,g.bufferType,!1)}catch(g){return void console.log("[Construct 3] Audio: error loading convolution: ",g)}n=new g_aSK(this,a.g_aSL(),...t),n.g_aSM(g.bufferOriginalUrl,g.bufferUrl,g.bufferType)}else if("flanger"===a)n=new g_aSN(this,...t);else if("phaser"===a)n=new g_aSO(this,...t);else if("gain"===a)n=new g_aSP(this,...t);else if("tremolo"===a)n=new g_aSQ(this,...t);else if("ringmod"===a)n=new g_aSR(this,...t);else if("distortion"===a)n=new g_aSS(this,...t);else if("compressor"===a)n=new g_aST(this,...t);else if("analyser"===a)n=new g_aSU(this,...t);else throw new Error("invalid effect type");this.g_aRT(_,n),this.g_aSV()}g_aRN(_){const a=_.tag,t=_.index,n=_.param,i=_.value,e=_.ramp,o=_.time,g=this.g_aRo.get(a);!g||0>t||t>=g.length||(g[t].g_aSW(n,i,e,o),this.g_aSV())}g_aRO(g){const a=g.tag.toLowerCase(),e=this.g_aRo.get(a);if(e&&e.length){for(const g of e)g.g_ek();this.g_aRo.delete(a),this.g_aRV(a)}}g_aSX(g){this.g_aRp.add(g),this.g_aSw()}g_aSY(g){this.g_aRp.delete(g)}g_aSV(){this.g_aRq||(this.g_aRq=!0,Promise.resolve().then(()=>this.g_aSZ()))}g_aSZ(){const g={};for(const[a,e]of this.g_aRo)g[a]=e.map(g=>g.g_aSx());this.g_aI_("fxstate",{fxstate:g}),this.g_aRq=!1}async g_aLR(g){const e=g.saveLoadMode;if(3!==e)for(const g of this.g_aRf)g.g_aSl()&&1===e||!g.g_aSl()&&2===e||g.g_JV();for(const e of this.g_aRo.values())for(const g of e)g.g_ek();this.g_aRo.clear(),this.g_ajU=g.timeScale,this.g_aqn=g.gameTime;const a=g.listenerPos;this.g_aQ$.listener.setPosition(a[0],a[1],a[2]),this.g_aGS=g.isSilent,this.g_aqU.g_aHJ(this.g_aGS),this.g_aGR=g.masterVolume;const _=[];for(const a of Object.values(g.effects))_.push(Promise.all(a.map(g=>this.g_aRM(g))));await Promise.all(_),await Promise.all(g.playing.map(g=>this.g_aS_(g,e))),this.g_aSw()}async g_aS_(_,a){if(3===a)return;const t=_.bufferOriginalUrl,n=_.bufferUrl,o=_.bufferType,e=_.isMusic,r=_.tag,g=_.isLooping,s=_.volume,i=_.playbackTime;if(e&&1===a)return;if(!e&&2===a)return;let d=null;try{d=await this.g_aSp(t,n,o,r,e)}catch(g){return void console.error("[Construct 3] Audio: error loading audio state: ",g)}d.g_aS$(_.pan),d.g_MJ(g,s,i,0),_.isPlaying||d.g_aSD(),d.g_aTa(_)}g_aRt(g,a){this.g_aRs&&this.g_aRs.disconnect(),this.g_aRr=a.toLowerCase(),this.g_aRs=this.g_aQ$.createMediaStreamSource(g),this.g_aRs.connect(this.g_aRR(this.g_aRr))}g_aRv(){return this.g_aRu||(this.g_aRu=this.g_aQ$.createMediaStreamDestination(),this.g_aRa.connect(this.g_aRu)),this.g_aRu.stream}};g_aJE.g_aKz(a)}"use strict",self.g_aSo=class{constructor(g,a,_,t,n){this.g_aTb=g,this.g_aTc=a,this.g_Cv=_,this.g_kI=t,this.g_aTd=n,this.g_aTe="",this.g_aTf="not-loaded",this.g_CA=null}g_ek(){this.g_aTf="not-loaded",this.g_aTb=null,this.g_CA=null}static g_qS(g,a,_,t,n){const e="audio/webm; codecs=opus"===t&&!g.g_aSa();return n&&e&&g.g_aSb(),!n||g.g_aR$()||e?new g_aTg(g,a,_,t,n,e):new g_aTh(g,a,_,t,n)}g_agg(g){return"html5"===this.g_aTe?new g_aTi(this.g_aTb,this,g):new g_aTj(this.g_aTb,this,g)}g_Hm(){}g_BW(){return this.g_CA||(this.g_CA=this.g_Hm()),this.g_CA}g_CB(){}g_aTk(){}g_aTl(){return"failed"===this.g_aTf}g_aGz(){return this.g_aTb.g_aGz()}g_aTm(){return this.g_aTe}g_aTn(){return this.g_aTc}g_aSn(){return this.g_Cv}g_aTo(){return this.g_kI}g_aSl(){return this.g_aTd}g_ahQ(){}},"use strict",self.g_aTh=class extends g_aSo{constructor(g,a,_,t,n){super(g,a,_,t,n),this.g_aTe="html5",this.g_aTp=new Audio,this.g_aTp.crossOrigin="anonymous",this.g_aTp.autoplay=!1,this.g_aTp.preload="auto",this.g_aTq=null,this.g_aTr=null,this.g_aTs=!1,this.g_aTp.addEventListener("canplaythrough",()=>this.g_aTs=!0),this.g_aTt=this.g_aGz().createGain(),this.g_aTu=null,this.g_aTp.addEventListener("canplay",()=>{this.g_aTq&&(this.g_aTf="loaded",this.g_aTq(),this.g_aTq=null,this.g_aTr=null),this.g_aTu||!this.g_aTp||(this.g_aTu=this.g_aGz().createMediaElementSource(this.g_aTp),this.g_aTu.connect(this.g_aTt))}),this.onended=null,this.g_aTp.addEventListener("ended",()=>{this.onended&&this.onended()}),this.g_aTp.addEventListener("error",g=>this.g_aTv(g))}g_ek(){this.g_aTb.g_aSi(this),this.g_aTt.disconnect(),this.g_aTt=null,this.g_aTu.disconnect(),this.g_aTu=null,this.g_aTp&&!this.g_aTp.paused&&this.g_aTp.pause(),this.onended=null,this.g_aTp=null,super.g_ek()}g_Hm(){return this.g_aTf="loading",new Promise((g,a)=>{this.g_aTq=g,this.g_aTr=a,this.g_aTp.src=this.g_Cv})}g_aTv(g){console.error(`[Construct 3] Audio '${this.g_Cv}' error: `,g),this.g_aTr&&(this.g_aTf="failed",this.g_aTr(g),this.g_aTq=null,this.g_aTr=null)}g_CB(){const g=4<=this.g_aTp.readyState;return g&&(this.g_aTs=!0),g||this.g_aTs}g_aTk(){return this.g_CB()}g_aTw(){return this.g_aTp}g_aTx(){return this.g_aTt}g_ahQ(){return this.g_aTp.duration}},"use strict",self.g_aTg=class extends g_aSo{constructor(g,a,_,t,n,e){super(g,a,_,t,n),this.g_aTe="webaudio",this.g_aTy=null,this.g_aTz=null,this.g_aTA=!!e}g_ek(){this.g_aTb.g_aSi(this),this.g_aTy=null,this.g_aTz=null,super.g_ek()}async g_aTB(){if(this.g_aTy)return this.g_aTy;const g=this.g_aTb.g_aJi();if("cordova"===g.g_asy()&&g.g_fX(this.g_Cv))this.g_aTy=await g.g_BK(this.g_Cv);else{const g=await fetch(this.g_Cv);if(!g.ok)throw new Error(`error fetching audio data: ${g.status} ${g.statusText}`);this.g_aTy=await g.arrayBuffer()}}async g_aTC(){return this.g_aTz?this.g_aTz:void(this.g_aTz=await this.g_aTb.g_aSh(this.g_aTy,this.g_aTA),this.g_aTy=null)}async g_Hm(){try{this.g_aTf="loading",await this.g_aTB(),await this.g_aTC(),this.g_aTf="loaded"}catch(g){this.g_aTf="failed",console.error(`[Construct 3] Failed to load audio '${this.g_Cv}': `,g)}}g_CB(){return!!(this.g_aTy||this.g_aTz)}g_aTk(){return!!this.g_aTz}g_aSL(){return this.g_aTz}g_ahQ(){return this.g_aTz?this.g_aTz.duration:0}},"use strict";{function _(e){return e*g}const g=180/Math.PI;self.g_aTD=class{constructor(g,a,e){this.g_aTb=g,this.g_wy=a,this.g_aLW=e,this.g_aTE=this.g_aGz().createGain(),this.g_aTE.connect(this.g_aGB()),this.g_aTF=null,this.g_aTG=!1,this.g_UA=!0,this.g_aTH=!1,this.g_aTI=!1,this.g_$R=!1,this.g_aTJ=1,this.g_aTK=!1,this.g_Lm=1;const _=this.g_aTb.g_aR_();this.g_aTL=1===_&&!this.g_aSl()||2===_,this.g_aTM=-1,this.g_aTN=-1,this.g_aTO=!1}g_ek(){this.g_aTb=null,this.g_wy=null,this.g_aTF&&(this.g_aTF.disconnect(),this.g_aTF=null),this.g_aTE.disconnect(),this.g_aTE=null}g_aGz(){return this.g_aTb.g_aGz()}g_aGB(){return this.g_aTb.g_aRR(this.g_aLW)}g_aRZ(){return this.g_aTb.g_aRZ()}g_aTP(){return this.g_aTL?this.g_aTb.g_Gb():performance.now()/1e3}g_aTn(){return this.g_wy.g_aTn()}g_aSn(){return this.g_wy.g_aSn()}g_aTo(){return this.g_wy.g_aTo()}g_aSj(){return this.g_wy}g_aSl(){return this.g_wy.g_aSl()}g_aSr(g){this.g_aLW=g}g_aL$(){return this.g_aLW}g_aSm(){}g_aSq(){}g_L$(){return!this.g_UA&&!this.g_aTH&&!this.g_aSm()}g_XR(){return!this.g_UA&&!this.g_aSm()}g_aTQ(){}g_ahQ(g){let a=this.g_wy.g_ahQ();return g&&(a/=this.g_Lm||.001),a}g_MJ(){}g_JV(){}g_aSD(){}g_aTR(){return this.g_aTH}g_MI(){}g_aHC(g){this.g_aTJ=g,this.g_aTE.gain.cancelScheduledValues(0),this.g_aTN=-1,this.g_aTE.gain.value=this.g_aTS()}g_aHD(g,_,t){if(!this.g_aTT()){g*=this.g_aRZ();const a=this.g_aTE.gain;a.cancelScheduledValues(0);const n=this.g_aTb.g_aRP(),e=n+_;a.setValueAtTime(a.value,n),a.linearRampToValueAtTime(g,e),this.g_aTJ=g,this.g_aTN=e,this.g_aTO=t}}g_aSE(){this.g_aHC(this.g_aTJ)}g_KM(g){-1!==this.g_aTN&&g>=this.g_aTN&&(this.g_aTN=-1,this.g_aTO&&this.g_JV(),this.g_aTb.g_aSz("fade-ended",this.g_aLW))}g_aTS(){const g=this.g_aTJ*this.g_aRZ();return isFinite(g)?g:0}g_aHB(g){g=!!g,this.g_aTK===g||(this.g_aTK=g,this.g_aSF())}g_aTT(){return this.g_aTK}g_aHs(){return this.g_aTb.g_aHs()}g_aSF(){}g_aHA(){}g_Zy(){return this.g_$R}g_LY(g){this.g_Lm===g||(this.g_Lm=g,this.g_aSG())}g_aSG(){}g_LZ(){return this.g_Lm}g_aHI(){}g_arJ(){}g_aSA(g){g=!!g,this.g_aTG===g||(this.g_aTG=g,this.g_aTG?(!this.g_aTF&&(this.g_aTF=this.g_aGz().createPanner(),this.g_aTF.panningModel=this.g_aTb.g_aSc(),this.g_aTF.distanceModel=this.g_aTb.g_aSd(),this.g_aTF.refDistance=this.g_aTb.g_aSe(),this.g_aTF.maxDistance=this.g_aTb.g_aSf(),this.g_aTF.rolloffFactor=this.g_aTb.g_aSg()),this.g_aTE.disconnect(),this.g_aTE.connect(this.g_aTF),this.g_aTF.connect(this.g_aGB())):(this.g_aTF.disconnect(),this.g_aTE.disconnect(),this.g_aTE.connect(this.g_aGB())))}g_aSB(a,t,n,i,e,o){this.g_aTG&&(this.g_aSH(a,t,n),this.g_aTF.coneInnerAngle=_(i),this.g_aTF.coneOuterAngle=_(e),this.g_aTF.coneOuterGain=o)}g_aSH(g,a,e){this.g_aTG&&(this.g_aTF.setPosition(g,a,0),this.g_aTF.setOrientation(Math.cos(e),Math.sin(e),0))}g_aSC(g){this.g_aTM=g}g_D$(){return this.g_aTM}g_aTU(){}g_aRY(g){const a=this.g_aTF||this.g_aTE;a.disconnect(),a.connect(g)}g_aSx(){return{tag:this.g_aLW,duration:this.g_ahQ(),volume:this.g_aTJ,isPlaying:this.g_L$(),playbackTime:this.g_aTQ(),playbackRate:this.g_LZ(),uid:this.g_aTM,bufferOriginalUrl:this.g_aTn(),bufferUrl:"",bufferType:this.g_aTo(),isMusic:this.g_aSl(),isLooping:this.g_Zy(),isMuted:this.g_aTT(),resumePosition:this.g_aTU(),pan:this.g_aTV()}}g_aTa(g){this.g_LY(g.playbackRate),this.g_aHB(g.isMuted)}g_aTV(){if(!this.g_aTF)return null;const g=this.g_aTF;return{pos:[g.positionX.value,g.positionY.value,g.positionZ.value],orient:[g.orientationX.value,g.orientationY.value,g.orientationZ.value],cia:g.coneInnerAngle,coa:g.coneOuterAngle,cog:g.coneOuterGain,uid:this.g_aTM}}g_aS$(g){if(!g)return void this.g_aSA(!1);this.g_aSA(!0);const a=this.g_aTF;a.setPosition(...a.pos),a.setOrientation(...a.orient),a.coneInnerAngle=a.cia,a.coneOuterAngle=a.coa,a.coneOuterGain=a.cog,this.g_aTM=a.uid}}}"use strict",self.g_aTi=class extends g_aTD{constructor(g,a,e){super(g,a,e),this.g_wy.g_aTx().connect(this.g_aTE),this.g_wy.onended=()=>this.g_aTW()}g_ek(){this.g_JV(),this.g_wy.g_aTx().disconnect(),super.g_ek()}g_aTw(){return this.g_wy.g_aTw()}g_aTW(){this.g_UA=!0,this.g_aTM=-1,this.g_aTb.g_aSz("ended",this.g_aLW)}g_aSm(){return this.g_aTw().ended}g_aSq(){return!!this.g_UA||this.g_aSm()}g_aTQ(g){let a=this.g_aTw().currentTime;return g&&(a*=this.g_Lm),this.g_$R||(a=Math.min(a,this.g_ahQ())),a}g_MJ(g,a,e){const _=this.g_aTw();if(1!==_.playbackRate&&(_.playbackRate=1),_.loop!==g&&(_.loop=g),this.g_aHC(a),_.muted&&(_.muted=!1),_.currentTime!==e)try{_.currentTime=e}catch(g){console.warn(`[Construct 3] Exception seeking audio '${this.g_wy.g_aSn()}' to position '${e}': `,g)}this.g_aTb.g_aKB(_),this.g_UA=!1,this.g_aTH=!1,this.g_$R=g,this.g_Lm=1}g_JV(){const g=this.g_aTw();g.paused||g.pause(),this.g_aTb.g_aKC(g),this.g_UA=!0,this.g_aTH=!1,this.g_aTM=-1}g_aSD(){if(!(this.g_aTH||this.g_UA||this.g_aSm())){const g=this.g_aTw();g.paused||g.pause(),this.g_aTb.g_aKC(g),this.g_aTH=!0}}g_MI(){!this.g_aTH||this.g_UA||this.g_aSm()||(this.g_aTb.g_aKB(this.g_aTw()),this.g_aTH=!1)}g_aSF(){this.g_aTw().muted=this.g_aTK||this.g_aHs()}g_aHA(g){g=!!g,this.g_$R===g||(this.g_$R=g,this.g_aTw().loop=g)}g_aSG(){let g=this.g_Lm;this.g_aTL&&(g*=this.g_aTb.g_KK());try{this.g_aTw().playbackRate=g}catch(a){console.warn(`[Construct 3] Unable to set playback rate '${g}':`,a)}}g_aHI(g){if(!(this.g_UA||this.g_aSm()))try{this.g_aTw().currentTime=g}catch(a){console.warn(`[Construct 3] Error seeking audio to '${g}': `,a)}}g_aTU(){return this.g_aTQ()}g_arJ(g){g?this.g_L$()?(this.g_aTw().pause(),this.g_aTI=!0):this.g_aTI=!1:this.g_aTI&&(this.g_aTb.g_aKB(this.g_aTw()),this.g_aTI=!1)}},"use strict",self.g_aTj=class extends g_aTD{constructor(g,a,e){super(g,a,e),this.g_aTX=null,this.g_aTY=g=>this.g_aTW(g),this.g_aTZ=!0,this.g_aT_=null,this.g_aqi=0,this.g_aT$=0,this.g_aUa=1}g_ek(){this.g_JV(),this.g_aUb(),this.g_aTY=null,super.g_ek()}g_aUb(){this.g_aTX&&this.g_aTX.disconnect(),this.g_aTX=null,this.g_aT_=null}g_aTW(g){this.g_aTH||this.g_aTI||g.target!==this.g_aT_||(this.g_aTZ=!0,this.g_UA=!0,this.g_aTM=-1,this.g_aUb(),this.g_aTb.g_aSz("ended",this.g_aLW))}g_aSm(){return!(!this.g_UA&&this.g_aTX&&this.g_aTX.loop)&&!this.g_aTH&&this.g_aTZ}g_aSq(){return!this.g_aTX||this.g_UA||this.g_aSm()}g_aTQ(g){let a=0;return a=this.g_aTH?this.g_aT$:this.g_aTP()-this.g_aqi,g&&(a*=this.g_Lm),this.g_$R||(a=Math.min(a,this.g_ahQ())),a}g_MJ(g,a,e,_){this.g_aUa=1,this.g_aHC(a),this.g_aUb(),this.g_aTX=this.g_aGz().createBufferSource(),this.g_aTX.buffer=this.g_wy.g_aSL(),this.g_aTX.connect(this.g_aTE),this.g_aT_=this.g_aTX,this.g_aTX.onended=this.g_aTY,this.g_aTX.loop=g,this.g_aTX.start(_,e),this.g_aTZ=!1,this.g_UA=!1,this.g_aTH=!1,this.g_$R=g,this.g_Lm=1,this.g_aqi=this.g_aTP()-e}g_JV(){this.g_aTX&&this.g_aTX.stop(0),this.g_UA=!0,this.g_aTH=!1,this.g_aTM=-1}g_aSD(){this.g_aTH||this.g_UA||this.g_aSm()||(this.g_aT$=this.g_aTQ(!0),this.g_$R&&(this.g_aT$%=this.g_ahQ()),this.g_aTH=!0,this.g_aTX.stop(0))}g_MI(){!this.g_aTH||this.g_UA||this.g_aSm()||(this.g_aUb(),this.g_aTX=this.g_aGz().createBufferSource(),this.g_aTX.buffer=this.g_wy.g_aSL(),this.g_aTX.connect(this.g_aTE),this.g_aT_=this.g_aTX,this.g_aTX.onended=this.g_aTY,this.g_aTX.loop=this.g_$R,this.g_aSE(),this.g_aSG(),this.g_aqi=this.g_aTP()-this.g_aT$/(this.g_Lm||.001),this.g_aTX.start(0,this.g_aT$),this.g_aTH=!1)}g_aTS(){return super.g_aTS()*this.g_aUa}g_aSF(){this.g_aUa=this.g_aTK||this.g_aHs()?0:1,this.g_aSE()}g_aHA(g){g=!!g,this.g_$R===g||(this.g_$R=g,this.g_aTX&&(this.g_aTX.loop=g))}g_aSG(){let g=this.g_Lm;this.g_aTL&&(g*=this.g_aTb.g_KK()),this.g_aTX&&(this.g_aTX.playbackRate.value=g)}g_aHI(g){this.g_UA||this.g_aSm()||(this.g_aTH?this.g_aT$=g:(this.g_aSD(),this.g_aT$=g,this.g_MI()))}g_aTU(){return this.g_aT$}g_arJ(g){g?this.g_L$()?(this.g_aTI=!0,this.g_aT$=this.g_aTQ(!0),this.g_$R&&(this.g_aT$%=this.g_ahQ()),this.g_aTX.stop(0)):this.g_aTI=!1:this.g_aTI&&(this.g_aUb(),this.g_aTX=this.g_aGz().createBufferSource(),this.g_aTX.buffer=this.g_wy.g_aSL(),this.g_aTX.connect(this.g_aTE),this.g_aT_=this.g_aTX,this.g_aTX.onended=this.g_aTY,this.g_aTX.loop=this.g_$R,this.g_aSE(),this.g_aSG(),this.g_aqi=this.g_aTP()-this.g_aT$/(this.g_Lm||.001),this.g_aTX.start(0,this.g_aT$),this.g_aTI=!1)}g_aTa(g){super.g_aTa(g),this.g_aT$=g.resumePosition}},"use strict";{function g(g){return Math.pow(10,g/20)}function _(a){return Math.max(Math.min(g(a),1),0)}function t(g){return 20*(Math.log(g)/2.302585092994046)}function n(g){return t(Math.max(Math.min(g,1),0))}function i(g,a){return 1-Math.exp(-a*g)}class a{constructor(g){this.g_aTb=g,this.g_aQ$=g.g_aGz(),this.g_Di=-1,this.g_aLW="",this.g_kI="",this.g_aUc=null}g_ek(){this.g_aQ$=null}g_alA(g){this.g_Di=g}g_ED(){return this.g_Di}g_aRU(g){this.g_aLW=g}g_aL$(){return this.g_aLW}g_aUd(){return this.g_aQ$.createGain()}g_aRS(){}g_aRW(){}g_aUe(g,a,_,t){if(g.cancelScheduledValues(0),0===t)return void(g.value=a);const n=this.g_aQ$.currentTime;t+=n,0===_?g.setValueAtTime(a,t):1===_?(g.setValueAtTime(g.value,n),g.linearRampToValueAtTime(a,t)):2===_?(g.setValueAtTime(g.value,n),g.exponentialRampToValueAtTime(a,t)):void 0}g_aSx(){return{type:this.g_kI,tag:this.g_aLW,params:this.g_aUc}}}self.g_aSI=class extends a{constructor(_,a,t,n,i,e,o){super(_),this.g_kI="filter",this.g_aUc=[a,t,n,i,e,o],this.g_aUf=this.g_aUd(),this.g_aUg=this.g_aUd(),this.g_aUg.gain.value=o,this.g_aUh=this.g_aUd(),this.g_aUh.gain.value=1-o,this.g_aUi=this.g_aQ$.createBiquadFilter(),this.g_aUi.type=a,this.g_aUi.frequency.value=t,this.g_aUi.detune.value=n,this.g_aUi.Q.value=i,this.g_aUi.gain.vlaue=e,this.g_aUf.connect(this.g_aUi),this.g_aUf.connect(this.g_aUh),this.g_aUi.connect(this.g_aUg)}g_ek(){this.g_aUf.disconnect(),this.g_aUi.disconnect(),this.g_aUg.disconnect(),this.g_aUh.disconnect(),super.g_ek()}g_aRW(g){this.g_aUg.disconnect(),this.g_aUg.connect(g),this.g_aUh.disconnect(),this.g_aUh.connect(g)}g_aRS(){return this.g_aUf}g_aSW(g,a,e,_){0===g?(a=Math.max(Math.min(a/100,1),0),this.g_aUc[5]=a,this.g_aUe(this.g_aUg.gain,a,e,_),this.g_aUe(this.g_aUh.gain,1-a,e,_)):1===g?(this.g_aUc[1]=a,this.g_aUe(this.g_aUi.frequency,a,e,_)):2===g?(this.g_aUc[2]=a,this.g_aUe(this.g_aUi.detune,a,e,_)):3===g?(this.g_aUc[3]=a,this.g_aUe(this.g_aUi.Q,a,e,_)):4===g?(this.g_aUc[4]=a,this.g_aUe(this.g_aUi.gain,a,e,_)):void 0}},self.g_aSJ=class extends a{constructor(g,a,e,_){super(g),this.g_kI="delay",this.g_aUc=[a,e,_],this.g_aUf=this.g_aUd(),this.g_aUg=this.g_aUd(),this.g_aUg.gain.value=_,this.g_aUh=this.g_aUd(),this.g_aUh.gain.value=1-_,this.g_aUj=this.g_aUd(),this.g_aUk=this.g_aQ$.createDelay(a),this.g_aUk.delayTime.value=a,this.g_aUl=this.g_aUd(),this.g_aUl.gain.value=e,this.g_aUf.connect(this.g_aUj),this.g_aUf.connect(this.g_aUh),this.g_aUj.connect(this.g_aUg),this.g_aUj.connect(this.g_aUk),this.g_aUk.connect(this.g_aUl),this.g_aUl.connect(this.g_aUj)}g_ek(){this.g_aUf.disconnect(),this.g_aUg.disconnect(),this.g_aUh.disconnect(),this.g_aUj.disconnect(),this.g_aUk.disconnect(),this.g_aUl.disconnect(),super.g_ek()}g_aRW(g){this.g_aUg.disconnect(),this.g_aUg.connect(g),this.g_aUh.disconnect(),this.g_aUh.connect(g)}g_aRS(){return this.g_aUf}g_aSW(g,a,t,n){0===g?(a=Math.max(Math.min(a/100,1),0),this.g_aUc[2]=a,this.g_aUe(this.g_aUg.gain,a,t,n),this.g_aUe(this.g_aUh.gain,1-a,t,n)):4===g?(this.g_aUc[1]=_(a),this.g_aUe(this.g_aUl.gain,_(a),t,n)):5===g?(this.g_aUc[0]=a,this.g_aUe(this.g_aUk.delayTime,a,t,n)):void 0}},self.g_aSK=class extends a{constructor(g,a,e,_){super(g),this.g_kI="convolution",this.g_aUc=[e,_],this.g_aUm="",this.g_aUn="",this.g_aUo="",this.g_aUf=this.g_aUd(),this.g_aUg=this.g_aUd(),this.g_aUg.gain.value=_,this.g_aUh=this.g_aUd(),this.g_aUh.gain.value=1-_,this.g_aUp=this.g_aQ$.createConvolver(),this.g_aUp.normalize=e,this.g_aUp.buffer=a,this.g_aUf.connect(this.g_aUp),this.g_aUf.connect(this.g_aUh),this.g_aUp.connect(this.g_aUg)}g_ek(){this.g_aUf.disconnect(),this.g_aUp.disconnect(),this.g_aUg.disconnect(),this.g_aUh.disconnect(),super.g_ek()}g_aRW(g){this.g_aUg.disconnect(),this.g_aUg.connect(g),this.g_aUh.disconnect(),this.g_aUh.connect(g)}g_aRS(){return this.g_aUf}g_aSW(g,a,e,_){0===g?(a=Math.max(Math.min(a/100,1),0),this.g_aUc[1]=a,this.g_aUe(this.g_aUg.gain,a,e,_),this.g_aUe(this.g_aUh.gain,1-a,e,_)):void 0}g_aSM(g,a,e){this.g_aUm=g,this.g_aUn=a,this.g_aUo=e}g_aSx(){const g=super.g_aSx();return g.bufferOriginalUrl=this.g_aUm,g.bufferUrl="",g.bufferType=this.g_aUo,g}},self.g_aSN=class extends a{constructor(g,a,_,t,n,e){super(g),this.g_kI="flanger",this.g_aUc=[a,_,t,n,e],this.g_aUf=this.g_aUd(),this.g_aUh=this.g_aUd(),this.g_aUh.gain.value=1-e/2,this.g_aUg=this.g_aUd(),this.g_aUg.gain.value=e/2,this.g_aUq=this.g_aUd(),this.g_aUq.gain.value=n,this.g_aUk=this.g_aQ$.createDelay(a+_),this.g_aUk.delayTime.value=a,this.g_aUr=this.g_aQ$.createOscillator(),this.g_aUr.frequency.value=t,this.g_aUs=this.g_aUd(),this.g_aUs.gain.value=_,this.g_aUf.connect(this.g_aUk),this.g_aUf.connect(this.g_aUh),this.g_aUk.connect(this.g_aUg),this.g_aUk.connect(this.g_aUq),this.g_aUq.connect(this.g_aUk),this.g_aUr.connect(this.g_aUs),this.g_aUs.connect(this.g_aUk.delayTime),this.g_aUr.start(0)}g_ek(){this.g_aUr.stop(0),this.g_aUf.disconnect(),this.g_aUk.disconnect(),this.g_aUr.disconnect(),this.g_aUs.disconnect(),this.g_aUh.disconnect(),this.g_aUg.disconnect(),this.g_aUq.disconnect(),super.g_ek()}g_aRW(g){this.g_aUg.disconnect(),this.g_aUg.connect(g),this.g_aUh.disconnect(),this.g_aUh.connect(g)}g_aRS(){return this.g_aUf}g_aSW(g,a,e,_){0===g?(a=Math.max(Math.min(a/100,1),0),this.g_aUc[4]=a,this.g_aUe(this.g_aUg.gain,a/2,e,_),this.g_aUe(this.g_aUh.gain,1-a/2,e,_)):6===g?(this.g_aUc[1]=a/1e3,this.g_aUe(this.g_aUs.gain,a/1e3,e,_)):7===g?(this.g_aUc[2]=a,this.g_aUe(this.g_aUr.frequency,a,e,_)):8===g?(this.g_aUc[3]=a/100,this.g_aUe(this.g_aUq.gain,a/100,e,_)):void 0}},self.g_aSO=class extends a{constructor(_,a,t,n,i,e,o){super(_),this.g_kI="phaser",this.g_aUc=[a,t,n,i,e,o],this.g_aUf=this.g_aUd(),this.g_aUh=this.g_aUd(),this.g_aUh.gain.value=1-o/2,this.g_aUg=this.g_aUd(),this.g_aUg.gain.value=o/2,this.g_aUi=this.g_aQ$.createBiquadFilter(),this.g_aUi.type="allpass",this.g_aUi.frequency.value=a,this.g_aUi.detune.value=t,this.g_aUi.Q.value=n,this.g_aUr=this.g_aQ$.createOscillator(),this.g_aUr.frequency.value=e,this.g_aUs=this.g_aUd(),this.g_aUs.gain.value=i,this.g_aUf.connect(this.g_aUi),this.g_aUf.connect(this.g_aUh),this.g_aUi.connect(this.g_aUg),this.g_aUr.connect(this.g_aUs),this.g_aUs.connect(this.g_aUi.frequency),this.g_aUr.start(0)}g_ek(){this.g_aUr.stop(0),this.g_aUf.disconnect(),this.g_aUi.disconnect(),this.g_aUr.disconnect(),this.g_aUs.disconnect(),this.g_aUh.disconnect(),this.g_aUg.disconnect(),super.g_ek()}g_aRW(g){this.g_aUg.disconnect(),this.g_aUg.connect(g),this.g_aUh.disconnect(),this.g_aUh.connect(g)}g_aRS(){return this.g_aUf}g_aSW(g,a,e,_){0===g?(a=Math.max(Math.min(a/100,1),0),this.g_aUc[5]=a,this.g_aUe(this.g_aUg.gain,a/2,e,_),this.g_aUe(this.g_aUh.gain,1-a/2,e,_)):1===g?(this.g_aUc[0]=a,this.g_aUe(this.g_aUi.frequency,a,e,_)):2===g?(this.g_aUc[1]=a,this.g_aUe(this.g_aUi.detune,a,e,_)):3===g?(this.g_aUc[2]=a,this.g_aUe(this.g_aUi.Q,a,e,_)):6===g?(this.g_aUc[3]=a,this.g_aUe(this.g_aUs.gain,a,e,_)):7===g?(this.g_aUc[4]=a,this.g_aUe(this.g_aUr.frequency,a,e,_)):void 0}},self.g_aSP=class extends a{constructor(g,a){super(g),this.g_kI="gain",this.g_aUc=[a],this.g_aUt=this.g_aUd(),this.g_aUt.gain.value=a}g_ek(){this.g_aUt.disconnect(),super.g_ek()}g_aRW(g){this.g_aUt.disconnect(),this.g_aUt.connect(g)}g_aRS(){return this.g_aUt}g_aSW(g,a,t,n){4===g?(this.g_aUc[0]=_(a),this.g_aUe(this.g_aUt.gain,_(a),t,n)):void 0}},self.g_aSQ=class extends a{constructor(g,a,e){super(g),this.g_kI="tremolo",this.g_aUc=[a,e],this.g_aUt=this.g_aUd(),this.g_aUt.gain.value=1-e/2,this.g_aUr=this.g_aQ$.createOscillator(),this.g_aUr.frequency.value=a,this.g_aUs=this.g_aUd(),this.g_aUs.gain.value=e/2,this.g_aUr.connect(this.g_aUs),this.g_aUs.connect(this.g_aUt.gain),this.g_aUr.start(0)}g_ek(){this.g_aUr.stop(0),this.g_aUr.disconnect(),this.g_aUs.disconnect(),this.g_aUt.disconnect(),super.g_ek()}g_aRW(g){this.g_aUt.disconnect(),this.g_aUt.connect(g)}g_aRS(){return this.g_aUt}g_aSW(g,a,e,_){0===g?(a=Math.max(Math.min(a/100,1),0),this.g_aUc[1]=a,this.g_aUe(this.g_aUt.gain.value,1-a/2,e,_),this.g_aUe(this.g_aUs.gain.value,a/2,e,_)):7===g?(this.g_aUc[0]=a,this.g_aUe(this.g_aUr.frequency,a,e,_)):void 0}},self.g_aSR=class extends a{constructor(g,a,e){super(g),this.g_kI="ringmod",this.g_aUc=[a,e],this.g_aUf=this.g_aUd(),this.g_aUg=this.g_aUd(),this.g_aUg.gain.value=e,this.g_aUh=this.g_aUd(),this.g_aUh.gain.value=1-e,this.g_aUu=this.g_aUd(),this.g_aUu.gain.value=0,this.g_aUr=this.g_aQ$.createOscillator(),this.g_aUr.frequency.value=a,this.g_aUr.connect(this.g_aUu.gain),this.g_aUr.start(0),this.g_aUf.connect(this.g_aUu),this.g_aUf.connect(this.g_aUh),this.g_aUu.connect(this.g_aUg)}g_ek(){this.g_aUr.stop(0),this.g_aUr.disconnect(),this.g_aUu.disconnect(),this.g_aUf.disconnect(),this.g_aUg.disconnect(),this.g_aUh.disconnect(),super.g_ek()}g_aRW(g){this.g_aUg.disconnect(),this.g_aUg.connect(g),this.g_aUh.disconnect(),this.g_aUh.connect(g)}g_aRS(){return this.g_aUf}g_aSW(g,a,e,_){0===g?(a=Math.max(Math.min(a/100,1),0),this.g_aUc[1]=a,this.g_aUe(this.g_aUg.gain,a,e,_),this.g_aUe(this.g_aUh.gain,1-a,e,_)):7===g?(this.g_aUc[0]=a,this.g_aUe(this.g_aUr.frequency,a,e,_)):void 0}},self.g_aSS=class extends a{constructor(g,a,_,t,n,e){super(g),this.g_kI="distortion",this.g_aUc=[a,_,t,n,e],this.g_aUf=this.g_aUd(),this.g_aUv=this.g_aUd(),this.g_aUw=this.g_aUd(),this.g_aUx(t,n),this.g_aUg=this.g_aUd(),this.g_aUg.gain.value=e,this.g_aUh=this.g_aUd(),this.g_aUh.gain.value=1-e,this.g_aUy=this.g_aQ$.createWaveShaper(),this.g_aUz=new Float32Array(65536),this.g_aUA(a,_),this.g_aUy.curve=this.g_aUz,this.g_aUf.connect(this.g_aUv),this.g_aUf.connect(this.g_aUh),this.g_aUv.connect(this.g_aUy),this.g_aUy.connect(this.g_aUw),this.g_aUw.connect(this.g_aUg)}g_ek(){this.g_aUf.disconnect(),this.g_aUv.disconnect(),this.g_aUy.disconnect(),this.g_aUw.disconnect(),this.g_aUg.disconnect(),this.g_aUh.disconnect(),super.g_ek()}g_aUx(g,e){.01>g&&(g=.01),this.g_aUv.gain.value=g,this.g_aUw.gain.value=Math.pow(1/g,.6)*e}g_aUA(g,a){for(let e,_=0;32768>_;++_)e=_/32768,e=this.g_aUB(e,g,a),this.g_aUz[32768+_]=e,this.g_aUz[32768-_-1]=-e}g_aUB(e,a,_){const t=1.05*_*a-a,n=0>e?-1:1,o=0>e?-e:e;let g=o<a?o:a+t*i(o-a,1/t);return g*=n,g}g_aRW(g){this.g_aUg.disconnect(),this.g_aUg.connect(g),this.g_aUh.disconnect(),this.g_aUh.connect(g)}g_aRS(){return this.g_aUf}g_aSW(g,a,e,_){0===g?(a=Math.max(Math.min(a/100,1),0),this.g_aUc[4]=a,this.g_aUe(this.g_aUg.gain,a,e,_),this.g_aUe(this.g_aUh.gain,1-a,e,_)):void 0}},self.g_aST=class extends a{constructor(g,a,_,t,n,e){super(g),this.g_kI="compressor",this.g_aUc=[a,_,t,n,e],this.g_aUt=this.g_aQ$.createDynamicsCompressor(),this.g_aUt.threshold.value=a,this.g_aUt.knee.value=_,this.g_aUt.ratio.value=t,this.g_aUt.attack.value=n,this.g_aUt.release.value=e}g_ek(){this.g_aUt.disconnect(),super.g_ek()}g_aRW(g){this.g_aUt.disconnect(),this.g_aUt.connect(g)}g_aRS(){return this.g_aUt}g_aSW(){}},self.g_aSU=class extends a{constructor(g,a,e){super(g),this.g_kI="analyser",this.g_aUc=[a,e],this.g_aUt=this.g_aQ$.createAnalyser(),this.g_aUt.fftSize=a,this.g_aUt.smoothingTimeConstant=e,this.g_aUC=new Float32Array(this.g_aUt.frequencyBinCount),this.g_aUD=new Uint8Array(a),this.g_aUE=0,this.g_aUF=0,this.g_aTb.g_aSX(this)}g_ek(){this.g_aTb.g_aSY(this),this.g_aUt.disconnect(),super.g_ek()}g_KM(){this.g_aUt.getFloatFrequencyData(this.g_aUC),this.g_aUt.getByteTimeDomainData(this.g_aUD);const g=this.g_aUt.fftSize;this.g_aUE=0;let a=0;for(let e,_=0;_<g;++_)e=(this.g_aUD[_]-128)/128,0>e&&(e=-e),this.g_aUE<e&&(this.g_aUE=e),a+=e*e;this.g_aUE=n(this.g_aUE),this.g_aUF=n(Math.sqrt(a/g))}g_aRW(g){this.g_aUt.disconnect(),this.g_aUt.connect(g)}g_aRS(){return this.g_aUt}g_aSW(){}g_aSy(){return{tag:this.g_aL$(),index:this.g_ED(),peak:this.g_aUE,rms:this.g_aUF,binCount:this.g_aUt.frequencyBinCount,freqBins:this.g_aUC}}}}